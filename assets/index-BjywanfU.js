import{r as ie,a as Ef,R as Sf}from"./vendor-wGySg1uH.js";import{r as Un,_ as Wn,C as Vn,a as ii,E as Fc,o as Ff,F as Ac,L as Af,g as es,i as bf,b as Df,v as Cf,c as Js,d as Nf,e as If,f as Rf,h as or,j as qe,u as Et,T as Hn,k as yr,l as Bf,m as Of,n as Pf,G as Lf,s as Mf,p as jf,q as Uf,t as rt,w as bc,x as ta,y as It,z as qt,A as Sr,B as Wf}from"./firebase-CP5Rb1a2.js";import{L as Kr,O as Vf,B as Hf,R as $f,a as Ir,N as wi}from"./routing-DyedhaGh.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&a(s)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();var Dc={exports:{}},si={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gf=ie,zf=Symbol.for("react.element"),Xf=Symbol.for("react.fragment"),Yf=Object.prototype.hasOwnProperty,Kf=Gf.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Qf={key:!0,ref:!0,__self:!0,__source:!0};function Cc(e,t,r){var a,n={},i=null,s=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(s=t.ref);for(a in t)Yf.call(t,a)&&!Qf.hasOwnProperty(a)&&(n[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps,t)n[a]===void 0&&(n[a]=t[a]);return{$$typeof:zf,type:e,key:i,ref:s,props:n,_owner:Kf.current}}si.Fragment=Xf;si.jsx=Cc;si.jsxs=Cc;Dc.exports=si;var h=Dc.exports,Wi={},Zs=Ef;Wi.createRoot=Zs.createRoot,Wi.hydrateRoot=Zs.hydrateRoot;const Nc="@firebase/installations",rs="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ic=1e4,Rc=`w:${rs}`,Bc="FIS_v2",qf="https://firebaseinstallations.googleapis.com/v1",Jf=60*60*1e3,Zf="installations",eh="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rh={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},aa=new Fc(Zf,eh,rh);function Oc(e){return e instanceof Ac&&e.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pc({projectId:e}){return`${qf}/projects/${e}/installations`}function Lc(e){return{token:e.token,requestStatus:2,expiresIn:ah(e.expiresIn),creationTime:Date.now()}}async function Mc(e,t){const a=(await t.json()).error;return aa.create("request-failed",{requestName:e,serverCode:a.code,serverMessage:a.message,serverStatus:a.status})}function jc({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function th(e,{refreshToken:t}){const r=jc(e);return r.append("Authorization",nh(t)),r}async function Uc(e){const t=await e();return t.status>=500&&t.status<600?e():t}function ah(e){return Number(e.replace("s","000"))}function nh(e){return`${Bc} ${e}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ih({appConfig:e,heartbeatServiceProvider:t},{fid:r}){const a=Pc(e),n=jc(e),i=t.getImmediate({optional:!0});if(i){const l=await i.getHeartbeatsHeader();l&&n.append("x-firebase-client",l)}const s={fid:r,authVersion:Bc,appId:e.appId,sdkVersion:Rc},c={method:"POST",headers:n,body:JSON.stringify(s)},o=await Uc(()=>fetch(a,c));if(o.ok){const l=await o.json();return{fid:l.fid||r,registrationStatus:2,refreshToken:l.refreshToken,authToken:Lc(l.authToken)}}else throw await Mc("Create Installation",o)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wc(e){return new Promise(t=>{setTimeout(t,e)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sh(e){return btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ch=/^[cdef][\w-]{21}$/,Vi="";function oh(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const r=lh(e);return ch.test(r)?r:Vi}catch{return Vi}}function lh(e){return sh(e).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ci(e){return`${e.appName}!${e.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vc=new Map;function Hc(e,t){const r=ci(e);$c(r,t),fh(r,t)}function $c(e,t){const r=Vc.get(e);if(r)for(const a of r)a(t)}function fh(e,t){const r=hh();r&&r.postMessage({key:e,fid:t}),uh()}let Qt=null;function hh(){return!Qt&&"BroadcastChannel"in self&&(Qt=new BroadcastChannel("[Firebase] FID Change"),Qt.onmessage=e=>{$c(e.data.key,e.data.fid)}),Qt}function uh(){Vc.size===0&&Qt&&(Qt.close(),Qt=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dh="firebase-installations-database",xh=1,na="firebase-installations-store";let yi=null;function ts(){return yi||(yi=Ff(dh,xh,{upgrade:(e,t)=>{switch(t){case 0:e.createObjectStore(na)}}})),yi}async function $n(e,t){const r=ci(e),n=(await ts()).transaction(na,"readwrite"),i=n.objectStore(na),s=await i.get(r);return await i.put(t,r),await n.done,(!s||s.fid!==t.fid)&&Hc(e,t.fid),t}async function Gc(e){const t=ci(e),a=(await ts()).transaction(na,"readwrite");await a.objectStore(na).delete(t),await a.done}async function oi(e,t){const r=ci(e),n=(await ts()).transaction(na,"readwrite"),i=n.objectStore(na),s=await i.get(r),c=t(s);return c===void 0?await i.delete(r):await i.put(c,r),await n.done,c&&(!s||s.fid!==c.fid)&&Hc(e,c.fid),c}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function as(e){let t;const r=await oi(e.appConfig,a=>{const n=ph(a),i=gh(e,n);return t=i.registrationPromise,i.installationEntry});return r.fid===Vi?{installationEntry:await t}:{installationEntry:r,registrationPromise:t}}function ph(e){const t=e||{fid:oh(),registrationStatus:0};return zc(t)}function gh(e,t){if(t.registrationStatus===0){if(!navigator.onLine){const n=Promise.reject(aa.create("app-offline"));return{installationEntry:t,registrationPromise:n}}const r={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},a=mh(e,r);return{installationEntry:r,registrationPromise:a}}else return t.registrationStatus===1?{installationEntry:t,registrationPromise:vh(e)}:{installationEntry:t}}async function mh(e,t){try{const r=await ih(e,t);return $n(e.appConfig,r)}catch(r){throw Oc(r)&&r.customData.serverCode===409?await Gc(e.appConfig):await $n(e.appConfig,{fid:t.fid,registrationStatus:0}),r}}async function vh(e){let t=await e0(e.appConfig);for(;t.registrationStatus===1;)await Wc(100),t=await e0(e.appConfig);if(t.registrationStatus===0){const{installationEntry:r,registrationPromise:a}=await as(e);return a||r}return t}function e0(e){return oi(e,t=>{if(!t)throw aa.create("installation-not-found");return zc(t)})}function zc(e){return wh(e)?{fid:e.fid,registrationStatus:0}:e}function wh(e){return e.registrationStatus===1&&e.registrationTime+Ic<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yh({appConfig:e,heartbeatServiceProvider:t},r){const a=_h(e,r),n=th(e,r),i=t.getImmediate({optional:!0});if(i){const l=await i.getHeartbeatsHeader();l&&n.append("x-firebase-client",l)}const s={installation:{sdkVersion:Rc,appId:e.appId}},c={method:"POST",headers:n,body:JSON.stringify(s)},o=await Uc(()=>fetch(a,c));if(o.ok){const l=await o.json();return Lc(l)}else throw await Mc("Generate Auth Token",o)}function _h(e,{fid:t}){return`${Pc(e)}/${t}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ns(e,t=!1){let r;const a=await oi(e.appConfig,i=>{if(!Xc(i))throw aa.create("not-registered");const s=i.authToken;if(!t&&Eh(s))return i;if(s.requestStatus===1)return r=kh(e,t),i;{if(!navigator.onLine)throw aa.create("app-offline");const c=Fh(i);return r=Th(e,c),c}});return r?await r:a.authToken}async function kh(e,t){let r=await r0(e.appConfig);for(;r.authToken.requestStatus===1;)await Wc(100),r=await r0(e.appConfig);const a=r.authToken;return a.requestStatus===0?ns(e,t):a}function r0(e){return oi(e,t=>{if(!Xc(t))throw aa.create("not-registered");const r=t.authToken;return Ah(r)?{...t,authToken:{requestStatus:0}}:t})}async function Th(e,t){try{const r=await yh(e,t),a={...t,authToken:r};return await $n(e.appConfig,a),r}catch(r){if(Oc(r)&&(r.customData.serverCode===401||r.customData.serverCode===404))await Gc(e.appConfig);else{const a={...t,authToken:{requestStatus:0}};await $n(e.appConfig,a)}throw r}}function Xc(e){return e!==void 0&&e.registrationStatus===2}function Eh(e){return e.requestStatus===2&&!Sh(e)}function Sh(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+Jf}function Fh(e){const t={requestStatus:1,requestTime:Date.now()};return{...e,authToken:t}}function Ah(e){return e.requestStatus===1&&e.requestTime+Ic<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bh(e){const t=e,{installationEntry:r,registrationPromise:a}=await as(t);return a?a.catch(console.error):ns(t).catch(console.error),r.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dh(e,t=!1){const r=e;return await Ch(r),(await ns(r,t)).token}async function Ch(e){const{registrationPromise:t}=await as(e);t&&await t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nh(e){if(!e||!e.options)throw _i("App Configuration");if(!e.name)throw _i("App Name");const t=["projectId","apiKey","appId"];for(const r of t)if(!e.options[r])throw _i(r);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}function _i(e){return aa.create("missing-app-config-values",{valueName:e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yc="installations",Ih="installations-internal",Rh=e=>{const t=e.getProvider("app").getImmediate(),r=Nh(t),a=ii(t,"heartbeat");return{app:t,appConfig:r,heartbeatServiceProvider:a,_delete:()=>Promise.resolve()}},Bh=e=>{const t=e.getProvider("app").getImmediate(),r=ii(t,Yc).getImmediate();return{getId:()=>bh(r),getToken:n=>Dh(r,n)}};function Oh(){Wn(new Vn(Yc,Rh,"PUBLIC")),Wn(new Vn(Ih,Bh,"PRIVATE"))}Oh();Un(Nc,rs);Un(Nc,rs,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gn="analytics",Ph="firebase_id",Lh="origin",Mh=60*1e3,jh="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",is="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $r=new Af("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uh={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},tt=new Fc("analytics","Analytics",Uh);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wh(e){if(!e.startsWith(is)){const t=tt.create("invalid-gtag-resource",{gtagURL:e});return $r.warn(t.message),""}return e}function Kc(e){return Promise.all(e.map(t=>t.catch(r=>r)))}function Vh(e,t){let r;return window.trustedTypes&&(r=window.trustedTypes.createPolicy(e,t)),r}function Hh(e,t){const r=Vh("firebase-js-sdk-policy",{createScriptURL:Wh}),a=document.createElement("script"),n=`${is}?l=${e}&id=${t}`;a.src=r?r==null?void 0:r.createScriptURL(n):n,a.async=!0,document.head.appendChild(a)}function $h(e){let t=[];return Array.isArray(window[e])?t=window[e]:window[e]=t,t}async function Gh(e,t,r,a,n,i){const s=a[n];try{if(s)await t[s];else{const o=(await Kc(r)).find(l=>l.measurementId===n);o&&await t[o.appId]}}catch(c){$r.error(c)}e("config",n,i)}async function zh(e,t,r,a,n){try{let i=[];if(n&&n.send_to){let s=n.send_to;Array.isArray(s)||(s=[s]);const c=await Kc(r);for(const o of s){const l=c.find(u=>u.measurementId===o),f=l&&t[l.appId];if(f)i.push(f);else{i=[];break}}}i.length===0&&(i=Object.values(t)),await Promise.all(i),e("event",a,n||{})}catch(i){$r.error(i)}}function Xh(e,t,r,a){async function n(i,...s){try{if(i==="event"){const[c,o]=s;await zh(e,t,r,c,o)}else if(i==="config"){const[c,o]=s;await Gh(e,t,r,a,c,o)}else if(i==="consent"){const[c,o]=s;e("consent",c,o)}else if(i==="get"){const[c,o,l]=s;e("get",c,o,l)}else if(i==="set"){const[c]=s;e("set",c)}else e(i,...s)}catch(c){$r.error(c)}}return n}function Yh(e,t,r,a,n){let i=function(...s){window[a].push(arguments)};return window[n]&&typeof window[n]=="function"&&(i=window[n]),window[n]=Xh(i,e,t,r),{gtagCore:i,wrappedGtag:window[n]}}function Kh(e){const t=window.document.getElementsByTagName("script");for(const r of Object.values(t))if(r.src&&r.src.includes(is)&&r.src.includes(e))return r;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qh=30,qh=1e3;class Jh{constructor(t={},r=qh){this.throttleMetadata=t,this.intervalMillis=r}getThrottleMetadata(t){return this.throttleMetadata[t]}setThrottleMetadata(t,r){this.throttleMetadata[t]=r}deleteThrottleMetadata(t){delete this.throttleMetadata[t]}}const Qc=new Jh;function Zh(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function eu(e){var s;const{appId:t,apiKey:r}=e,a={method:"GET",headers:Zh(r)},n=jh.replace("{app-id}",t),i=await fetch(n,a);if(i.status!==200&&i.status!==304){let c="";try{const o=await i.json();(s=o.error)!=null&&s.message&&(c=o.error.message)}catch{}throw tt.create("config-fetch-failed",{httpStatus:i.status,responseMessage:c})}return i.json()}async function ru(e,t=Qc,r){const{appId:a,apiKey:n,measurementId:i}=e.options;if(!a)throw tt.create("no-app-id");if(!n){if(i)return{measurementId:i,appId:a};throw tt.create("no-api-key")}const s=t.getThrottleMetadata(a)||{backoffCount:0,throttleEndTimeMillis:Date.now()},c=new nu;return setTimeout(async()=>{c.abort()},Mh),qc({appId:a,apiKey:n,measurementId:i},s,c,t)}async function qc(e,{throttleEndTimeMillis:t,backoffCount:r},a,n=Qc){var c;const{appId:i,measurementId:s}=e;try{await tu(a,t)}catch(o){if(s)return $r.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${s} provided in the "measurementId" field in the local Firebase config. [${o==null?void 0:o.message}]`),{appId:i,measurementId:s};throw o}try{const o=await eu(e);return n.deleteThrottleMetadata(i),o}catch(o){const l=o;if(!au(l)){if(n.deleteThrottleMetadata(i),s)return $r.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${s} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:i,measurementId:s};throw o}const f=Number((c=l==null?void 0:l.customData)==null?void 0:c.httpStatus)===503?Js(r,n.intervalMillis,Qh):Js(r,n.intervalMillis),u={throttleEndTimeMillis:Date.now()+f,backoffCount:r+1};return n.setThrottleMetadata(i,u),$r.debug(`Calling attemptFetch again in ${f} millis`),qc(e,u,a,n)}}function tu(e,t){return new Promise((r,a)=>{const n=Math.max(t-Date.now(),0),i=setTimeout(r,n);e.addEventListener(()=>{clearTimeout(i),a(tt.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}function au(e){if(!(e instanceof Ac)||!e.customData)return!1;const t=Number(e.customData.httpStatus);return t===429||t===500||t===503||t===504}class nu{constructor(){this.listeners=[]}addEventListener(t){this.listeners.push(t)}abort(){this.listeners.forEach(t=>t())}}async function iu(e,t,r,a,n){if(n&&n.global){e("event",r,a);return}else{const i=await t,s={...a,send_to:i};e("event",r,s)}}async function su(e,t,r,a){if(a&&a.global){const n={};for(const i of Object.keys(r))n[`user_properties.${i}`]=r[i];return e("set",n),Promise.resolve()}else{const n=await t;e("config",n,{update:!0,user_properties:r})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cu(){if(Df())try{await Cf()}catch(e){return $r.warn(tt.create("indexeddb-unavailable",{errorInfo:e==null?void 0:e.toString()}).message),!1}else return $r.warn(tt.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function ou(e,t,r,a,n,i,s){const c=ru(e);c.then(d=>{r[d.measurementId]=d.appId,e.options.measurementId&&d.measurementId!==e.options.measurementId&&$r.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${d.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(d=>$r.error(d)),t.push(c);const o=cu().then(d=>{if(d)return a.getId()}),[l,f]=await Promise.all([c,o]);Kh(i)||Hh(i,l.measurementId),n("js",new Date);const u=(s==null?void 0:s.config)??{};return u[Lh]="firebase",u.update=!0,f!=null&&(u[Ph]=f),n("config",l.measurementId,u),l.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lu{constructor(t){this.app=t}_delete(){return delete Sa[this.app.options.appId],Promise.resolve()}}let Sa={},t0=[];const a0={};let ki="dataLayer",fu="gtag",n0,ss,i0=!1;function hu(){const e=[];if(bf()&&e.push("This is a browser extension environment."),Rf()||e.push("Cookies are not available."),e.length>0){const t=e.map((a,n)=>`(${n+1}) ${a}`).join(" "),r=tt.create("invalid-analytics-context",{errorInfo:t});$r.warn(r.message)}}function uu(e,t,r){hu();const a=e.options.appId;if(!a)throw tt.create("no-app-id");if(!e.options.apiKey)if(e.options.measurementId)$r.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw tt.create("no-api-key");if(Sa[a]!=null)throw tt.create("already-exists",{id:a});if(!i0){$h(ki);const{wrappedGtag:i,gtagCore:s}=Yh(Sa,t0,a0,ki,fu);ss=i,n0=s,i0=!0}return Sa[a]=ou(e,t0,a0,t,n0,ki,r),new lu(e)}function du(e=Nf()){e=es(e);const t=ii(e,Gn);return t.isInitialized()?t.getImmediate():xu(e)}function xu(e,t={}){const r=ii(e,Gn);if(r.isInitialized()){const n=r.getImmediate();if(If(t,r.getOptions()))return n;throw tt.create("already-initialized")}return r.initialize({options:t})}function pu(e,t,r){e=es(e),su(ss,Sa[e.app.options.appId],t,r).catch(a=>$r.error(a))}function gu(e,t,r,a){e=es(e),iu(ss,Sa[e.app.options.appId],t,r,a).catch(n=>$r.error(n))}const s0="@firebase/analytics",c0="0.10.19";function mu(){Wn(new Vn(Gn,(t,{options:r})=>{const a=t.getProvider("app").getImmediate(),n=t.getProvider("installations-internal").getImmediate();return uu(a,n,r)},"PUBLIC")),Wn(new Vn("analytics-internal",e,"PRIVATE")),Un(s0,c0),Un(s0,c0,"esm2020");function e(t){try{const r=t.getProvider(Gn).getImmediate();return{logEvent:(a,n,i)=>gu(r,a,n,i),setUserProperties:(a,n)=>pu(r,a,n)}}catch(r){throw tt.create("interop-component-reg-failed",{reason:r})}}}mu();const o0=e=>{if(!e||typeof e!="string")return null;const t=e.includes("-")?e.split("-"):e.split("/");if(t.length!==3)return null;const[r,a,n]=t,i=new Date(Number(n),Number(a)-1,Number(r));return isNaN(i.getTime())?null:i};window.runDateMigration=async()=>{console.clear(),console.log("üöÄ Migration started");const e=await or(qe(Ie,"BillTable"));for(const r of e.docs){const a=r.data();if(typeof a.BillDate=="string"){const n=o0(a.BillDate);n&&(await Et(yr(Ie,"BillTable",r.id),{BillDate:Hn.fromDate(n)}),console.log("‚úÖ Bill updated:",r.id))}}const t=await or(qe(Ie,"TblDispatch"));for(const r of t.docs){const a=r.data();if(typeof a.DispatchDate=="string"){const n=o0(a.DispatchDate);n&&(await Et(yr(Ie,"TblDispatch",r.id),{DispatchDate:Hn.fromDate(n)}),console.log("‚úÖ Dispatch updated:",r.id))}}console.log("üéâ Migration completed")};const vu={apiKey:"AIzaSyAd1bazB0rvrEhQwXWa-xUOkqLaCFZEjME",authDomain:"transport-app-c4674.firebaseapp.com",projectId:"transport-app-c4674",storageBucket:"transport-app-c4674.firebasestorage.app",messagingSenderId:"612141820756",appId:"1:612141820756:web:a9a642e1da95ae61b9f6c1",measurementId:"G-2KW1848NFH"},cs=Of(vu);typeof window<"u"&&du(cs);const vt=Pf(cs),wu=new Lf,Ie=Bf(cs),yu=async e=>e?(await e.getIdTokenResult()).claims.admin===!0:!1,_u=()=>{const[e,t]=ie.useState(""),[r,a]=ie.useState(""),[n,i]=ie.useState(!1),s=async o=>{o.preventDefault(),i(!0);try{const l=await Mf(vt,e,r);alert(`Logged in as: ${l.user.email}`)}catch(l){alert("Login failed: "+l.message)}finally{i(!1)}},c=async()=>{i(!0);try{const o=await jf(vt,wu);alert(`Logged in with Google: ${o.user.email}`)}catch(o){alert("Google login failed: "+o.message)}finally{i(!1)}};return h.jsxs("div",{style:{padding:"20px",maxWidth:"400px",margin:"50px auto",border:"1px solid #ccc",borderRadius:"8px"},children:[h.jsx("h2",{children:"Login"}),h.jsxs("form",{onSubmit:s,style:{marginBottom:"10px"},children:[h.jsx("input",{type:"email",placeholder:"Email",value:e,onChange:o=>t(o.target.value),required:!0,style:{width:"100%",marginBottom:"10px",padding:"8px"}}),h.jsx("input",{type:"password",placeholder:"Password",value:r,onChange:o=>a(o.target.value),required:!0,style:{width:"100%",marginBottom:"10px",padding:"8px"}}),h.jsx("button",{type:"submit",disabled:n,style:{width:"100%",padding:"10px"},children:n?"Logging in...":"Login"})]}),h.jsx("button",{onClick:c,disabled:n,style:{width:"100%",padding:"10px"},children:n?"Logging in...":"Login with Google"})]})},ku=({user:e,isAdmin:t})=>{const r=async()=>{try{await Uf(vt)}catch(a){console.error("Logout failed:",a)}};return h.jsxs("div",{style:{minHeight:"100vh",background:"#f5f7fa"},children:[h.jsxs("div",{style:{background:"#1f2937",color:"#fff",padding:"15px 30px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[h.jsx("h2",{style:{margin:0},children:"üöõ Transport App"}),e&&h.jsxs("div",{style:{fontSize:"14px"},children:[e.email," ",t?h.jsx("span",{style:{color:"#22c55e"},children:"(Admin)"}):h.jsx("span",{style:{color:"#f87171"},children:"(User)"})]})]}),h.jsx("nav",{style:{background:"#ffffff",padding:"12px 30px",boxShadow:"0 2px 6px rgba(0,0,0,0.1)"},children:h.jsxs("ul",{style:{listStyle:"none",display:"flex",gap:"25px",margin:0,padding:0,alignItems:"center",flexWrap:"wrap"},children:[t&&h.jsx("li",{children:h.jsx(Kr,{to:"/upload-dispatch",style:Qr,children:"üöö Dispatch Upload"})}),t&&h.jsx("li",{children:h.jsx(Kr,{to:"/bill-upload",style:Qr,children:"üßæ Bill Upload"})}),t&&h.jsx("li",{children:h.jsx(Kr,{to:"/payment-upload",style:Qr,children:"üßæ Payment Upload"})}),h.jsx("li",{children:h.jsx(Kr,{to:"/show-bill",style:Qr,children:"üìë Show Bills"})}),t&&h.jsx("li",{children:h.jsx(Kr,{to:"/destination-master",style:Qr,children:"üó∫Ô∏è Destination Master"})}),t&&h.jsx("li",{children:h.jsx(Kr,{to:"/show-billed-challan",style:Qr,children:"üó∫Ô∏è Show Billed Challan"})}),t&&h.jsx("li",{children:h.jsx(Kr,{to:"/vehicle-master",style:Qr,children:"üöõ Vehicle Master"})}),t&&h.jsx("li",{children:h.jsx(Kr,{to:"/monthly-qty-report",style:Qr,children:"üìä Monthly Quantity Report"})}),t&&h.jsx("li",{children:h.jsx(Kr,{to:"/daily-qty-report",style:Qr,children:"üìä Day Quantity Report"})}),h.jsx("li",{children:h.jsx(Kr,{to:"/factories",style:Qr,children:"üè≠ Factories"})}),h.jsx("li",{children:h.jsx(Kr,{to:"/show-dispatch",style:Qr,children:"üì¶ Show Dispatch"})}),t&&h.jsx("li",{children:h.jsx(Kr,{to:"/delete-dispatch",style:{...Qr,color:"red"},children:"‚ùå Delete Dispatch"})}),t&&h.jsx("li",{children:h.jsx(Kr,{to:"/delete-duplicate-challan",style:{...Qr,color:"red"},children:"‚ùå Delete Duplicate Dispatch"})})]})}),h.jsxs("div",{style:{padding:"25px"},children:[!t&&h.jsx("p",{style:{color:"red",marginBottom:"10px"},children:"You are logged in as a normal user. Restricted actions are hidden."}),h.jsx(Vf,{}),h.jsx("br",{}),h.jsx("button",{onClick:r,style:{padding:"8px 16px",background:"#ef4444",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Logout"})]})]})},Qr={textDecoration:"none",color:"#1f2937",fontWeight:"500",padding:"6px 10px",borderRadius:"4px",transition:"background 0.2s"};function Tu(){const[e,t]=ie.useState([]),[r,a]=ie.useState({id:null,factoryName:"",code:"",group:"",isActive:!0}),[n,i]=ie.useState(!1),s=async()=>{const f=rt(qe(Ie,"factories"),bc("factoryName")),d=(await or(f)).docs.map(x=>({id:x.id,...x.data()}));t(d)};ie.useEffect(()=>{(async()=>{if(vt.currentUser){const u=await vt.currentUser.getIdTokenResult();i(!!u.claims.admin)}})(),s()},[]);const c=async f=>{if(f.preventDefault(),!n){alert("You do not have permission to modify factories!");return}if(!r.factoryName||!r.code){alert("Factory Name and Code required");return}r.id?await Et(yr(Ie,"factories",r.id),{factoryName:r.factoryName,code:r.code,group:r.group||null,isActive:r.isActive}):await ta(qe(Ie,"factories"),{factoryName:r.factoryName,code:r.code,group:r.group||null,isActive:r.isActive,createdOn:qt()}),a({id:null,factoryName:"",code:"",group:"",isActive:!0}),s()},o=f=>{n&&a({id:f.id,factoryName:f.factoryName,code:f.code,group:f.group||"",isActive:f.isActive})},l=async f=>{n&&window.confirm("Delete this factory?")&&(await It(yr(Ie,"factories",f)),s())};return h.jsxs("div",{style:{padding:20},children:[h.jsx("h2",{children:"Factories"}),n&&h.jsxs("form",{onSubmit:c,style:{marginBottom:20},children:[h.jsx("input",{placeholder:"Factory Name",value:r.factoryName,onChange:f=>a({...r,factoryName:f.target.value})}),h.jsx("input",{placeholder:"Code",value:r.code,onChange:f=>a({...r,code:f.target.value})}),h.jsx("input",{placeholder:"Group",value:r.group,onChange:f=>a({...r,group:f.target.value})}),h.jsxs("label",{style:{marginLeft:10},children:["Active",h.jsx("input",{type:"checkbox",checked:r.isActive,onChange:f=>a({...r,isActive:f.target.checked})})]}),h.jsx("button",{type:"submit",style:{marginLeft:10},children:r.id?"Update":"Add"})]}),h.jsxs("table",{border:"1",cellPadding:"8",children:[h.jsx("thead",{children:h.jsxs("tr",{children:[h.jsx("th",{children:"Code"}),h.jsx("th",{children:"Factory Name"}),h.jsx("th",{children:"Group"}),h.jsx("th",{children:"Active"}),n&&h.jsx("th",{children:"Action"})]})}),h.jsx("tbody",{children:e.map(f=>h.jsxs("tr",{children:[h.jsx("td",{children:f.code}),h.jsx("td",{children:f.factoryName}),h.jsx("td",{children:f.group||"-"}),h.jsx("td",{children:f.isActive?"Yes":"No"}),n&&h.jsxs("td",{children:[h.jsx("button",{onClick:()=>o(f),children:"Edit"}),h.jsx("button",{onClick:()=>l(f.id),style:{marginLeft:5},children:"Delete"})]})]},f.id))})]}),!n&&h.jsx("p",{style:{marginTop:20,color:"red"},children:"You are logged in as a normal user. You cannot add, edit, or delete factories."})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var zn={};zn.version="0.18.5";var Jc=1252,Eu=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],os={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},ls=function(e){Eu.indexOf(e)!=-1&&(Jc=os[0]=e)};function Su(){ls(1252)}var xt=function(e){ls(e)};function fs(){xt(1200),Su()}function l0(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function Fu(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function Zc(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var $a=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?Fu(e.slice(2)):t==254&&r==255?Zc(e.slice(2)):t==65279?e.slice(1):e},bn=function(t){return String.fromCharCode(t)},f0=function(t){return String.fromCharCode(t)},rn,Mt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function tn(e){for(var t="",r=0,a=0,n=0,i=0,s=0,c=0,o=0,l=0;l<e.length;)r=e.charCodeAt(l++),i=r>>2,a=e.charCodeAt(l++),s=(r&3)<<4|a>>4,n=e.charCodeAt(l++),c=(a&15)<<2|n>>6,o=n&63,isNaN(a)?c=o=64:isNaN(n)&&(o=64),t+=Mt.charAt(i)+Mt.charAt(s)+Mt.charAt(c)+Mt.charAt(o);return t}function at(e){var t="",r=0,a=0,n=0,i=0,s=0,c=0,o=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)i=Mt.indexOf(e.charAt(l++)),s=Mt.indexOf(e.charAt(l++)),r=i<<2|s>>4,t+=String.fromCharCode(r),c=Mt.indexOf(e.charAt(l++)),a=(s&15)<<4|c>>2,c!==64&&(t+=String.fromCharCode(a)),o=Mt.indexOf(e.charAt(l++)),n=(c&3)<<6|o,o!==64&&(t+=String.fromCharCode(n));return t}var Me=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Bt=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Wt(e){return Me?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function h0(e){return Me?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Zr=function(t){return Me?Bt(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function li(e){if(typeof ArrayBuffer>"u")return Zr(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=e.charCodeAt(a)&255;return t}function Gt(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Au(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function hs(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return hs(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Fr=Me?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Bt(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),n=0;for(t=0,r=0;t<e.length;r+=n,++t)if(n=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function bu(e){for(var t=[],r=0,a=e.length+250,n=Wt(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)n[r++]=s;else if(s<2048)n[r++]=192|s>>6&31,n[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var c=e.charCodeAt(++i)&1023;n[r++]=240|s>>8&7,n[r++]=128|s>>2&63,n[r++]=128|c>>6&15|(s&3)<<4,n[r++]=128|c&63}else n[r++]=224|s>>12&15,n[r++]=128|s>>6&63,n[r++]=128|s&63;r>a&&(t.push(n.slice(0,r)),r=0,n=Wt(65535),a=65530)}return t.push(n.slice(0,r)),Fr(t)}var Gr=/\u0000/g,Ga=/[\u0001-\u0006]/g;function Fa(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function pt(e,t){var r=""+e;return r.length>=t?r:lr("0",t-r.length)+r}function us(e,t){var r=""+e;return r.length>=t?r:lr(" ",t-r.length)+r}function Xn(e,t){var r=""+e;return r.length>=t?r:r+lr(" ",t-r.length)}function Du(e,t){var r=""+Math.round(e);return r.length>=t?r:lr("0",t-r.length)+r}function Cu(e,t){var r=""+e;return r.length>=t?r:lr("0",t-r.length)+r}var u0=Math.pow(2,32);function ya(e,t){if(e>u0||e<-u0)return Du(e,t);var r=Math.round(e);return Cu(r,t)}function Yn(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var d0=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Ti=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Nu(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"‰∏äÂçà/‰∏ãÂçà "hh"ÊôÇ"mm"ÂàÜ"ss"Áßí "',e}var Ae={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"‰∏äÂçà/‰∏ãÂçà "hh"ÊôÇ"mm"ÂàÜ"ss"Áßí "'},x0={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Iu={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Kn(e,t,r){for(var a=e<0?-1:1,n=e*a,i=0,s=1,c=0,o=1,l=0,f=0,u=Math.floor(n);l<t&&(u=Math.floor(n),c=u*s+i,f=u*l+o,!(n-u<5e-8));)n=1/(n-u),i=s,s=c,o=l,l=f;if(f>t&&(l>t?(f=o,c=i):(f=l,c=s)),!r)return[0,a*c,f];var d=Math.floor(a*c/f);return[d,a*c-d*f,f]}function jt(e,t,r){if(e>2958465||e<0)return null;var a=e|0,n=Math.floor(86400*(e-a)),i=0,s=[],c={D:a,T:n,u:86400*(e-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),t&&t.date1904&&(a+=1462),c.u>.9999&&(c.u=0,++n==86400&&(c.T=n=0,++a,++c.D)),a===60)s=r?[1317,10,29]:[1900,2,29],i=3;else if(a===0)s=r?[1317,8,29]:[1900,1,0],i=6;else{a>60&&--a;var o=new Date(1900,0,1);o.setDate(o.getDate()+a-1),s=[o.getFullYear(),o.getMonth()+1,o.getDate()],i=o.getDay(),a<60&&(i=(i+6)%7),r&&(i=Mu(o,s))}return c.y=s[0],c.m=s[1],c.d=s[2],c.S=n%60,n=Math.floor(n/60),c.M=n%60,n=Math.floor(n/60),c.H=n,c.q=i,c}var eo=new Date(1899,11,31,0,0,0),Ru=eo.getTime(),Bu=new Date(1900,2,1,0,0,0);function ro(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Bu&&(r+=24*60*60*1e3),(r-(Ru+(e.getTimezoneOffset()-eo.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function ds(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Ou(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Pu(e){var t=e<0?12:11,r=ds(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Lu(e){var t=ds(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function an(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Pu(e):t===10?r=e.toFixed(10).substr(0,12):r=Lu(e),ds(Ou(r.toUpperCase()))}function ia(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):an(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return nt(14,ro(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Mu(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function ju(e,t,r,a){var n="",i=0,s=0,c=r.y,o,l=0;switch(e){case 98:c=r.y+543;case 121:switch(t.length){case 1:case 2:o=c%100,l=2;break;default:o=c%1e4,l=4;break}break;case 109:switch(t.length){case 1:case 2:o=r.m,l=t.length;break;case 3:return Ti[r.m-1][1];case 5:return Ti[r.m-1][0];default:return Ti[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:o=r.d,l=t.length;break;case 3:return d0[r.q][0];default:return d0[r.q][1]}break;case 104:switch(t.length){case 1:case 2:o=1+(r.H+11)%12,l=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:o=r.H,l=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:o=r.M,l=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?pt(r.S,t.length):(a>=2?s=a===3?1e3:100:s=a===1?10:1,i=Math.round(s*(r.S+r.u)),i>=60*s&&(i=0),t==="s"?i===0?"0":""+i/s:(n=pt(i,2+a),t==="ss"?n.substr(0,2):"."+n.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":o=r.D*24+r.H;break;case"[m]":case"[mm]":o=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":o=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}l=t.length===3?1:2;break;case 101:o=c,l=1;break}var f=l>0?pt(o,l):"";return f}function Ut(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,a=e.substr(0,r);r!=e.length;r+=t)a+=(a.length>0?",":"")+e.substr(r,t);return a}var to=/%/g;function Uu(e,t,r){var a=t.replace(to,""),n=t.length-a.length;return Ct(e,a,r*Math.pow(10,2*n))+lr("%",n)}function Wu(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Ct(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function ao(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+ao(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%n;if(i<0&&(i+=n),r=(t/Math.pow(10,i)).toPrecision(a+1+(n+i)%n),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,o,l,f){return o+l+f.substr(0,(n+i)%n)+"."+f.substr(i)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var no=/# (\?+)( ?)\/( ?)(\d+)/;function Vu(e,t,r){var a=parseInt(e[4],10),n=Math.round(t*a),i=Math.floor(n/a),s=n-i*a,c=a;return r+(i===0?"":""+i)+" "+(s===0?lr(" ",e[1].length+1+e[4].length):us(s,e[1].length)+e[2]+"/"+e[3]+pt(c,e[4].length))}function Hu(e,t,r){return r+(t===0?"":""+t)+lr(" ",e[1].length+2+e[4].length)}var io=/^#*0*\.([0#]+)/,so=/\).*[0#]/,co=/\(###\) ###\\?-####/;function Vr(e){for(var t="",r,a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function p0(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function g0(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function $u(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Gu(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function st(e,t,r){if(e.charCodeAt(0)===40&&!t.match(so)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?st("n",a,r):"("+st("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Wu(e,t,r);if(t.indexOf("%")!==-1)return Uu(e,t,r);if(t.indexOf("E")!==-1)return ao(t,r);if(t.charCodeAt(0)===36)return"$"+st(e,t.substr(t.charAt(1)==" "?2:1),r);var n,i,s,c,o=Math.abs(r),l=r<0?"-":"";if(t.match(/^00+$/))return l+ya(o,t.length);if(t.match(/^[#?]+$/))return n=ya(r,0),n==="0"&&(n=""),n.length>t.length?n:Vr(t.substr(0,t.length-n.length))+n;if(i=t.match(no))return Vu(i,o,l);if(t.match(/^#+0+$/))return l+ya(o,t.length-t.indexOf("0"));if(i=t.match(io))return n=p0(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Vr(i[1])).replace(/\.$/,"."+Vr(i[1])).replace(/\.(\d*)$/,function(g,p){return"."+p+lr("0",Vr(i[1]).length-p.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return l+p0(o,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return l+Ut(ya(o,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+st(e,t,-r):Ut(""+(Math.floor(r)+$u(r,i[1].length)))+"."+pt(g0(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return st(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Fa(st(e,t.replace(/[\\-]/g,""),r)),s=0,Fa(Fa(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return s<n.length?n.charAt(s++):g==="0"?"0":""}));if(t.match(co))return n=st(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var f="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),c=Kn(o,Math.pow(10,s)-1,!1),n=""+l,f=Ct("n",i[1],c[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),n+=f+i[2]+"/"+i[3],f=Xn(c[2],s),f.length<i[4].length&&(f=Vr(i[4].substr(i[4].length-f.length))+f),n+=f,n;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),c=Kn(o,Math.pow(10,s)-1,!0),l+(c[0]||(c[1]?"":"0"))+" "+(c[1]?us(c[1],s)+i[2]+"/"+i[3]+Xn(c[2],s):lr(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return n=ya(r,0),t.length<=n.length?n:Vr(t.substr(0,t.length-n.length))+n;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=n.indexOf(".");var u=t.indexOf(".")-s,d=t.length-n.length-u;return Vr(t.substr(0,u)+n+t.substr(t.length-d))}if(i=t.match(/^00,000\.([#0]*0)$/))return s=g0(r,i[1].length),r<0?"-"+st(e,t,-r):Ut(Gu(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?pt(0,3-g.length):"")+g})+"."+pt(s,i[1].length);switch(t){case"###,##0.00":return st(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var x=Ut(ya(o,0));return x!=="0"?l+x:"";case"###,###.00":return st(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return st(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function zu(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Ct(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function Xu(e,t,r){var a=t.replace(to,""),n=t.length-a.length;return Ct(e,a,r*Math.pow(10,2*n))+lr("%",n)}function oo(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+oo(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%n;if(i<0&&(i+=n),r=(t/Math.pow(10,i)).toPrecision(a+1+(n+i)%n),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,o,l,f){return o+l+f.substr(0,(n+i)%n)+"."+f.substr(i)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function yt(e,t,r){if(e.charCodeAt(0)===40&&!t.match(so)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?yt("n",a,r):"("+yt("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return zu(e,t,r);if(t.indexOf("%")!==-1)return Xu(e,t,r);if(t.indexOf("E")!==-1)return oo(t,r);if(t.charCodeAt(0)===36)return"$"+yt(e,t.substr(t.charAt(1)==" "?2:1),r);var n,i,s,c,o=Math.abs(r),l=r<0?"-":"";if(t.match(/^00+$/))return l+pt(o,t.length);if(t.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>t.length?n:Vr(t.substr(0,t.length-n.length))+n;if(i=t.match(no))return Hu(i,o,l);if(t.match(/^#+0+$/))return l+pt(o,t.length-t.indexOf("0"));if(i=t.match(io))return n=(""+r).replace(/^([^\.]+)$/,"$1."+Vr(i[1])).replace(/\.$/,"."+Vr(i[1])),n=n.replace(/\.(\d*)$/,function(g,p){return"."+p+lr("0",Vr(i[1]).length-p.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return l+(""+o).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return l+Ut(""+o);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+yt(e,t,-r):Ut(""+r)+"."+lr("0",i[1].length);if(i=t.match(/^#,#*,#0/))return yt(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Fa(yt(e,t.replace(/[\\-]/g,""),r)),s=0,Fa(Fa(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return s<n.length?n.charAt(s++):g==="0"?"0":""}));if(t.match(co))return n=yt(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var f="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),c=Kn(o,Math.pow(10,s)-1,!1),n=""+l,f=Ct("n",i[1],c[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),n+=f+i[2]+"/"+i[3],f=Xn(c[2],s),f.length<i[4].length&&(f=Vr(i[4].substr(i[4].length-f.length))+f),n+=f,n;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),c=Kn(o,Math.pow(10,s)-1,!0),l+(c[0]||(c[1]?"":"0"))+" "+(c[1]?us(c[1],s)+i[2]+"/"+i[3]+Xn(c[2],s):lr(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return n=""+r,t.length<=n.length?n:Vr(t.substr(0,t.length-n.length))+n;if(i=t.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=n.indexOf(".");var u=t.indexOf(".")-s,d=t.length-n.length-u;return Vr(t.substr(0,u)+n+t.substr(t.length-d))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+yt(e,t,-r):Ut(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?pt(0,3-g.length):"")+g})+"."+pt(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var x=Ut(""+o);return x!=="0"?l+x:"";default:if(t.match(/\.[0#?]*$/))return yt(e,t.slice(0,t.lastIndexOf(".")),r)+Vr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Ct(e,t,r){return(r|0)===r?yt(e,t,r):st(e,t,r)}function Yu(e){for(var t=[],r=!1,a=0,n=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(n,a-n),n=a+1}if(t[t.length]=e.substr(n),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var lo=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function da(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":Yn(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"‰∏ä":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="‰∏äÂçà/‰∏ãÂçà")return!0;++t;break;case"[":for(a=r;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(lo))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Ku(e,t,r,a){for(var n=[],i="",s=0,c="",o="t",l,f,u,d="H";s<e.length;)switch(c=e.charAt(s)){case"G":if(!Yn(e,s))throw new Error("unrecognized character "+c+" in "+e);n[n.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";(u=e.charCodeAt(++s))!==34&&s<e.length;)i+=String.fromCharCode(u);n[n.length]={t:"t",v:i},++s;break;case"\\":var x=e.charAt(++s),g=x==="("||x===")"?x:"t";n[n.length]={t:g,v:x},++s;break;case"_":n[n.length]={t:"t",v:" "},s+=2;break;case"@":n[n.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(l==null&&(l=jt(t,r,e.charAt(s+1)==="2"),l==null))return"";n[n.length]={t:"X",v:e.substr(s,2)},o=c,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||l==null&&(l=jt(t,r),l==null))return"";for(i=c;++s<e.length&&e.charAt(s).toLowerCase()===c;)i+=c;c==="m"&&o.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=d),n[n.length]={t:c,v:i},o=c;break;case"A":case"a":case"‰∏ä":var p={t:c,v:c};if(l==null&&(l=jt(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(l!=null&&(p.v=l.H>=12?"P":"A"),p.t="T",d="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(l!=null&&(p.v=l.H>=12?"PM":"AM"),p.t="T",s+=5,d="h"):e.substr(s,5).toUpperCase()==="‰∏äÂçà/‰∏ãÂçà"?(l!=null&&(p.v=l.H>=12?"‰∏ãÂçà":"‰∏äÂçà"),p.t="T",s+=5,d="h"):(p.t="t",++s),l==null&&p.t==="T")return"";n[n.length]=p,o=c;break;case"[":for(i=c;e.charAt(s++)!=="]"&&s<e.length;)i+=e.charAt(s);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(lo)){if(l==null&&(l=jt(t,r),l==null))return"";n[n.length]={t:"Z",v:i.toLowerCase()},o=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",da(e)||(n[n.length]={t:"t",v:i}));break;case".":if(l!=null){for(i=c;++s<e.length&&(c=e.charAt(s))==="0";)i+=c;n[n.length]={t:"s",v:i};break}case"0":case"#":for(i=c;++s<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(s))>-1;)i+=c;n[n.length]={t:"n",v:i};break;case"?":for(i=c;e.charAt(++s)===c;)i+=c;n[n.length]={t:c,v:i},o=c;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":n[n.length]={t:a===1?"t":c,v:c},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=c;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)i+=e.charAt(s);n[n.length]={t:"D",v:i};break;case" ":n[n.length]={t:c,v:c},++s;break;case"$":n[n.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=‚Ç¨acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+e);n[n.length]={t:"t",v:c},++s;break}var m=0,_=0,k;for(s=n.length-1,o="t";s>=0;--s)switch(n[s].t){case"h":case"H":n[s].t=d,o="h",m<1&&(m=1);break;case"s":(k=n[s].v.match(/\.0+$/))&&(_=Math.max(_,k[0].length-1)),m<3&&(m=3);case"d":case"y":case"M":case"e":o=n[s].t;break;case"m":o==="s"&&(n[s].t="M",m<2&&(m=2));break;case"X":break;case"Z":m<1&&n[s].v.match(/[Hh]/)&&(m=1),m<2&&n[s].v.match(/[Mm]/)&&(m=2),m<3&&n[s].v.match(/[Ss]/)&&(m=3)}switch(m){case 0:break;case 1:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M),l.M>=60&&(l.M=0,++l.H);break;case 2:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M);break}var v="",T;for(s=0;s<n.length;++s)switch(n[s].t){case"t":case"T":case" ":case"D":break;case"X":n[s].v="",n[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[s].v=ju(n[s].t.charCodeAt(0),n[s].v,l,_),n[s].t="t";break;case"n":case"?":for(T=s+1;n[T]!=null&&((c=n[T].t)==="?"||c==="D"||(c===" "||c==="t")&&n[T+1]!=null&&(n[T+1].t==="?"||n[T+1].t==="t"&&n[T+1].v==="/")||n[s].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(n[T].v==="/"||n[T].v===" "&&n[T+1]!=null&&n[T+1].t=="?"));)n[s].v+=n[T].v,n[T]={v:"",t:";"},++T;v+=n[s].v,s=T-1;break;case"G":n[s].t="t",n[s].v=ia(t,r);break}var b="",E,y;if(v.length>0){v.charCodeAt(0)==40?(E=t<0&&v.charCodeAt(0)===45?-t:t,y=Ct("n",v,E)):(E=t<0&&a>1?-t:t,y=Ct("n",v,E),E<0&&n[0]&&n[0].t=="t"&&(y=y.substr(1),n[0].v="-"+n[0].v)),T=y.length-1;var O=n.length;for(s=0;s<n.length;++s)if(n[s]!=null&&n[s].t!="t"&&n[s].v.indexOf(".")>-1){O=s;break}var B=n.length;if(O===n.length&&y.indexOf("E")===-1){for(s=n.length-1;s>=0;--s)n[s]==null||"n?".indexOf(n[s].t)===-1||(T>=n[s].v.length-1?(T-=n[s].v.length,n[s].v=y.substr(T+1,n[s].v.length)):T<0?n[s].v="":(n[s].v=y.substr(0,T+1),T=-1),n[s].t="t",B=s);T>=0&&B<n.length&&(n[B].v=y.substr(0,T+1)+n[B].v)}else if(O!==n.length&&y.indexOf("E")===-1){for(T=y.indexOf(".")-1,s=O;s>=0;--s)if(!(n[s]==null||"n?".indexOf(n[s].t)===-1)){for(f=n[s].v.indexOf(".")>-1&&s===O?n[s].v.indexOf(".")-1:n[s].v.length-1,b=n[s].v.substr(f+1);f>=0;--f)T>=0&&(n[s].v.charAt(f)==="0"||n[s].v.charAt(f)==="#")&&(b=y.charAt(T--)+b);n[s].v=b,n[s].t="t",B=s}for(T>=0&&B<n.length&&(n[B].v=y.substr(0,T+1)+n[B].v),T=y.indexOf(".")+1,s=O;s<n.length;++s)if(!(n[s]==null||"n?(".indexOf(n[s].t)===-1&&s!==O)){for(f=n[s].v.indexOf(".")>-1&&s===O?n[s].v.indexOf(".")+1:0,b=n[s].v.substr(0,f);f<n[s].v.length;++f)T<y.length&&(b+=y.charAt(T++));n[s].v=b,n[s].t="t",B=s}}}for(s=0;s<n.length;++s)n[s]!=null&&"n?".indexOf(n[s].t)>-1&&(E=a>1&&t<0&&s>0&&n[s-1].v==="-"?-t:t,n[s].v=Ct(n[s].t,n[s].v,E),n[s].t="t");var j="";for(s=0;s!==n.length;++s)n[s]!=null&&(j+=n[s].v);return j}var m0=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function v0(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function Qu(e,t){var r=Yu(e),a=r.length,n=r[a-1].indexOf("@");if(a<4&&n>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(m0),c=r[1].match(m0);return v0(t,s)?[a,r[0]]:v0(t,c)?[a,r[1]]:[a,r[s!=null&&c!=null?2:1]]}return[a,i]}function nt(e,t,r){r==null&&(r={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?a=r.dateNF:a=e;break;case"number":e==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:Ae)[e],a==null&&(a=r.table&&r.table[x0[e]]||Ae[x0[e]]),a==null&&(a=Iu[e]||"General");break}if(Yn(a,0))return ia(t,r);t instanceof Date&&(t=ro(t,r.date1904));var n=Qu(a,t);if(Yn(n[1]))return ia(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Ku(n[1],t,r,n[0])}function Tt(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Ae[r]==null){t<0&&(t=r);continue}if(Ae[r]==e){t=r;break}}t<0&&(t=391)}return Ae[t]=e,t}function gn(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Tt(e[t],t)}function Ra(){Ae=Nu()}var fo={format:nt,load:Tt,_table:Ae,load_table:gn,parse_date_code:jt,is_date:da,get_table:function(){return fo._table=Ae}},qu={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},ho=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Ju(e){var t=typeof e=="number"?Ae[e]:e;return t=t.replace(ho,"(\\d+)"),new RegExp("^"+t+"$")}function Zu(e,t,r){var a=-1,n=-1,i=-1,s=-1,c=-1,o=-1;(t.match(ho)||[]).forEach(function(u,d){var x=parseInt(r[d+1],10);switch(u.toLowerCase().charAt(0)){case"y":a=x;break;case"d":i=x;break;case"h":s=x;break;case"s":o=x;break;case"m":s>=0?c=x:n=x;break}}),o>=0&&c==-1&&n>=0&&(c=n,n=-1);var l=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);l.length==7&&(l="0"+l),l.length==8&&(l="20"+l);var f=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2);return s==-1&&c==-1&&o==-1?l:a==-1&&n==-1&&i==-1?f:l+"T"+f}var ed=function(){var e={};e.version="1.2.0";function t(){for(var y=0,O=new Array(256),B=0;B!=256;++B)y=B,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,y=y&1?-306674912^y>>>1:y>>>1,O[B]=y;return typeof Int32Array<"u"?new Int32Array(O):O}var r=t();function a(y){var O=0,B=0,j=0,U=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(j=0;j!=256;++j)U[j]=y[j];for(j=0;j!=256;++j)for(B=y[j],O=256+j;O<4096;O+=256)B=U[O]=B>>>8^y[B&255];var L=[];for(j=1;j!=16;++j)L[j-1]=typeof Int32Array<"u"?U.subarray(j*256,j*256+256):U.slice(j*256,j*256+256);return L}var n=a(r),i=n[0],s=n[1],c=n[2],o=n[3],l=n[4],f=n[5],u=n[6],d=n[7],x=n[8],g=n[9],p=n[10],m=n[11],_=n[12],k=n[13],v=n[14];function T(y,O){for(var B=O^-1,j=0,U=y.length;j<U;)B=B>>>8^r[(B^y.charCodeAt(j++))&255];return~B}function b(y,O){for(var B=O^-1,j=y.length-15,U=0;U<j;)B=v[y[U++]^B&255]^k[y[U++]^B>>8&255]^_[y[U++]^B>>16&255]^m[y[U++]^B>>>24]^p[y[U++]]^g[y[U++]]^x[y[U++]]^d[y[U++]]^u[y[U++]]^f[y[U++]]^l[y[U++]]^o[y[U++]]^c[y[U++]]^s[y[U++]]^i[y[U++]]^r[y[U++]];for(j+=15;U<j;)B=B>>>8^r[(B^y[U++])&255];return~B}function E(y,O){for(var B=O^-1,j=0,U=y.length,L=0,Y=0;j<U;)L=y.charCodeAt(j++),L<128?B=B>>>8^r[(B^L)&255]:L<2048?(B=B>>>8^r[(B^(192|L>>6&31))&255],B=B>>>8^r[(B^(128|L&63))&255]):L>=55296&&L<57344?(L=(L&1023)+64,Y=y.charCodeAt(j++)&1023,B=B>>>8^r[(B^(240|L>>8&7))&255],B=B>>>8^r[(B^(128|L>>2&63))&255],B=B>>>8^r[(B^(128|Y>>6&15|(L&3)<<4))&255],B=B>>>8^r[(B^(128|Y&63))&255]):(B=B>>>8^r[(B^(224|L>>12&15))&255],B=B>>>8^r[(B^(128|L>>6&63))&255],B=B>>>8^r[(B^(128|L&63))&255]);return~B}return e.table=r,e.bstr=T,e.buf=b,e.str=E,e}(),Fe=function(){var t={};t.version="1.2.1";function r(w,C){for(var S=w.split("/"),F=C.split("/"),N=0,I=0,z=Math.min(S.length,F.length);N<z;++N){if(I=S[N].length-F[N].length)return I;if(S[N]!=F[N])return S[N]<F[N]?-1:1}return S.length-F.length}function a(w){if(w.charAt(w.length-1)=="/")return w.slice(0,-1).indexOf("/")===-1?w:a(w.slice(0,-1));var C=w.lastIndexOf("/");return C===-1?w:w.slice(0,C+1)}function n(w){if(w.charAt(w.length-1)=="/")return n(w.slice(0,-1));var C=w.lastIndexOf("/");return C===-1?w:w.slice(C+1)}function i(w,C){typeof C=="string"&&(C=new Date(C));var S=C.getHours();S=S<<6|C.getMinutes(),S=S<<5|C.getSeconds()>>>1,w.write_shift(2,S);var F=C.getFullYear()-1980;F=F<<4|C.getMonth()+1,F=F<<5|C.getDate(),w.write_shift(2,F)}function s(w){var C=w.read_shift(2)&65535,S=w.read_shift(2)&65535,F=new Date,N=S&31;S>>>=5;var I=S&15;S>>>=4,F.setMilliseconds(0),F.setFullYear(S+1980),F.setMonth(I-1),F.setDate(N);var z=C&31;C>>>=5;var te=C&63;return C>>>=6,F.setHours(C),F.setMinutes(te),F.setSeconds(z<<1),F}function c(w){Dr(w,0);for(var C={},S=0;w.l<=w.length-4;){var F=w.read_shift(2),N=w.read_shift(2),I=w.l+N,z={};switch(F){case 21589:S=w.read_shift(1),S&1&&(z.mtime=w.read_shift(4)),N>5&&(S&2&&(z.atime=w.read_shift(4)),S&4&&(z.ctime=w.read_shift(4))),z.mtime&&(z.mt=new Date(z.mtime*1e3));break}w.l=I,C[F]=z}return C}var o;function l(){return o||(o={})}function f(w,C){if(w[0]==80&&w[1]==75)return qs(w,C);if((w[0]|32)==109&&(w[1]|32)==105)return vf(w,C);if(w.length<512)throw new Error("CFB file size "+w.length+" < 512");var S=3,F=512,N=0,I=0,z=0,te=0,G=0,X=[],K=w.slice(0,512);Dr(K,0);var he=u(K);switch(S=he[0],S){case 3:F=512;break;case 4:F=4096;break;case 0:if(he[1]==0)return qs(w,C);default:throw new Error("Major Version: Expected 3 or 4 saw "+S)}F!==512&&(K=w.slice(0,F),Dr(K,28));var me=w.slice(0,F);d(K,S);var ke=K.read_shift(4,"i");if(S===3&&ke!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ke);K.l+=4,z=K.read_shift(4,"i"),K.l+=4,K.chk("00100000","Mini Stream Cutoff Size: "),te=K.read_shift(4,"i"),N=K.read_shift(4,"i"),G=K.read_shift(4,"i"),I=K.read_shift(4,"i");for(var ue=-1,ye=0;ye<109&&(ue=K.read_shift(4,"i"),!(ue<0));++ye)X[ye]=ue;var Be=x(w,F);m(G,I,Be,F,X);var nr=k(Be,z,X,F);nr[z].name="!Directory",N>0&&te!==Y&&(nr[te].name="!MiniFAT"),nr[X[0]].name="!FAT",nr.fat_addrs=X,nr.ssz=F;var ir={},Nr=[],Pa=[],La=[];v(z,nr,Be,Nr,N,ir,Pa,te),g(Pa,La,Nr),Nr.shift();var Ma={FileIndex:Pa,FullPaths:La};return C&&C.raw&&(Ma.raw={header:me,sectors:Be}),Ma}function u(w){if(w[w.l]==80&&w[w.l+1]==75)return[0,0];w.chk(J,"Header Signature: "),w.l+=16;var C=w.read_shift(2,"u");return[w.read_shift(2,"u"),C]}function d(w,C){var S=9;switch(w.l+=2,S=w.read_shift(2)){case 9:if(C!=3)throw new Error("Sector Shift: Expected 9 saw "+S);break;case 12:if(C!=4)throw new Error("Sector Shift: Expected 12 saw "+S);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+S)}w.chk("0600","Mini Sector Shift: "),w.chk("000000000000","Reserved: ")}function x(w,C){for(var S=Math.ceil(w.length/C)-1,F=[],N=1;N<S;++N)F[N-1]=w.slice(N*C,(N+1)*C);return F[S-1]=w.slice(S*C),F}function g(w,C,S){for(var F=0,N=0,I=0,z=0,te=0,G=S.length,X=[],K=[];F<G;++F)X[F]=K[F]=F,C[F]=S[F];for(;te<K.length;++te)F=K[te],N=w[F].L,I=w[F].R,z=w[F].C,X[F]===F&&(N!==-1&&X[N]!==N&&(X[F]=X[N]),I!==-1&&X[I]!==I&&(X[F]=X[I])),z!==-1&&(X[z]=F),N!==-1&&F!=X[F]&&(X[N]=X[F],K.lastIndexOf(N)<te&&K.push(N)),I!==-1&&F!=X[F]&&(X[I]=X[F],K.lastIndexOf(I)<te&&K.push(I));for(F=1;F<G;++F)X[F]===F&&(I!==-1&&X[I]!==I?X[F]=X[I]:N!==-1&&X[N]!==N&&(X[F]=X[N]));for(F=1;F<G;++F)if(w[F].type!==0){if(te=F,te!=X[te])do te=X[te],C[F]=C[te]+"/"+C[F];while(te!==0&&X[te]!==-1&&te!=X[te]);X[F]=-1}for(C[0]+="/",F=1;F<G;++F)w[F].type!==2&&(C[F]+="/")}function p(w,C,S){for(var F=w.start,N=w.size,I=[],z=F;S&&N>0&&z>=0;)I.push(C.slice(z*L,z*L+L)),N-=L,z=Kt(S,z*4);return I.length===0?re(0):Fr(I).slice(0,w.size)}function m(w,C,S,F,N){var I=Y;if(w===Y){if(C!==0)throw new Error("DIFAT chain shorter than expected")}else if(w!==-1){var z=S[w],te=(F>>>2)-1;if(!z)return;for(var G=0;G<te&&(I=Kt(z,G*4))!==Y;++G)N.push(I);m(Kt(z,F-4),C-1,S,F,N)}}function _(w,C,S,F,N){var I=[],z=[];N||(N=[]);var te=F-1,G=0,X=0;for(G=C;G>=0;){N[G]=!0,I[I.length]=G,z.push(w[G]);var K=S[Math.floor(G*4/F)];if(X=G*4&te,F<4+X)throw new Error("FAT boundary crossed: "+G+" 4 "+F);if(!w[K])break;G=Kt(w[K],X)}return{nodes:I,data:C0([z])}}function k(w,C,S,F){var N=w.length,I=[],z=[],te=[],G=[],X=F-1,K=0,he=0,me=0,ke=0;for(K=0;K<N;++K)if(te=[],me=K+C,me>=N&&(me-=N),!z[me]){G=[];var ue=[];for(he=me;he>=0;){ue[he]=!0,z[he]=!0,te[te.length]=he,G.push(w[he]);var ye=S[Math.floor(he*4/F)];if(ke=he*4&X,F<4+ke)throw new Error("FAT boundary crossed: "+he+" 4 "+F);if(!w[ye]||(he=Kt(w[ye],ke),ue[he]))break}I[me]={nodes:te,data:C0([G])}}return I}function v(w,C,S,F,N,I,z,te){for(var G=0,X=F.length?2:0,K=C[w].data,he=0,me=0,ke;he<K.length;he+=128){var ue=K.slice(he,he+128);Dr(ue,64),me=ue.read_shift(2),ke=ys(ue,0,me-X),F.push(ke);var ye={name:ke,type:ue.read_shift(1),color:ue.read_shift(1),L:ue.read_shift(4,"i"),R:ue.read_shift(4,"i"),C:ue.read_shift(4,"i"),clsid:ue.read_shift(16),state:ue.read_shift(4,"i"),start:0,size:0},Be=ue.read_shift(2)+ue.read_shift(2)+ue.read_shift(2)+ue.read_shift(2);Be!==0&&(ye.ct=T(ue,ue.l-8));var nr=ue.read_shift(2)+ue.read_shift(2)+ue.read_shift(2)+ue.read_shift(2);nr!==0&&(ye.mt=T(ue,ue.l-8)),ye.start=ue.read_shift(4,"i"),ye.size=ue.read_shift(4,"i"),ye.size<0&&ye.start<0&&(ye.size=ye.type=0,ye.start=Y,ye.name=""),ye.type===5?(G=ye.start,N>0&&G!==Y&&(C[G].name="!StreamData")):ye.size>=4096?(ye.storage="fat",C[ye.start]===void 0&&(C[ye.start]=_(S,ye.start,C.fat_addrs,C.ssz)),C[ye.start].name=ye.name,ye.content=C[ye.start].data.slice(0,ye.size)):(ye.storage="minifat",ye.size<0?ye.size=0:G!==Y&&ye.start!==Y&&C[G]&&(ye.content=p(ye,C[G].data,(C[te]||{}).data))),ye.content&&Dr(ye.content,0),I[ke]=ye,z.push(ye)}}function T(w,C){return new Date((Jr(w,C+4)/1e7*Math.pow(2,32)+Jr(w,C)/1e7-11644473600)*1e3)}function b(w,C){return l(),f(o.readFileSync(w),C)}function E(w,C){var S=C&&C.type;switch(S||Me&&Buffer.isBuffer(w)&&(S="buffer"),S||"base64"){case"file":return b(w,C);case"base64":return f(Zr(at(w)),C);case"binary":return f(Zr(w),C)}return f(w,C)}function y(w,C){var S=C||{},F=S.root||"Root Entry";if(w.FullPaths||(w.FullPaths=[]),w.FileIndex||(w.FileIndex=[]),w.FullPaths.length!==w.FileIndex.length)throw new Error("inconsistent CFB structure");w.FullPaths.length===0&&(w.FullPaths[0]=F+"/",w.FileIndex[0]={name:F,type:5}),S.CLSID&&(w.FileIndex[0].clsid=S.CLSID),O(w)}function O(w){var C="Sh33tJ5";if(!Fe.find(w,"/"+C)){var S=re(4);S[0]=55,S[1]=S[3]=50,S[2]=54,w.FileIndex.push({name:C,type:2,content:S,size:4,L:69,R:69,C:69}),w.FullPaths.push(w.FullPaths[0]+C),B(w)}}function B(w,C){y(w);for(var S=!1,F=!1,N=w.FullPaths.length-1;N>=0;--N){var I=w.FileIndex[N];switch(I.type){case 0:F?S=!0:(w.FileIndex.pop(),w.FullPaths.pop());break;case 1:case 2:case 5:F=!0,isNaN(I.R*I.L*I.C)&&(S=!0),I.R>-1&&I.L>-1&&I.R==I.L&&(S=!0);break;default:S=!0;break}}if(!(!S&&!C)){var z=new Date(1987,1,19),te=0,G=Object.create?Object.create(null):{},X=[];for(N=0;N<w.FullPaths.length;++N)G[w.FullPaths[N]]=!0,w.FileIndex[N].type!==0&&X.push([w.FullPaths[N],w.FileIndex[N]]);for(N=0;N<X.length;++N){var K=a(X[N][0]);F=G[K],F||(X.push([K,{name:n(K).replace("/",""),type:1,clsid:ce,ct:z,mt:z,content:null}]),G[K]=!0)}for(X.sort(function(ke,ue){return r(ke[0],ue[0])}),w.FullPaths=[],w.FileIndex=[],N=0;N<X.length;++N)w.FullPaths[N]=X[N][0],w.FileIndex[N]=X[N][1];for(N=0;N<X.length;++N){var he=w.FileIndex[N],me=w.FullPaths[N];if(he.name=n(me).replace("/",""),he.L=he.R=he.C=-(he.color=1),he.size=he.content?he.content.length:0,he.start=0,he.clsid=he.clsid||ce,N===0)he.C=X.length>1?1:-1,he.size=0,he.type=5;else if(me.slice(-1)=="/"){for(te=N+1;te<X.length&&a(w.FullPaths[te])!=me;++te);for(he.C=te>=X.length?-1:te,te=N+1;te<X.length&&a(w.FullPaths[te])!=a(me);++te);he.R=te>=X.length?-1:te,he.type=1}else a(w.FullPaths[N+1]||"")==a(me)&&(he.R=N+1),he.type=2}}}function j(w,C){var S=C||{};if(S.fileType=="mad")return wf(w,S);switch(B(w),S.fileType){case"zip":return uf(w,S)}var F=function(ke){for(var ue=0,ye=0,Be=0;Be<ke.FileIndex.length;++Be){var nr=ke.FileIndex[Be];if(nr.content){var ir=nr.content.length;ir>0&&(ir<4096?ue+=ir+63>>6:ye+=ir+511>>9)}}for(var Nr=ke.FullPaths.length+3>>2,Pa=ue+7>>3,La=ue+127>>7,Ma=Pa+ye+Nr+La,Yt=Ma+127>>7,vi=Yt<=109?0:Math.ceil((Yt-109)/127);Ma+Yt+vi+127>>7>Yt;)vi=++Yt<=109?0:Math.ceil((Yt-109)/127);var bt=[1,vi,Yt,La,Nr,ye,ue,0];return ke.FileIndex[0].size=ue<<6,bt[7]=(ke.FileIndex[0].start=bt[0]+bt[1]+bt[2]+bt[3]+bt[4]+bt[5])+(bt[6]+7>>3),bt}(w),N=re(F[7]<<9),I=0,z=0;{for(I=0;I<8;++I)N.write_shift(1,Q[I]);for(I=0;I<8;++I)N.write_shift(2,0);for(N.write_shift(2,62),N.write_shift(2,3),N.write_shift(2,65534),N.write_shift(2,9),N.write_shift(2,6),I=0;I<3;++I)N.write_shift(2,0);for(N.write_shift(4,0),N.write_shift(4,F[2]),N.write_shift(4,F[0]+F[1]+F[2]+F[3]-1),N.write_shift(4,0),N.write_shift(4,4096),N.write_shift(4,F[3]?F[0]+F[1]+F[2]-1:Y),N.write_shift(4,F[3]),N.write_shift(-4,F[1]?F[0]-1:Y),N.write_shift(4,F[1]),I=0;I<109;++I)N.write_shift(-4,I<F[2]?F[1]+I:-1)}if(F[1])for(z=0;z<F[1];++z){for(;I<236+z*127;++I)N.write_shift(-4,I<F[2]?F[1]+I:-1);N.write_shift(-4,z===F[1]-1?Y:z+1)}var te=function(ke){for(z+=ke;I<z-1;++I)N.write_shift(-4,I+1);ke&&(++I,N.write_shift(-4,Y))};for(z=I=0,z+=F[1];I<z;++I)N.write_shift(-4,ne.DIFSECT);for(z+=F[2];I<z;++I)N.write_shift(-4,ne.FATSECT);te(F[3]),te(F[4]);for(var G=0,X=0,K=w.FileIndex[0];G<w.FileIndex.length;++G)K=w.FileIndex[G],K.content&&(X=K.content.length,!(X<4096)&&(K.start=z,te(X+511>>9)));for(te(F[6]+7>>3);N.l&511;)N.write_shift(-4,ne.ENDOFCHAIN);for(z=I=0,G=0;G<w.FileIndex.length;++G)K=w.FileIndex[G],K.content&&(X=K.content.length,!(!X||X>=4096)&&(K.start=z,te(X+63>>6)));for(;N.l&511;)N.write_shift(-4,ne.ENDOFCHAIN);for(I=0;I<F[4]<<2;++I){var he=w.FullPaths[I];if(!he||he.length===0){for(G=0;G<17;++G)N.write_shift(4,0);for(G=0;G<3;++G)N.write_shift(4,-1);for(G=0;G<12;++G)N.write_shift(4,0);continue}K=w.FileIndex[I],I===0&&(K.start=K.size?K.start-1:Y);var me=I===0&&S.root||K.name;if(X=2*(me.length+1),N.write_shift(64,me,"utf16le"),N.write_shift(2,X),N.write_shift(1,K.type),N.write_shift(1,K.color),N.write_shift(-4,K.L),N.write_shift(-4,K.R),N.write_shift(-4,K.C),K.clsid)N.write_shift(16,K.clsid,"hex");else for(G=0;G<4;++G)N.write_shift(4,0);N.write_shift(4,K.state||0),N.write_shift(4,0),N.write_shift(4,0),N.write_shift(4,0),N.write_shift(4,0),N.write_shift(4,K.start),N.write_shift(4,K.size),N.write_shift(4,0)}for(I=1;I<w.FileIndex.length;++I)if(K=w.FileIndex[I],K.size>=4096)if(N.l=K.start+1<<9,Me&&Buffer.isBuffer(K.content))K.content.copy(N,N.l,0,K.size),N.l+=K.size+511&-512;else{for(G=0;G<K.size;++G)N.write_shift(1,K.content[G]);for(;G&511;++G)N.write_shift(1,0)}for(I=1;I<w.FileIndex.length;++I)if(K=w.FileIndex[I],K.size>0&&K.size<4096)if(Me&&Buffer.isBuffer(K.content))K.content.copy(N,N.l,0,K.size),N.l+=K.size+63&-64;else{for(G=0;G<K.size;++G)N.write_shift(1,K.content[G]);for(;G&63;++G)N.write_shift(1,0)}if(Me)N.l=N.length;else for(;N.l<N.length;)N.write_shift(1,0);return N}function U(w,C){var S=w.FullPaths.map(function(G){return G.toUpperCase()}),F=S.map(function(G){var X=G.split("/");return X[X.length-(G.slice(-1)=="/"?2:1)]}),N=!1;C.charCodeAt(0)===47?(N=!0,C=S[0].slice(0,-1)+C):N=C.indexOf("/")!==-1;var I=C.toUpperCase(),z=N===!0?S.indexOf(I):F.indexOf(I);if(z!==-1)return w.FileIndex[z];var te=!I.match(Ga);for(I=I.replace(Gr,""),te&&(I=I.replace(Ga,"!")),z=0;z<S.length;++z)if((te?S[z].replace(Ga,"!"):S[z]).replace(Gr,"")==I||(te?F[z].replace(Ga,"!"):F[z]).replace(Gr,"")==I)return w.FileIndex[z];return null}var L=64,Y=-2,J="d0cf11e0a1b11ae1",Q=[208,207,17,224,161,177,26,225],ce="00000000000000000000000000000000",ne={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Y,FREESECT:-1,HEADER_SIGNATURE:J,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ce,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Se(w,C,S){l();var F=j(w,S);o.writeFileSync(C,F)}function V(w){for(var C=new Array(w.length),S=0;S<w.length;++S)C[S]=String.fromCharCode(w[S]);return C.join("")}function _e(w,C){var S=j(w,C);switch(C&&C.type||"buffer"){case"file":return l(),o.writeFileSync(C.filename,S),S;case"binary":return typeof S=="string"?S:V(S);case"base64":return tn(typeof S=="string"?S:V(S));case"buffer":if(Me)return Buffer.isBuffer(S)?S:Bt(S);case"array":return typeof S=="string"?Zr(S):S}return S}var ge;function A(w){try{var C=w.InflateRaw,S=new C;if(S._processChunk(new Uint8Array([3,0]),S._finishFlushFlag),S.bytesRead)ge=w;else throw new Error("zlib does not expose bytesRead")}catch(F){console.error("cannot use native zlib: "+(F.message||F))}}function M(w,C){if(!ge)return Ks(w,C);var S=ge.InflateRaw,F=new S,N=F._processChunk(w.slice(w.l),F._finishFlushFlag);return w.l+=F.bytesRead,N}function P(w){return ge?ge.deflateRawSync(w):Ce(w)}var D=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],W=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Z=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function se(w){var C=(w<<1|w<<11)&139536|(w<<5|w<<15)&558144;return(C>>16|C>>8|C)&255}for(var ae=typeof Uint8Array<"u",ee=ae?new Uint8Array(256):[],Ee=0;Ee<256;++Ee)ee[Ee]=se(Ee);function R(w,C){var S=ee[w&255];return C<=8?S>>>8-C:(S=S<<8|ee[w>>8&255],C<=16?S>>>16-C:(S=S<<8|ee[w>>16&255],S>>>24-C))}function q(w,C){var S=C&7,F=C>>>3;return(w[F]|(S<=6?0:w[F+1]<<8))>>>S&3}function le(w,C){var S=C&7,F=C>>>3;return(w[F]|(S<=5?0:w[F+1]<<8))>>>S&7}function ve(w,C){var S=C&7,F=C>>>3;return(w[F]|(S<=4?0:w[F+1]<<8))>>>S&15}function Te(w,C){var S=C&7,F=C>>>3;return(w[F]|(S<=3?0:w[F+1]<<8))>>>S&31}function fe(w,C){var S=C&7,F=C>>>3;return(w[F]|(S<=1?0:w[F+1]<<8))>>>S&127}function H(w,C,S){var F=C&7,N=C>>>3,I=(1<<S)-1,z=w[N]>>>F;return S<8-F||(z|=w[N+1]<<8-F,S<16-F)||(z|=w[N+2]<<16-F,S<24-F)||(z|=w[N+3]<<24-F),z&I}function we(w,C,S){var F=C&7,N=C>>>3;return F<=5?w[N]|=(S&7)<<F:(w[N]|=S<<F&255,w[N+1]=(S&7)>>8-F),C+3}function Ne(w,C,S){var F=C&7,N=C>>>3;return S=(S&1)<<F,w[N]|=S,C+1}function He(w,C,S){var F=C&7,N=C>>>3;return S<<=F,w[N]|=S&255,S>>>=8,w[N+1]=S,C+8}function Wr(w,C,S){var F=C&7,N=C>>>3;return S<<=F,w[N]|=S&255,S>>>=8,w[N+1]=S&255,w[N+2]=S>>>8,C+16}function Ge(w,C){var S=w.length,F=2*S>C?2*S:C+5,N=0;if(S>=C)return w;if(Me){var I=h0(F);if(w.copy)w.copy(I);else for(;N<w.length;++N)I[N]=w[N];return I}else if(ae){var z=new Uint8Array(F);if(z.set)z.set(w);else for(;N<S;++N)z[N]=w[N];return z}return w.length=F,w}function ze(w){for(var C=new Array(w),S=0;S<w;++S)C[S]=0;return C}function kr(w,C,S){var F=1,N=0,I=0,z=0,te=0,G=w.length,X=ae?new Uint16Array(32):ze(32);for(I=0;I<32;++I)X[I]=0;for(I=G;I<S;++I)w[I]=0;G=w.length;var K=ae?new Uint16Array(G):ze(G);for(I=0;I<G;++I)X[N=w[I]]++,F<N&&(F=N),K[I]=0;for(X[0]=0,I=1;I<=F;++I)X[I+16]=te=te+X[I-1]<<1;for(I=0;I<G;++I)te=w[I],te!=0&&(K[I]=X[te+16]++);var he=0;for(I=0;I<G;++I)if(he=w[I],he!=0)for(te=R(K[I],F)>>F-he,z=(1<<F+4-he)-1;z>=0;--z)C[te|z<<he]=he&15|I<<4;return F}var Re=ae?new Uint16Array(512):ze(512),xe=ae?new Uint16Array(32):ze(32);if(!ae){for(var Oe=0;Oe<512;++Oe)Re[Oe]=0;for(Oe=0;Oe<32;++Oe)xe[Oe]=0}(function(){for(var w=[],C=0;C<32;C++)w.push(5);kr(w,xe,32);var S=[];for(C=0;C<=143;C++)S.push(8);for(;C<=255;C++)S.push(9);for(;C<=279;C++)S.push(7);for(;C<=287;C++)S.push(8);kr(S,Re,288)})();var Je=function(){for(var C=ae?new Uint8Array(32768):[],S=0,F=0;S<Z.length-1;++S)for(;F<Z[S+1];++F)C[F]=S;for(;F<32768;++F)C[F]=29;var N=ae?new Uint8Array(259):[];for(S=0,F=0;S<W.length-1;++S)for(;F<W[S+1];++F)N[F]=S;function I(te,G){for(var X=0;X<te.length;){var K=Math.min(65535,te.length-X),he=X+K==te.length;for(G.write_shift(1,+he),G.write_shift(2,K),G.write_shift(2,~K&65535);K-- >0;)G[G.l++]=te[X++]}return G.l}function z(te,G){for(var X=0,K=0,he=ae?new Uint16Array(32768):[];K<te.length;){var me=Math.min(65535,te.length-K);if(me<10){for(X=we(G,X,+(K+me==te.length)),X&7&&(X+=8-(X&7)),G.l=X/8|0,G.write_shift(2,me),G.write_shift(2,~me&65535);me-- >0;)G[G.l++]=te[K++];X=G.l*8;continue}X=we(G,X,+(K+me==te.length)+2);for(var ke=0;me-- >0;){var ue=te[K];ke=(ke<<5^ue)&32767;var ye=-1,Be=0;if((ye=he[ke])&&(ye|=K&-32768,ye>K&&(ye-=32768),ye<K))for(;te[ye+Be]==te[K+Be]&&Be<250;)++Be;if(Be>2){ue=N[Be],ue<=22?X=He(G,X,ee[ue+1]>>1)-1:(He(G,X,3),X+=5,He(G,X,ee[ue-23]>>5),X+=3);var nr=ue<8?0:ue-4>>2;nr>0&&(Wr(G,X,Be-W[ue]),X+=nr),ue=C[K-ye],X=He(G,X,ee[ue]>>3),X-=3;var ir=ue<4?0:ue-2>>1;ir>0&&(Wr(G,X,K-ye-Z[ue]),X+=ir);for(var Nr=0;Nr<Be;++Nr)he[ke]=K&32767,ke=(ke<<5^te[K])&32767,++K;me-=Be-1}else ue<=143?ue=ue+48:X=Ne(G,X,1),X=He(G,X,ee[ue]),he[ke]=K&32767,++K}X=He(G,X,0)-1}return G.l=(X+7)/8|0,G.l}return function(G,X){return G.length<8?I(G,X):z(G,X)}}();function Ce(w){var C=re(50+Math.floor(w.length*1.1)),S=Je(w,C);return C.slice(0,S)}var Ze=ae?new Uint16Array(32768):ze(32768),Tr=ae?new Uint16Array(32768):ze(32768),ar=ae?new Uint16Array(128):ze(128),At=1,Sn=1;function Fn(w,C){var S=Te(w,C)+257;C+=5;var F=Te(w,C)+1;C+=5;var N=ve(w,C)+4;C+=4;for(var I=0,z=ae?new Uint8Array(19):ze(19),te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],G=1,X=ae?new Uint8Array(8):ze(8),K=ae?new Uint8Array(8):ze(8),he=z.length,me=0;me<N;++me)z[D[me]]=I=le(w,C),G<I&&(G=I),X[I]++,C+=3;var ke=0;for(X[0]=0,me=1;me<=G;++me)K[me]=ke=ke+X[me-1]<<1;for(me=0;me<he;++me)(ke=z[me])!=0&&(te[me]=K[ke]++);var ue=0;for(me=0;me<he;++me)if(ue=z[me],ue!=0){ke=ee[te[me]]>>8-ue;for(var ye=(1<<7-ue)-1;ye>=0;--ye)ar[ke|ye<<ue]=ue&7|me<<3}var Be=[];for(G=1;Be.length<S+F;)switch(ke=ar[fe(w,C)],C+=ke&7,ke>>>=3){case 16:for(I=3+q(w,C),C+=2,ke=Be[Be.length-1];I-- >0;)Be.push(ke);break;case 17:for(I=3+le(w,C),C+=3;I-- >0;)Be.push(0);break;case 18:for(I=11+fe(w,C),C+=7;I-- >0;)Be.push(0);break;default:Be.push(ke),G<ke&&(G=ke);break}var nr=Be.slice(0,S),ir=Be.slice(S);for(me=S;me<286;++me)nr[me]=0;for(me=F;me<30;++me)ir[me]=0;return At=kr(nr,Ze,286),Sn=kr(ir,Tr,30),C}function ff(w,C){if(w[0]==3&&!(w[1]&3))return[Wt(C),2];for(var S=0,F=0,N=h0(C||1<<18),I=0,z=N.length>>>0,te=0,G=0;!(F&1);){if(F=le(w,S),S+=3,F>>>1)F>>1==1?(te=9,G=5):(S=Fn(w,S),te=At,G=Sn);else{S&7&&(S+=8-(S&7));var X=w[S>>>3]|w[(S>>>3)+1]<<8;if(S+=32,X>0)for(!C&&z<I+X&&(N=Ge(N,I+X),z=N.length);X-- >0;)N[I++]=w[S>>>3],S+=8;continue}for(;;){!C&&z<I+32767&&(N=Ge(N,I+32767),z=N.length);var K=H(w,S,te),he=F>>>1==1?Re[K]:Ze[K];if(S+=he&15,he>>>=4,!(he>>>8&255))N[I++]=he;else{if(he==256)break;he-=257;var me=he<8?0:he-4>>2;me>5&&(me=0);var ke=I+W[he];me>0&&(ke+=H(w,S,me),S+=me),K=H(w,S,G),he=F>>>1==1?xe[K]:Tr[K],S+=he&15,he>>>=4;var ue=he<4?0:he-2>>1,ye=Z[he];for(ue>0&&(ye+=H(w,S,ue),S+=ue),!C&&z<ke&&(N=Ge(N,ke+100),z=N.length);I<ke;)N[I]=N[I-ye],++I}}}return C?[N,S+7>>>3]:[N.slice(0,I),S+7>>>3]}function Ks(w,C){var S=w.slice(w.l||0),F=ff(S,C);return w.l+=F[1],F[0]}function Qs(w,C){if(w)typeof console<"u"&&console.error(C);else throw new Error(C)}function qs(w,C){var S=w;Dr(S,0);var F=[],N=[],I={FileIndex:F,FullPaths:N};y(I,{root:C.root});for(var z=S.length-4;(S[z]!=80||S[z+1]!=75||S[z+2]!=5||S[z+3]!=6)&&z>=0;)--z;S.l=z+4,S.l+=4;var te=S.read_shift(2);S.l+=6;var G=S.read_shift(4);for(S.l=G,z=0;z<te;++z){S.l+=20;var X=S.read_shift(4),K=S.read_shift(4),he=S.read_shift(2),me=S.read_shift(2),ke=S.read_shift(2);S.l+=8;var ue=S.read_shift(4),ye=c(S.slice(S.l+he,S.l+he+me));S.l+=he+me+ke;var Be=S.l;S.l=ue+4,hf(S,X,K,I,ye),S.l=Be}return I}function hf(w,C,S,F,N){w.l+=2;var I=w.read_shift(2),z=w.read_shift(2),te=s(w);if(I&8257)throw new Error("Unsupported ZIP encryption");for(var G=w.read_shift(4),X=w.read_shift(4),K=w.read_shift(4),he=w.read_shift(2),me=w.read_shift(2),ke="",ue=0;ue<he;++ue)ke+=String.fromCharCode(w[w.l++]);if(me){var ye=c(w.slice(w.l,w.l+me));(ye[21589]||{}).mt&&(te=ye[21589].mt),((N||{})[21589]||{}).mt&&(te=N[21589].mt)}w.l+=me;var Be=w.slice(w.l,w.l+X);switch(z){case 8:Be=M(w,K);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+z)}var nr=!1;I&8&&(G=w.read_shift(4),G==134695760&&(G=w.read_shift(4),nr=!0),X=w.read_shift(4),K=w.read_shift(4)),X!=C&&Qs(nr,"Bad compressed size: "+C+" != "+X),K!=S&&Qs(nr,"Bad uncompressed size: "+S+" != "+K),mi(F,ke,Be,{unsafe:!0,mt:te})}function uf(w,C){var S=C||{},F=[],N=[],I=re(1),z=S.compression?8:0,te=0,G=0,X=0,K=0,he=0,me=w.FullPaths[0],ke=me,ue=w.FileIndex[0],ye=[],Be=0;for(G=1;G<w.FullPaths.length;++G)if(ke=w.FullPaths[G].slice(me.length),ue=w.FileIndex[G],!(!ue.size||!ue.content||ke=="Sh33tJ5")){var nr=K,ir=re(ke.length);for(X=0;X<ke.length;++X)ir.write_shift(1,ke.charCodeAt(X)&127);ir=ir.slice(0,ir.l),ye[he]=ed.buf(ue.content,0);var Nr=ue.content;z==8&&(Nr=P(Nr)),I=re(30),I.write_shift(4,67324752),I.write_shift(2,20),I.write_shift(2,te),I.write_shift(2,z),ue.mt?i(I,ue.mt):I.write_shift(4,0),I.write_shift(-4,ye[he]),I.write_shift(4,Nr.length),I.write_shift(4,ue.content.length),I.write_shift(2,ir.length),I.write_shift(2,0),K+=I.length,F.push(I),K+=ir.length,F.push(ir),K+=Nr.length,F.push(Nr),I=re(46),I.write_shift(4,33639248),I.write_shift(2,0),I.write_shift(2,20),I.write_shift(2,te),I.write_shift(2,z),I.write_shift(4,0),I.write_shift(-4,ye[he]),I.write_shift(4,Nr.length),I.write_shift(4,ue.content.length),I.write_shift(2,ir.length),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(4,0),I.write_shift(4,nr),Be+=I.l,N.push(I),Be+=ir.length,N.push(ir),++he}return I=re(22),I.write_shift(4,101010256),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(2,he),I.write_shift(2,he),I.write_shift(4,Be),I.write_shift(4,K),I.write_shift(2,0),Fr([Fr(F),Fr(N),I])}var An={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function df(w,C){if(w.ctype)return w.ctype;var S=w.name||"",F=S.match(/\.([^\.]+)$/);return F&&An[F[1]]||C&&(F=(S=C).match(/[\.\\]([^\.\\])+$/),F&&An[F[1]])?An[F[1]]:"application/octet-stream"}function xf(w){for(var C=tn(w),S=[],F=0;F<C.length;F+=76)S.push(C.slice(F,F+76));return S.join(`\r
`)+`\r
`}function pf(w){var C=w.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(X){var K=X.charCodeAt(0).toString(16).toUpperCase();return"="+(K.length==1?"0"+K:K)});C=C.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),C.charAt(0)==`
`&&(C="=0D"+C.slice(1)),C=C.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var S=[],F=C.split(`\r
`),N=0;N<F.length;++N){var I=F[N];if(I.length==0){S.push("");continue}for(var z=0;z<I.length;){var te=76,G=I.slice(z,z+te);G.charAt(te-1)=="="?te--:G.charAt(te-2)=="="?te-=2:G.charAt(te-3)=="="&&(te-=3),G=I.slice(z,z+te),z+=te,z<I.length&&(G+="="),S.push(G)}}return S.join(`\r
`)}function gf(w){for(var C=[],S=0;S<w.length;++S){for(var F=w[S];S<=w.length&&F.charAt(F.length-1)=="=";)F=F.slice(0,F.length-1)+w[++S];C.push(F)}for(var N=0;N<C.length;++N)C[N]=C[N].replace(/[=][0-9A-Fa-f]{2}/g,function(I){return String.fromCharCode(parseInt(I.slice(1),16))});return Zr(C.join(`\r
`))}function mf(w,C,S){for(var F="",N="",I="",z,te=0;te<10;++te){var G=C[te];if(!G||G.match(/^\s*$/))break;var X=G.match(/^(.*?):\s*([^\s].*)$/);if(X)switch(X[1].toLowerCase()){case"content-location":F=X[2].trim();break;case"content-type":I=X[2].trim();break;case"content-transfer-encoding":N=X[2].trim();break}}switch(++te,N.toLowerCase()){case"base64":z=Zr(at(C.slice(te).join("")));break;case"quoted-printable":z=gf(C.slice(te));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+N)}var K=mi(w,F.slice(S.length),z,{unsafe:!0});I&&(K.ctype=I)}function vf(w,C){if(V(w.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var S=C&&C.root||"",F=(Me&&Buffer.isBuffer(w)?w.toString("binary"):V(w)).split(`\r
`),N=0,I="";for(N=0;N<F.length;++N)if(I=F[N],!!/^Content-Location:/i.test(I)&&(I=I.slice(I.indexOf("file")),S||(S=I.slice(0,I.lastIndexOf("/")+1)),I.slice(0,S.length)!=S))for(;S.length>0&&(S=S.slice(0,S.length-1),S=S.slice(0,S.lastIndexOf("/")+1),I.slice(0,S.length)!=S););var z=(F[1]||"").match(/boundary="(.*?)"/);if(!z)throw new Error("MAD cannot find boundary");var te="--"+(z[1]||""),G=[],X=[],K={FileIndex:G,FullPaths:X};y(K);var he,me=0;for(N=0;N<F.length;++N){var ke=F[N];ke!==te&&ke!==te+"--"||(me++&&mf(K,F.slice(he,N),S),he=N)}return K}function wf(w,C){var S=C||{},F=S.boundary||"SheetJS";F="------="+F;for(var N=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+F.slice(2)+'"',"","",""],I=w.FullPaths[0],z=I,te=w.FileIndex[0],G=1;G<w.FullPaths.length;++G)if(z=w.FullPaths[G].slice(I.length),te=w.FileIndex[G],!(!te.size||!te.content||z=="Sh33tJ5")){z=z.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Be){return"_x"+Be.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Be){return"_u"+Be.charCodeAt(0).toString(16)+"_"});for(var X=te.content,K=Me&&Buffer.isBuffer(X)?X.toString("binary"):V(X),he=0,me=Math.min(1024,K.length),ke=0,ue=0;ue<=me;++ue)(ke=K.charCodeAt(ue))>=32&&ke<128&&++he;var ye=he>=me*4/5;N.push(F),N.push("Content-Location: "+(S.root||"file:///C:/SheetJS/")+z),N.push("Content-Transfer-Encoding: "+(ye?"quoted-printable":"base64")),N.push("Content-Type: "+df(te,z)),N.push(""),N.push(ye?pf(K):xf(K))}return N.push(F+`--\r
`),N.join(`\r
`)}function yf(w){var C={};return y(C,w),C}function mi(w,C,S,F){var N=F&&F.unsafe;N||y(w);var I=!N&&Fe.find(w,C);if(!I){var z=w.FullPaths[0];C.slice(0,z.length)==z?z=C:(z.slice(-1)!="/"&&(z+="/"),z=(z+C).replace("//","/")),I={name:n(C),type:2},w.FileIndex.push(I),w.FullPaths.push(z),N||Fe.utils.cfb_gc(w)}return I.content=S,I.size=S?S.length:0,F&&(F.CLSID&&(I.clsid=F.CLSID),F.mt&&(I.mt=F.mt),F.ct&&(I.ct=F.ct)),I}function _f(w,C){y(w);var S=Fe.find(w,C);if(S){for(var F=0;F<w.FileIndex.length;++F)if(w.FileIndex[F]==S)return w.FileIndex.splice(F,1),w.FullPaths.splice(F,1),!0}return!1}function kf(w,C,S){y(w);var F=Fe.find(w,C);if(F){for(var N=0;N<w.FileIndex.length;++N)if(w.FileIndex[N]==F)return w.FileIndex[N].name=n(S),w.FullPaths[N]=S,!0}return!1}function Tf(w){B(w,!0)}return t.find=U,t.read=E,t.parse=f,t.write=_e,t.writeFile=Se,t.utils={cfb_new:yf,cfb_add:mi,cfb_del:_f,cfb_mov:kf,cfb_gc:Tf,ReadShift:Xa,CheckField:Bo,prep_blob:Dr,bconcat:Fr,use_zlib:A,_deflateRaw:Ce,_inflateRaw:Ks,consts:ne},t}();function rd(e){return typeof e=="string"?li(e):Array.isArray(e)?Au(e):e}function mn(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=li(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var a=r=="utf8"?kt(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,e);if(typeof Blob<"u"){var n=new Blob([rd(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if(typeof saveAs<"u")return saveAs(n,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=e,s.href=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(e);return c.open("w"),c.encoding="binary",Array.isArray(t)&&(t=Gt(t)),c.write(t),c.close(),t}catch(o){if(!o.message||!o.message.match(/onstruct/))throw o}throw new Error("cannot save file "+e)}function td(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function hr(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function w0(e,t){for(var r=[],a=hr(e),n=0;n!==a.length;++n)r[e[a[n]][t]]==null&&(r[e[a[n]][t]]=a[n]);return r}function fi(e){for(var t=[],r=hr(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function hi(e){for(var t=[],r=hr(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}function ad(e){for(var t=[],r=hr(e),a=0;a!==r.length;++a)t[e[r[a]]]==null&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}var Qn=new Date(1899,11,30,0,0,0);function _r(e,t){var r=e.getTime(),a=Qn.getTime()+(e.getTimezoneOffset()-Qn.getTimezoneOffset())*6e4;return(r-a)/(24*60*60*1e3)}var uo=new Date,nd=Qn.getTime()+(uo.getTimezoneOffset()-Qn.getTimezoneOffset())*6e4,y0=uo.getTimezoneOffset();function ui(e){var t=new Date;return t.setTime(e*24*60*60*1e3+nd),t.getTimezoneOffset()!==y0&&t.setTime(t.getTime()+(t.getTimezoneOffset()-y0)*6e4),t}function id(e){var t=0,r=0,a=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=n.length;++i)if(n[i]){switch(r=1,i>3&&(a=!0),n[i].slice(n[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[i].slice(n[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(n[i],10)}return t}var _0=new Date("2017-02-19T19:06:09.000Z"),xo=isNaN(_0.getFullYear())?new Date("2/19/17"):_0,sd=xo.getFullYear()==2017;function rr(e,t){var r=new Date(e);if(sd)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(xo.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function sa(e,t){if(Me&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return kt(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return kt(Zc(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return kt(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return kt(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"‚Ç¨":"¬Ä","‚Äö":"¬Ç",∆í:"¬É","‚Äû":"¬Ñ","‚Ä¶":"¬Ö","‚Ä†":"¬Ü","‚Ä°":"¬á","ÀÜ":"¬à","‚Ä∞":"¬â",≈†:"¬ä","‚Äπ":"¬ã",≈í:"¬å",≈Ω:"¬é","‚Äò":"¬ë","‚Äô":"¬í","‚Äú":"¬ì","‚Äù":"¬î","‚Ä¢":"¬ï","‚Äì":"¬ñ","‚Äî":"¬ó","Àú":"¬ò","‚Ñ¢":"¬ô",≈°:"¬ö","‚Ä∫":"¬õ",≈ì:"¬ú",≈æ:"¬û",≈∏:"¬ü"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[‚Ç¨‚Äö∆í‚Äû‚Ä¶‚Ä†‚Ä°ÀÜ‚Ä∞≈†‚Äπ≈í≈Ω‚Äò‚Äô‚Äú‚Äù‚Ä¢‚Äì‚ÄîÀú‚Ñ¢≈°‚Ä∫≈ì≈æ≈∏]/g,function(i){return r[i]||i})}catch{}for(var a=[],n=0;n!=e.length;++n)a.push(String.fromCharCode(e[n]));return a.join("")}function tr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=tr(e[r]));return t}function lr(e,t){for(var r="";r.length<t;)r+=e;return r}function gt(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(n,i){return r=-r,i}),!isNaN(t=Number(a)))?t/r:t}var cd=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ca(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),n=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&cd.indexOf(s)==-1)return r}else if(s.match(/[a-z]/))return r;return a<0||a>8099?r:(n>0||i>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var od=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,a,n){if(e||typeof a=="string")return r.split(a);for(var i=r.split(a),s=[i[0]],c=1;c<i.length;++c)s.push(n),s.push(i[c]);return s}}();function po(e){return e?e.content&&e.type?sa(e.content,!0):e.data?$a(e.data):e.asNodeBuffer&&Me?$a(e.asNodeBuffer().toString("binary")):e.asBinary?$a(e.asBinary()):e._data&&e._data.getContent?$a(sa(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function go(e){if(!e)return null;if(e.data)return l0(e.data);if(e.asNodeBuffer&&Me)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?l0(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function ld(e){return e&&e.name.slice(-4)===".bin"?go(e):po(e)}function lt(e,t){for(var r=e.FullPaths||hr(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),n=a.replace(/\\/g,"/"),i=0;i<r.length;++i){var s=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==s||n==s)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function xs(e,t){var r=lt(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function mr(e,t,r){if(!r)return ld(xs(e,t));if(!t)return null;try{return mr(e,t)}catch{return null}}function et(e,t,r){if(!r)return po(xs(e,t));if(!t)return null;try{return et(e,t)}catch{return null}}function fd(e,t,r){return go(xs(e,t))}function k0(e){for(var t=e.FullPaths||hr(e.files),r=[],a=0;a<t.length;++a)t[a].slice(-1)!="/"&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function Le(e,t,r){if(e.FullPaths){if(typeof r=="string"){var a;return Me?a=Bt(r):a=bu(r),Fe.utils.cfb_add(e,t,a)}Fe.utils.cfb_add(e,t,r)}else e.file(t,r)}function ps(){return Fe.utils.cfb_new()}function mo(e,t){switch(t.type){case"base64":return Fe.read(e,{type:"base64"});case"binary":return Fe.read(e,{type:"binary"});case"buffer":case"array":return Fe.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function za(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var a=e.split("/");a.length!==0;){var n=a.shift();n===".."?r.pop():n!=="."&&r.push(n)}return r.join("/")}var pr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,hd=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,T0=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,ud=/<[^>]*>/g,Ur=pr.match(T0)?T0:ud,dd=/<\w*:/,xd=/<(\/?)\w+:/;function De(e,t,r){for(var a={},n=0,i=0;n!==e.length&&!((i=e.charCodeAt(n))===32||i===10||i===13);++n);if(t||(a[0]=e.slice(0,n)),n===e.length)return a;var s=e.match(hd),c=0,o="",l=0,f="",u="",d=1;if(s)for(l=0;l!=s.length;++l){for(u=s[l],i=0;i!=u.length&&u.charCodeAt(i)!==61;++i);for(f=u.slice(0,i).trim();u.charCodeAt(i+1)==32;)++i;for(d=(n=u.charCodeAt(i+1))==34||n==39?1:0,o=u.slice(i+1+d,u.length-d),c=0;c!=f.length&&f.charCodeAt(c)!==58;++c);if(c===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),a[f]=o,a[f.toLowerCase()]=o;else{var x=(c===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(c+1);if(a[x]&&f.slice(c-3,c)=="ext")continue;a[x]=o,a[x.toLowerCase()]=o}}return a}function St(e){return e.replace(xd,"<$1")}var vo={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},gs=fi(vo),Ue=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(a){var n=a+"",i=n.indexOf("<![CDATA[");if(i==-1)return n.replace(e,function(c,o){return vo[c]||String.fromCharCode(parseInt(o,c.indexOf("x")>-1?16:10))||c}).replace(t,function(c,o){return String.fromCharCode(parseInt(o,16))});var s=n.indexOf("]]>");return r(n.slice(0,i))+n.slice(i+9,s)+r(n.slice(s+3))}}(),ms=/[&<>'"]/g,pd=/[\u0000-\u0008\u000b-\u001f]/g;function Ke(e){var t=e+"";return t.replace(ms,function(r){return gs[r]}).replace(pd,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function E0(e){return Ke(e).replace(/ /g,"_x0020_")}var wo=/[\u0000-\u001f]/g;function vs(e){var t=e+"";return t.replace(ms,function(r){return gs[r]}).replace(/\n/g,"<br/>").replace(wo,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function gd(e){var t=e+"";return t.replace(ms,function(r){return gs[r]}).replace(wo,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var S0=function(){var e=/&#(\d+);/g;function t(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,t)}}();function md(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function er(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Ei(e){for(var t="",r=0,a=0,n=0,i=0,s=0,c=0;r<e.length;){if(a=e.charCodeAt(r++),a<128){t+=String.fromCharCode(a);continue}if(n=e.charCodeAt(r++),a>191&&a<224){s=(a&31)<<6,s|=n&63,t+=String.fromCharCode(s);continue}if(i=e.charCodeAt(r++),a<240){t+=String.fromCharCode((a&15)<<12|(n&63)<<6|i&63);continue}s=e.charCodeAt(r++),c=((a&7)<<18|(n&63)<<12|(i&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(c>>>10&1023)),t+=String.fromCharCode(56320+(c&1023))}return t}function F0(e){var t=Wt(2*e.length),r,a,n=1,i=0,s=0,c;for(a=0;a<e.length;a+=n)n=1,(c=e.charCodeAt(a))<128?r=c:c<224?(r=(c&31)*64+(e.charCodeAt(a+1)&63),n=2):c<240?(r=(c&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),n=3):(n=4,r=(c&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[i++]=s&255,t[i++]=s>>>8,s=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function A0(e){return Bt(e,"binary").toString("utf8")}var Dn="foo bar baz√¢¬ò¬É√∞¬ü¬ç¬£",Qe=Me&&(A0(Dn)==Ei(Dn)&&A0||F0(Dn)==Ei(Dn)&&F0)||Ei,kt=Me?function(e){return Bt(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,n=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,n=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},nn=function(){var e={};return function(r,a){var n=r+"|"+(a||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}}(),yo=function(){var e=[["nbsp"," "],["middot","¬∑"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)a=a.replace(e[n][0],e[n][1]);return a}}(),vd=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),wd=/<\/?(?:vt:)?variant>/g,yd=/<(?:vt:)([^>]*)>([\s\S]*)</;function b0(e,t){var r=De(e),a=e.match(vd(r.baseType))||[],n=[];if(a.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return n}return a.forEach(function(i){var s=i.replace(wd,"").match(yd);s&&n.push({v:Qe(s[2]),t:s[1]})}),n}var _o=/(^\s|\s$|\n)/;function Cr(e,t){return"<"+e+(t.match(_o)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function sn(e){return hr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function de(e,t,r){return"<"+e+(r!=null?sn(r):"")+(t!=null?(t.match(_o)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Hi(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function _d(e,t){switch(typeof e){case"string":var r=de("vt:lpwstr",Ke(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return de((e|0)==e?"vt:i4":"vt:r8",Ke(String(e)));case"boolean":return de("vt:bool",e?"true":"false")}if(e instanceof Date)return de("vt:filetime",Hi(e));throw new Error("Unable to serialize "+e)}function ws(e){if(Me&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Qe(Gt(hs(e)));throw new Error("Bad input format: expected Buffer or string")}var cn=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,wr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},xa=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],qr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function kd(e,t){for(var r=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),n=e[t+6]&15,i=5;i>=0;--i)n=n*256+e[t+i];return a==2047?n==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,n+=Math.pow(2,52)),r*Math.pow(2,a-52)*n)}function Td(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,n=0,i=0,s=a?-t:t;isFinite(s)?s==0?n=i=0:(n=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-n),n<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?n=-1022:(i-=Math.pow(2,52),n+=1023)):(n=2047,i=isNaN(t)?26985:0);for(var c=0;c<=5;++c,i/=256)e[r+c]=i&255;e[r+6]=(n&15)<<4|i&15,e[r+7]=n>>4|a}var D0=function(e){for(var t=[],r=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var n=0,i=e[0][a].length;n<i;n+=r)t.push.apply(t,e[0][a].slice(n,n+r));return t},C0=Me?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Bt(t)})):D0(e)}:D0,N0=function(e,t,r){for(var a=[],n=t;n<r;n+=2)a.push(String.fromCharCode(Dt(e,n)));return a.join("").replace(Gr,"")},ys=Me?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Gr,""):N0(e,t,r)}:N0,I0=function(e,t,r){for(var a=[],n=t;n<t+r;++n)a.push(("0"+e[n].toString(16)).slice(-2));return a.join("")},ko=Me?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):I0(e,t,r)}:I0,R0=function(e,t,r){for(var a=[],n=t;n<r;n++)a.push(String.fromCharCode(Ta(e,n)));return a.join("")},vn=Me?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf8",r,a):R0(t,r,a)}:R0,To=function(e,t){var r=Jr(e,t);return r>0?vn(e,t+4,t+4+r-1):""},Eo=To,So=function(e,t){var r=Jr(e,t);return r>0?vn(e,t+4,t+4+r-1):""},Fo=So,Ao=function(e,t){var r=2*Jr(e,t);return r>0?vn(e,t+4,t+4+r-1):""},bo=Ao,Do=function(t,r){var a=Jr(t,r);return a>0?ys(t,r+4,r+4+a):""},Co=Do,No=function(e,t){var r=Jr(e,t);return r>0?vn(e,t+4,t+4+r):""},Io=No,Ro=function(e,t){return kd(e,t)},qn=Ro,_s=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Me&&(Eo=function(t,r){if(!Buffer.isBuffer(t))return To(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},Fo=function(t,r){if(!Buffer.isBuffer(t))return So(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},bo=function(t,r){if(!Buffer.isBuffer(t))return Ao(t,r);var a=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a-1)},Co=function(t,r){if(!Buffer.isBuffer(t))return Do(t,r);var a=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a)},Io=function(t,r){if(!Buffer.isBuffer(t))return No(t,r);var a=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+a)},qn=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Ro(t,r)},_s=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Ta=function(e,t){return e[t]},Dt=function(e,t){return e[t+1]*256+e[t]},Ed=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Jr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Kt=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Sd=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Xa(e,t){var r="",a,n,i=[],s,c,o,l;switch(t){case"dbcs":if(l=this.l,Me&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(o=0;o<e;++o)r+=String.fromCharCode(Dt(this,l)),l+=2;e*=2;break;case"utf8":r=vn(this,this.l,this.l+e);break;case"utf16le":e*=2,r=ys(this,this.l,this.l+e);break;case"wstr":return Xa.call(this,e,"dbcs");case"lpstr-ansi":r=Eo(this,this.l),e=4+Jr(this,this.l);break;case"lpstr-cp":r=Fo(this,this.l),e=4+Jr(this,this.l);break;case"lpwstr":r=bo(this,this.l),e=4+2*Jr(this,this.l);break;case"lpp4":e=4+Jr(this,this.l),r=Co(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Jr(this,this.l),r=Io(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=Ta(this,this.l+e++))!==0;)i.push(bn(s));r=i.join("");break;case"_wstr":for(e=0,r="";(s=Dt(this,this.l+e))!==0;)i.push(bn(s)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",l=this.l,o=0;o<e;++o){if(this.lens&&this.lens.indexOf(l)!==-1)return s=Ta(this,l),this.l=l+1,c=Xa.call(this,e-o,s?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(bn(Dt(this,l))),l+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",l=this.l,o=0;o!=e;++o){if(this.lens&&this.lens.indexOf(l)!==-1)return s=Ta(this,l),this.l=l+1,c=Xa.call(this,e-o,s?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(bn(Ta(this,l))),l+=1}r=i.join("");break;default:switch(e){case 1:return a=Ta(this,this.l),this.l++,a;case 2:return a=(t==="i"?Ed:Dt)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(a=(e>0?Kt:Sd)(this,this.l),this.l+=4,a):(n=Jr(this,this.l),this.l+=4,n);case 8:case-8:if(t==="f")return e==8?n=qn(this,this.l):n=qn([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:r=ko(this,this.l,e);break}}return this.l+=e,r}var Fd=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},Ad=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},bd=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function Dd(e,t,r){var a=0,n=0;if(r==="dbcs"){for(n=0;n!=t.length;++n)bd(this,t.charCodeAt(n),this.l+2*n);a=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=t.charCodeAt(n)&255;a=t.length}else if(r==="hex"){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(n=0;n<Math.min(t.length,e);++n){var s=t.charCodeAt(n);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,Fd(this,t,this.l);break;case 8:if(a=8,r==="f"){Td(this,t,this.l);break}case 16:break;case-4:a=4,Ad(this,t,this.l);break}return this.l+=a,this}function Bo(e,t){var r=ko(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Dr(e,t){e.l=t,e.read_shift=Xa,e.chk=Bo,e.write_shift=Dd}function jr(e,t){e.l+=t}function re(e){var t=Wt(e);return Dr(t,0),t}function Ot(e,t,r){if(e){var a,n,i;Dr(e,e.l||0);for(var s=e.length,c=0,o=0;e.l<s;){c=e.read_shift(1),c&128&&(c=(c&127)+((e.read_shift(1)&127)<<7));var l=dn[c]||dn[65535];for(a=e.read_shift(1),i=a&127,n=1;n<4&&a&128;++n)i+=((a=e.read_shift(1))&127)<<7*n;o=e.l+i;var f=l.f&&l.f(e,i,r);if(e.l=o,t(f,l,c))return}}}function Xr(){var e=[],t=Me?256:2048,r=function(l){var f=re(l);return Dr(f,0),f},a=r(t),n=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},i=function(l){return a&&l<a.length-a.l?a:(n(),a=r(Math.max(l+1,t)))},s=function(){return n(),Fr(e)},c=function(l){n(),a=l,a.l==null&&(a.l=a.length),i(t)};return{next:i,push:c,end:s,_bufs:e}}function oe(e,t,r,a){var n=+t,i;if(!isNaN(n)){a||(a=dn[n].p||(r||[]).length||0),i=1+(n>=128?1:0)+1,a>=128&&++i,a>=16384&&++i,a>=2097152&&++i;var s=e.next(i);n<=127?s.write_shift(1,n):(s.write_shift(1,(n&127)+128),s.write_shift(1,n>>7));for(var c=0;c!=4;++c)if(a>=128)s.write_shift(1,(a&127)+128),a>>=7;else{s.write_shift(1,a);break}a>0&&_s(r)&&e.push(r)}}function Ya(e,t,r){var a=tr(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function B0(e,t,r){var a=tr(e);return a.s=Ya(a.s,t.s,r),a.e=Ya(a.e,t.s,r),a}function Ka(e,t){if(e.cRel&&e.c<0)for(e=tr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=tr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=be(e);return!e.cRel&&e.cRel!=null&&(r=Id(r)),!e.rRel&&e.rRel!=null&&(r=Cd(r)),r}function Si(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+sr(e.s.c)+":"+(e.e.cRel?"":"$")+sr(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+xr(e.s.r)+":"+(e.e.rRel?"":"$")+xr(e.e.r):Ka(e.s,t.biff)+":"+Ka(e.e,t.biff)}function ks(e){return parseInt(Nd(e),10)-1}function xr(e){return""+(e+1)}function Cd(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Nd(e){return e.replace(/\$(\d+)$/,"$1")}function Ts(e){for(var t=Rd(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function sr(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Id(e){return e.replace(/^([A-Z])/,"$$$1")}function Rd(e){return e.replace(/^\$([A-Z])/,"$1")}function Bd(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function cr(e){for(var t=0,r=0,a=0;a<e.length;++a){var n=e.charCodeAt(a);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function be(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Yr(e){var t=e.indexOf(":");return t==-1?{s:cr(e),e:cr(e)}:{s:cr(e.slice(0,t)),e:cr(e.slice(t+1))}}function Pe(e,t){return typeof t>"u"||typeof t=="number"?Pe(e.s,e.e):(typeof e!="string"&&(e=be(e)),typeof t!="string"&&(t=be(t)),e==t?e:e+":"+t)}function We(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,n=0,i=e.length;for(r=0;a<i&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.s.c=--r,r=0;a<i&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;if(t.s.r=--r,a===i||n!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=i&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.e.c=--r,r=0;a!=i&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;return t.e.r=--r,t}function O0(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=nt(e.z,r?_r(t):t)}catch{}try{return e.w=nt((e.XF||{}).numFmtId||(r?14:0),r?_r(t):t)}catch{return""+t}}function Rt(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Pt[e.v]||e.v:t==null?O0(e,e.v):O0(e,t))}function zt(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function Oo(e,t,r){var a=r||{},n=e?Array.isArray(e):a.dense,i=e||(n?[]:{}),s=0,c=0;if(i&&a.origin!=null){if(typeof a.origin=="number")s=a.origin;else{var o=typeof a.origin=="string"?cr(a.origin):a.origin;s=o.r,c=o.c}i["!ref"]||(i["!ref"]="A1:A1")}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var f=We(i["!ref"]);l.s.c=f.s.c,l.s.r=f.s.r,l.e.c=Math.max(l.e.c,f.e.c),l.e.r=Math.max(l.e.r,f.e.r),s==-1&&(l.e.r=s=f.e.r+1)}for(var u=0;u!=t.length;++u)if(t[u]){if(!Array.isArray(t[u]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=t[u].length;++d)if(!(typeof t[u][d]>"u")){var x={v:t[u][d]},g=s+u,p=c+d;if(l.s.r>g&&(l.s.r=g),l.s.c>p&&(l.s.c=p),l.e.r<g&&(l.e.r=g),l.e.c<p&&(l.e.c=p),t[u][d]&&typeof t[u][d]=="object"&&!Array.isArray(t[u][d])&&!(t[u][d]instanceof Date))x=t[u][d];else if(Array.isArray(x.v)&&(x.f=t[u][d][1],x.v=x.v[0]),x.v===null)if(x.f)x.t="n";else if(a.nullError)x.t="e",x.v=0;else if(a.sheetStubs)x.t="z";else continue;else typeof x.v=="number"?x.t="n":typeof x.v=="boolean"?x.t="b":x.v instanceof Date?(x.z=a.dateNF||Ae[14],a.cellDates?(x.t="d",x.w=nt(x.z,_r(x.v))):(x.t="n",x.v=_r(x.v),x.w=nt(x.z,x.v))):x.t="s";if(n)i[g]||(i[g]=[]),i[g][p]&&i[g][p].z&&(x.z=i[g][p].z),i[g][p]=x;else{var m=be({c:p,r:g});i[m]&&i[m].z&&(x.z=i[m].z),i[m]=x}}}return l.s.c<1e7&&(i["!ref"]=Pe(l)),i}function Ba(e,t){return Oo(null,e,t)}function Od(e){return e.read_shift(4,"i")}function mt(e,t){return t||(t=re(4)),t.write_shift(4,e),t}function Mr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Ar(e,t){var r=!1;return t==null&&(r=!0,t=re(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function Pd(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Ld(e,t){return t||(t=re(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Es(e,t){var r=e.l,a=e.read_shift(1),n=Mr(e),i=[],s={t:n,h:n};if(a&1){for(var c=e.read_shift(4),o=0;o!=c;++o)i.push(Pd(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}function Md(e,t){var r=!1;return t==null&&(r=!0,t=re(15+4*e.t.length)),t.write_shift(1,0),Ar(e.t,t),r?t.slice(0,t.l):t}var jd=Es;function Ud(e,t){var r=!1;return t==null&&(r=!0,t=re(23+4*e.t.length)),t.write_shift(1,1),Ar(e.t,t),t.write_shift(4,1),Ld({},t),r?t.slice(0,t.l):t}function ut(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function pa(e,t){return t==null&&(t=re(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function ga(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function ma(e,t){return t==null&&(t=re(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var Wd=Mr,Po=Ar;function Ss(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Jn(e,t){var r=!1;return t==null&&(r=!0,t=re(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var Vd=Mr,$i=Ss,Fs=Jn;function As(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,a=t[0]&2;e.l+=4;var n=a===0?qn([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Kt(t,0)>>2;return r?n/100:n}function Lo(e,t){t==null&&(t=re(4));var r=0,a=0,n=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?a=1:n==(n|0)&&n>=-536870912&&n<1<<29&&(a=1,r=1),a)t.write_shift(-4,((r?n:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function Mo(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function Hd(e,t){return t||(t=re(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var va=Mo,Oa=Hd;function Lr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ca(e,t){return(t||re(8)).write_shift(8,e,"f")}function $d(e){var t={},r=e.read_shift(1),a=r>>>1,n=e.read_shift(1),i=e.read_shift(2,"i"),s=e.read_shift(1),c=e.read_shift(1),o=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=n;var l=Jt[n];l&&(t.rgb=ln(l));break;case 2:t.rgb=ln([s,c,o]);break;case 3:t.theme=n;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function Zn(e,t){if(t||(t=re(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}return t}function Gd(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function zd(e,t){t||(t=re(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function jo(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function Xd(e){return jo(e,1)}function Yd(e){return jo(e,2)}var bs=2,zr=3,Cn=11,P0=12,ei=19,Nn=64,Kd=65,Qd=71,qd=4108,Jd=4126,Er=80,Uo=81,Zd=[Er,Uo],Gi={1:{n:"CodePage",t:bs},2:{n:"Category",t:Er},3:{n:"PresentationFormat",t:Er},4:{n:"ByteCount",t:zr},5:{n:"LineCount",t:zr},6:{n:"ParagraphCount",t:zr},7:{n:"SlideCount",t:zr},8:{n:"NoteCount",t:zr},9:{n:"HiddenCount",t:zr},10:{n:"MultimediaClipCount",t:zr},11:{n:"ScaleCrop",t:Cn},12:{n:"HeadingPairs",t:qd},13:{n:"TitlesOfParts",t:Jd},14:{n:"Manager",t:Er},15:{n:"Company",t:Er},16:{n:"LinksUpToDate",t:Cn},17:{n:"CharacterCount",t:zr},19:{n:"SharedDoc",t:Cn},22:{n:"HyperlinksChanged",t:Cn},23:{n:"AppVersion",t:zr,p:"version"},24:{n:"DigSig",t:Kd},26:{n:"ContentType",t:Er},27:{n:"ContentStatus",t:Er},28:{n:"Language",t:Er},29:{n:"Version",t:Er},255:{},2147483648:{n:"Locale",t:ei},2147483651:{n:"Behavior",t:ei},1919054434:{}},zi={1:{n:"CodePage",t:bs},2:{n:"Title",t:Er},3:{n:"Subject",t:Er},4:{n:"Author",t:Er},5:{n:"Keywords",t:Er},6:{n:"Comments",t:Er},7:{n:"Template",t:Er},8:{n:"LastAuthor",t:Er},9:{n:"RevNumber",t:Er},10:{n:"EditTime",t:Nn},11:{n:"LastPrinted",t:Nn},12:{n:"CreatedDate",t:Nn},13:{n:"ModifiedDate",t:Nn},14:{n:"PageCount",t:zr},15:{n:"WordCount",t:zr},16:{n:"CharCount",t:zr},17:{n:"Thumbnail",t:Qd},18:{n:"Application",t:Er},19:{n:"DocSecurity",t:zr},255:{},2147483648:{n:"Locale",t:ei},2147483651:{n:"Behavior",t:ei},1919054434:{}},L0={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},e1=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function r1(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var t1=r1([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Jt=tr(t1),Pt={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Wo={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Xi={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},In={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Ds(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function a1(e){var t=Ds();if(!e||!e.match)return t;var r={};if((e.match(Ur)||[]).forEach(function(a){var n=De(a);switch(n[0].replace(dd,"<")){case"<?xml":break;case"<Types":t.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":t[Xi[n.ContentType]]!==void 0&&t[Xi[n.ContentType]].push(n.PartName);break}}),t.xmlns!==wr.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function Vo(e,t){var r=ad(Xi),a=[],n;a[a.length]=pr,a[a.length]=de("Types",null,{xmlns:wr.CT,"xmlns:xsd":wr.xsd,"xmlns:xsi":wr.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(o){return de("Default",null,{Extension:o[0],ContentType:o[1]})}));var i=function(o){e[o]&&e[o].length>0&&(n=e[o][0],a[a.length]=de("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:In[o][t.bookType]||In[o].xlsx}))},s=function(o){(e[o]||[]).forEach(function(l){a[a.length]=de("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:In[o][t.bookType]||In[o].xlsx})})},c=function(o){(e[o]||[]).forEach(function(l){a[a.length]=de("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:r[o][0]})})};return i("workbooks"),s("sheets"),s("charts"),c("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),s("metadata"),c("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var je={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function on(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Qa(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var a={};return(e.match(Ur)||[]).forEach(function(n){var i=De(n);if(i[0]==="<Relationship"){var s={};s.Type=i.Type,s.Target=i.Target,s.Id=i.Id,i.TargetMode&&(s.TargetMode=i.TargetMode);var c=i.TargetMode==="External"?i.Target:za(i.Target,t);r[c]=s,a[i.Id]=s}}),r["!id"]=a,r}function Aa(e){var t=[pr,de("Relationships",null,{xmlns:wr.RELS})];return hr(e["!id"]).forEach(function(r){t[t.length]=de("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Ye(e,t,r,a,n,i){if(n||(n={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,n.Id="rId"+t,n.Type=a,n.Target=r,[je.HLINK,je.XPATH,je.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),e["!id"][n.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,t}var n1="application/vnd.oasis.opendocument.spreadsheet";function i1(e,t){for(var r=ws(e),a,n;a=cn.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(n=De(a[0],!1),n.path=="/"&&n.type!==n1)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw a}}function s1(e){var t=[pr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function M0(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function c1(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function o1(e){var t=[pr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(M0(e[r][0],e[r][1])),t.push(c1("",e[r][0]));return t.push(M0("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Ho(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+zn.version+"</meta:generator></office:meta></office:document-meta>"}var ht=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],l1=function(){for(var e=new Array(ht.length),t=0;t<ht.length;++t){var r=ht[t],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e}();function $o(e){var t={};e=Qe(e);for(var r=0;r<ht.length;++r){var a=ht[r],n=e.match(l1[r]);n!=null&&n.length>0&&(t[a[1]]=Ue(n[1])),a[2]==="date"&&t[a[1]]&&(t[a[1]]=rr(t[a[1]]))}return t}function Fi(e,t,r,a,n){n[e]!=null||t==null||t===""||(n[e]=t,t=Ke(t),a[a.length]=r?de(e,t,r):Cr(e,t))}function Go(e,t){var r=t||{},a=[pr,de("cp:coreProperties",null,{"xmlns:cp":wr.CORE_PROPS,"xmlns:dc":wr.dc,"xmlns:dcterms":wr.dcterms,"xmlns:dcmitype":wr.dcmitype,"xmlns:xsi":wr.xsi})],n={};if(!e&&!r.Props)return a.join("");e&&(e.CreatedDate!=null&&Fi("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Hi(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n),e.ModifiedDate!=null&&Fi("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Hi(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n));for(var i=0;i!=ht.length;++i){var s=ht[i],c=r.Props&&r.Props[s[1]]!=null?r.Props[s[1]]:e?e[s[1]]:null;c===!0?c="1":c===!1?c="0":typeof c=="number"&&(c=String(c)),c!=null&&Fi(s[0],c,null,a,n)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var Zt=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],zo=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Xo(e,t,r,a){var n=[];if(typeof e=="string")n=b0(e,a);else for(var i=0;i<e.length;++i)n=n.concat(e[i].map(function(f){return{v:f}}));var s=typeof t=="string"?b0(t,a).map(function(f){return f.v}):t,c=0,o=0;if(s.length>0)for(var l=0;l!==n.length;l+=2){switch(o=+n[l+1].v,n[l].v){case"Worksheets":case"Â∑•‰ΩúË°®":case"–õ–∏—Å—Ç—ã":case"ÿ£Ÿàÿ±ÿßŸÇ ÿßŸÑÿπŸÖŸÑ":case"„ÉØ„Éº„ÇØ„Ç∑„Éº„Éà":case"◊í◊ú◊ô◊ï◊†◊ï◊™ ◊¢◊ë◊ï◊ì◊î":case"Arbeitsbl√§tter":case"√áalƒ±≈üma Sayfalarƒ±":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c√°lculo":case"Planilhas":case"Regneark":case"Hojas de c√°lculo":case"Werkbladen":r.Worksheets=o,r.SheetNames=s.slice(c,c+o);break;case"Named Ranges":case"Rangos con nombre":case"ÂêçÂâç‰ªò„Åç‰∏ÄË¶ß":case"Benannte Bereiche":case"Navngivne omr√•der":r.NamedRanges=o,r.DefinedNames=s.slice(c,c+o);break;case"Charts":case"Diagramme":r.Chartsheets=o,r.ChartNames=s.slice(c,c+o);break}c+=o}}function f1(e,t,r){var a={};return t||(t={}),e=Qe(e),Zt.forEach(function(n){var i=(e.match(nn(n[0]))||[])[1];switch(n[2]){case"string":i&&(t[n[1]]=Ue(i));break;case"bool":t[n[1]]=i==="true";break;case"raw":var s=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));s&&s.length>0&&(a[n[1]]=s[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&Xo(a.HeadingPairs,a.TitlesOfParts,t,r),t}function Yo(e){var t=[],r=de;return e||(e={}),e.Application="SheetJS",t[t.length]=pr,t[t.length]=de("Properties",null,{xmlns:wr.EXT_PROPS,"xmlns:vt":wr.vt}),Zt.forEach(function(a){if(e[a[1]]!==void 0){var n;switch(a[2]){case"string":n=Ke(String(e[a[1]]));break;case"bool":n=e[a[1]]?"true":"false";break}n!==void 0&&(t[t.length]=r(a[0],n))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+Ke(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var h1=/<[^>]+>[^<]*/g;function u1(e,t){var r={},a="",n=e.match(h1);if(n)for(var i=0;i!=n.length;++i){var s=n[i],c=De(s);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":a=Ue(c.name);break;case"</property>":a=null;break;default:if(s.indexOf("<vt:")===0){var o=s.split(">"),l=o[0].slice(4),f=o[1];switch(l){case"lpstr":case"bstr":case"lpwstr":r[a]=Ue(f);break;case"bool":r[a]=er(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(f);break;case"filetime":case"date":r[a]=rr(f);break;case"cy":case"error":r[a]=Ue(f);break;default:if(l.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",s,l,o)}}else if(s.slice(0,2)!=="</"){if(t.WTF)throw new Error(s)}}}return r}function Ko(e){var t=[pr,de("Properties",null,{xmlns:wr.CUST_PROPS,"xmlns:vt":wr.vt})];if(!e)return t.join("");var r=1;return hr(e).forEach(function(n){++r,t[t.length]=de("property",_d(e[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Ke(n)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Yi={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Ai;function d1(e,t,r){Ai||(Ai=fi(Yi)),t=Ai[t]||t,e[t]=r}function x1(e,t){var r=[];return hr(Yi).map(function(a){for(var n=0;n<ht.length;++n)if(ht[n][1]==a)return ht[n];for(n=0;n<Zt.length;++n)if(Zt[n][1]==a)return Zt[n];throw a}).forEach(function(a){if(e[a[1]]!=null){var n=t&&t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:e[a[1]];switch(a[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),r.push(Cr(Yi[a[1]]||a[1],n))}}),de("DocumentProperties",r.join(""),{xmlns:qr.o})}function p1(e,t){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",n=[];return e&&hr(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var s=0;s<ht.length;++s)if(i==ht[s][1])return;for(s=0;s<Zt.length;++s)if(i==Zt[s][1])return;for(s=0;s<r.length;++s)if(i==r[s])return;var c=e[i],o="string";typeof c=="number"?(o="float",c=String(c)):c===!0||c===!1?(o="boolean",c=c?"1":"0"):c=String(c),n.push(de(E0(i),c,{"dt:dt":o}))}}),t&&hr(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var s=t[i],c="string";typeof s=="number"?(c="float",s=String(s)):s===!0||s===!1?(c="boolean",s=s?"1":"0"):s instanceof Date?(c="dateTime.tz",s=s.toISOString()):s=String(s),n.push(de(E0(i),s,{"dt:dt":c}))}}),"<"+a+' xmlns="'+qr.o+'">'+n.join("")+"</"+a+">"}function Cs(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function g1(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,a=r%Math.pow(2,32),n=(r-a)/Math.pow(2,32);a*=1e7,n*=1e7;var i=a/Math.pow(2,32)|0;i>0&&(a=a%Math.pow(2,32),n+=i);var s=re(8);return s.write_shift(4,a),s.write_shift(4,n),s}function Qo(e,t,r){var a=e.l,n=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-a&3;)++e.l;return n}function qo(e,t,r){var a=e.read_shift(0,"lpwstr");return a}function Jo(e,t,r){return t===31?qo(e):Qo(e,t,r)}function Ki(e,t,r){return Jo(e,t,r===!1?0:4)}function m1(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Jo(e,t,0)}function v1(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a){var n=e.l;r[a]=e.read_shift(0,"lpwstr").replace(Gr,""),e.l-n&2&&(e.l+=2)}return r}function w1(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a)r[a]=e.read_shift(0,"lpstr-cp").replace(Gr,"");return r}function y1(e){var t=e.l,r=ri(e,Uo);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var a=ri(e,zr);return[r,a]}function _1(e){for(var t=e.read_shift(4),r=[],a=0;a<t/2;++a)r.push(y1(e));return r}function j0(e,t){for(var r=e.read_shift(4),a={},n=0;n!=r;++n){var i=e.read_shift(4),s=e.read_shift(4);a[i]=e.read_shift(s,t===1200?"utf16le":"utf8").replace(Gr,"").replace(Ga,"!"),t===1200&&s%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function Zo(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function k1(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function ri(e,t,r){var a=e.read_shift(2),n,i=r||{};if(e.l+=2,t!==P0&&a!==t&&Zd.indexOf(t)===-1&&!((t&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+t+" saw "+a);switch(t===P0?a:t){case 2:return n=e.read_shift(2,"i"),i.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i"),n;case 11:return e.read_shift(4)!==0;case 19:return n=e.read_shift(4),n;case 30:return Qo(e,a,4).replace(Gr,"");case 31:return qo(e);case 64:return Cs(e);case 65:return Zo(e);case 71:return k1(e);case 80:return Ki(e,a,!i.raw).replace(Gr,"");case 81:return m1(e,a).replace(Gr,"");case 4108:return _1(e);case 4126:case 4127:return a==4127?v1(e):w1(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function U0(e,t){var r=re(4),a=re(4);switch(r.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,t);break;case 5:a=re(8),a.write_shift(8,t,"f");break;case 11:a.write_shift(4,t?1:0);break;case 64:a=g1(t);break;case 31:case 80:for(a=re(4+2*(t.length+1)+(t.length%2?0:2)),a.write_shift(4,t.length+1),a.write_shift(0,t,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Fr([r,a])}function W0(e,t){var r=e.l,a=e.read_shift(4),n=e.read_shift(4),i=[],s=0,c=0,o=-1,l={};for(s=0;s!=n;++s){var f=e.read_shift(4),u=e.read_shift(4);i[s]=[f,u+r]}i.sort(function(k,v){return k[1]-v[1]});var d={};for(s=0;s!=n;++s){if(e.l!==i[s][1]){var x=!0;if(s>0&&t)switch(t[i[s-1][0]].t){case 2:e.l+2===i[s][1]&&(e.l+=2,x=!1);break;case 80:e.l<=i[s][1]&&(e.l=i[s][1],x=!1);break;case 4108:e.l<=i[s][1]&&(e.l=i[s][1],x=!1);break}if((!t||s==0)&&e.l<=i[s][1]&&(x=!1,e.l=i[s][1]),x)throw new Error("Read Error: Expected address "+i[s][1]+" at "+e.l+" :"+s)}if(t){var g=t[i[s][0]];if(d[g.n]=ri(e,g.t,{raw:!0}),g.p==="version"&&(d[g.n]=String(d[g.n]>>16)+"."+("0000"+String(d[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(d[g.n]){case 0:d[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:xt(c=d[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[g.n])}}else if(i[s][0]===1){if(c=d.CodePage=ri(e,bs),xt(c),o!==-1){var p=e.l;e.l=i[o][1],l=j0(e,c),e.l=p}}else if(i[s][0]===0){if(c===0){o=s,e.l=i[s+1][1];continue}l=j0(e,c)}else{var m=l[i[s][0]],_;switch(e[e.l]){case 65:e.l+=4,_=Zo(e);break;case 30:e.l+=4,_=Ki(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,_=Ki(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,_=e.read_shift(4,"i");break;case 19:e.l+=4,_=e.read_shift(4);break;case 5:e.l+=4,_=e.read_shift(8,"f");break;case 11:e.l+=4,_=dr(e,4);break;case 64:e.l+=4,_=rr(Cs(e));break;default:throw new Error("unparsed value: "+e[e.l])}d[m]=_}}return e.l=r+a,d}var el=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function T1(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function V0(e,t,r){var a=re(8),n=[],i=[],s=8,c=0,o=re(8),l=re(8);if(o.write_shift(4,2),o.write_shift(4,1200),l.write_shift(4,1),i.push(o),n.push(l),s+=8+o.length,!t){l=re(8),l.write_shift(4,0),n.unshift(l);var f=[re(4)];for(f[0].write_shift(4,e.length),c=0;c<e.length;++c){var u=e[c][0];for(o=re(8+2*(u.length+1)+(u.length%2?0:2)),o.write_shift(4,c+2),o.write_shift(4,u.length+1),o.write_shift(0,u,"dbcs");o.l!=o.length;)o.write_shift(1,0);f.push(o)}o=Fr(f),i.unshift(o),s+=8+o.length}for(c=0;c<e.length;++c)if(!(t&&!t[e[c][0]])&&!(el.indexOf(e[c][0])>-1||zo.indexOf(e[c][0])>-1)&&e[c][1]!=null){var d=e[c][1],x=0;if(t){x=+t[e[c][0]];var g=r[x];if(g.p=="version"&&typeof d=="string"){var p=d.split(".");d=(+p[0]<<16)+(+p[1]||0)}o=U0(g.t,d)}else{var m=T1(d);m==-1&&(m=31,d=String(d)),o=U0(m,d)}i.push(o),l=re(8),l.write_shift(4,t?x:2+c),n.push(l),s+=8+o.length}var _=8*(i.length+1);for(c=0;c<i.length;++c)n[c].write_shift(4,_),_+=i[c].length;return a.write_shift(4,s),a.write_shift(4,i.length),Fr([a].concat(n).concat(i))}function H0(e,t,r){var a=e.content;if(!a)return{};Dr(a,0);var n,i,s,c,o=0;a.chk("feff","Byte Order: "),a.read_shift(2);var l=a.read_shift(4),f=a.read_shift(16);if(f!==Fe.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(n=a.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(i=a.read_shift(16),c=a.read_shift(4),n===1&&c!==a.l)throw new Error("Length mismatch: "+c+" !== "+a.l);n===2&&(s=a.read_shift(16),o=a.read_shift(4));var u=W0(a,t),d={SystemIdentifier:l};for(var x in u)d[x]=u[x];if(d.FMTID=i,n===1)return d;if(o-a.l==2&&(a.l+=2),a.l!==o)throw new Error("Length mismatch 2: "+a.l+" !== "+o);var g;try{g=W0(a,null)}catch{}for(x in g)d[x]=g[x];return d.FMTID=[i,s],d}function $0(e,t,r,a,n,i){var s=re(n?68:48),c=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,Fe.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,n?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,n?68:48);var o=V0(e,r,a);if(c.push(o),n){var l=V0(n,null,null);s.write_shift(16,i,"hex"),s.write_shift(4,68+o.length),c.push(l)}return Fr(c)}function Lt(e,t){return e.read_shift(t),null}function E1(e,t){t||(t=re(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function S1(e,t,r){for(var a=[],n=e.l+t;e.l<n;)a.push(r(e,n-e.l));if(n!==e.l)throw new Error("Slurp error");return a}function dr(e,t){return e.read_shift(t)===1}function Hr(e,t){return t||(t=re(2)),t.write_shift(2,+!!e),t}function vr(e){return e.read_shift(2,"u")}function ft(e,t){return t||(t=re(2)),t.write_shift(2,e),t}function rl(e,t){return S1(e,t,vr)}function F1(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function tl(e,t,r){return r||(r=re(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function wn(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var s=a?e.read_shift(a,n):"";return s}function A1(e){var t=e.read_shift(2),r=e.read_shift(1),a=r&4,n=r&8,i=1+(r&1),s=0,c,o={};n&&(s=e.read_shift(2)),a&&(c=e.read_shift(4));var l=i==2?"dbcs-cont":"sbcs-cont",f=t===0?"":e.read_shift(t,l);return n&&(e.l+=4*s),a&&(e.l+=c),o.t=f,n||(o.raw="<t>"+o.t+"</t>",o.r=o.t),o}function b1(e){var t=e.t||"",r=re(3);r.write_shift(2,t.length),r.write_shift(1,1);var a=re(2*t.length);a.write_shift(2*t.length,t,"utf16le");var n=[r,a];return Fr(n)}function oa(e,t,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var n=e.read_shift(1);return n===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function yn(e,t,r){var a=e.read_shift(r&&r.biff==2?1:2);return a===0?(e.l++,""):oa(e,a,r)}function wa(e,t,r){if(r.biff>5)return yn(e,t,r);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function al(e,t,r){return r||(r=re(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function D1(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function C1(e){var t=e.read_shift(4),r=e.l,a=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=r);var n=e.read_shift((a?t-24:t)>>1,"utf16le").replace(Gr,"");return a&&(e.l+=24),n}function N1(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=e.read_shift(4);if(n===0)return r+a.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=e.read_shift(i>>1,"utf16le").replace(Gr,"");return r+s}function I1(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return C1(e);case"0303000000000000c000000000000046":return N1(e);default:throw new Error("Unsupported Moniker "+r)}}function Rn(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Gr,""):"";return r}function G0(e,t){t||(t=re(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function R1(e,t){var r=e.l+t,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var n=e.read_shift(2);e.l+=2;var i,s,c,o,l="",f,u;n&16&&(i=Rn(e,r-e.l)),n&128&&(s=Rn(e,r-e.l)),(n&257)===257&&(c=Rn(e,r-e.l)),(n&257)===1&&(o=I1(e,r-e.l)),n&8&&(l=Rn(e,r-e.l)),n&32&&(f=e.read_shift(16)),n&64&&(u=Cs(e)),e.l=r;var d=s||c||o||"";d&&l&&(d+="#"+l),d||(d="#"+l),n&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var x={Target:d};return f&&(x.guid=f),u&&(x.time=u),i&&(x.Tooltip=i),x}function B1(e){var t=re(512),r=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var n=a.indexOf("#"),i=n>-1?31:23;switch(a.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var s=[8,6815827,6619237,4849780,83];for(r=0;r<s.length;++r)t.write_shift(4,s[r]);if(i==28)a=a.slice(1),G0(a,t);else if(i&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));var c=n>-1?a.slice(0,n):a;for(t.write_shift(4,2*(c.length+1)),r=0;r<c.length;++r)t.write_shift(2,c.charCodeAt(r));t.write_shift(2,0),i&8&&G0(n>-1?a.slice(n+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));for(var o=0;a.slice(o*3,o*3+3)=="../"||a.slice(o*3,o*3+3)=="..\\";)++o;for(t.write_shift(2,o),t.write_shift(4,a.length-3*o+1),r=0;r<a.length-3*o;++r)t.write_shift(1,a.charCodeAt(r+3*o)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function nl(e){var t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1),n=e.read_shift(1);return[t,r,a,n]}function il(e,t){var r=nl(e);return r[3]=0,r}function Ft(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{r:t,c:r,ixfe:a}}function la(e,t,r,a){return a||(a=re(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,r||0),a}function O1(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function P1(e,t,r){return t===0?"":wa(e,t,r)}function L1(e,t,r){var a=r.biff>8?4:2,n=e.read_shift(a),i=e.read_shift(a,"i"),s=e.read_shift(a,"i");return[n,i,s]}function sl(e){var t=e.read_shift(2),r=As(e);return[t,r]}function M1(e,t,r){e.l+=4,t-=4;var a=e.l+t,n=wn(e,t,r),i=e.read_shift(2);if(a-=e.l,i!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+i);return e.l+=i,n}function di(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2);return{s:{c:a,r:t},e:{c:n,r}}}function cl(e,t){return t||(t=re(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function ol(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(1),n=e.read_shift(1);return{s:{c:a,r:t},e:{c:n,r}}}var j1=ol;function ll(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[r,t,a]}function U1(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function W1(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Rr(e){e.l+=2,e.l+=e.read_shift(2)}var V1={0:Rr,4:Rr,5:Rr,6:Rr,7:W1,8:Rr,9:Rr,10:Rr,11:Rr,12:Rr,13:U1,14:Rr,15:Rr,16:Rr,17:Rr,18:Rr,19:Rr,20:Rr,21:ll};function H1(e,t){for(var r=e.l+t,a=[];e.l<r;){var n=e.read_shift(2);e.l-=2;try{a.push(V1[n](e,r-e.l))}catch{return e.l=r,a}}return e.l!=r&&(e.l=r),a}function Bn(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Ns(e,t,r){var a=1536,n=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,n=8;break;case"biff4":a=4,n=6;break;case"biff3":a=3,n=6;break;case"biff2":a=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=re(n);return i.write_shift(2,a),i.write_shift(2,t),n>4&&i.write_shift(2,29282),n>6&&i.write_shift(2,1997),n>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function $1(e,t){return t===0||e.read_shift(2),1200}function G1(e,t,r){if(r.enc)return e.l+=t,"";var a=e.l,n=wa(e,0,r);return e.read_shift(t+a-e.l),n}function z1(e,t){var r=!t||t.biff==8,a=re(r?112:54);for(a.write_shift(t.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function X1(e,t,r){var a=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function Y1(e,t,r){var a=e.read_shift(4),n=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var s=wn(e,0,r);return s.length===0&&(s="Sheet1"),{pos:a,hs:n,dt:i,name:s}}function K1(e,t){var r=!t||t.biff>=8?2:1,a=re(8+r*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var n=a.slice(0,a.l);return n.l=a.l,n}function Q1(e,t){for(var r=e.l+t,a=e.read_shift(4),n=e.read_shift(4),i=[],s=0;s!=n&&e.l<r;++s)i.push(A1(e));return i.Count=a,i.Unique=n,i}function q1(e,t){var r=re(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var a=[],n=0;n<e.length;++n)a[n]=b1(e[n]);var i=Fr([r].concat(a));return i.parts=[r.length].concat(a.map(function(s){return s.length})),i}function J1(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function Z1(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(t.level=a&7),a&32&&(t.hidden=!0),a&64&&(t.hpt=r/20),t}function ex(e){var t=O1(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function rx(e){return e.read_shift(2),e.read_shift(4)}function z0(e,t,r){var a=0;r&&r.biff==2||(a=e.read_shift(2));var n=e.read_shift(2);r&&r.biff==2&&(a=1-(n>>15),n&=32767);var i={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[i,n]}function tx(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),c=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2);return{Pos:[t,r],Dim:[a,n],Flags:i,CurTab:s,FirstTab:c,Selected:o,TabRatio:l}}function ax(){var e=re(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function nx(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function ix(e){var t=re(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function sx(){}function cx(e,t,r){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=wn(e,0,r),a}function ox(e,t){var r=e.name||"Arial",a=t&&t.biff==5,n=a?15+r.length:16+2*r.length,i=re(n);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),a||i.write_shift(1,1),i.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),i}function lx(e){var t=Ft(e);return t.isst=e.read_shift(4),t}function fx(e,t,r,a){var n=re(10);return la(e,t,a,n),n.write_shift(4,r),n}function hx(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=e.l+t,n=Ft(e);r.biff==2&&e.l++;var i=yn(e,a-e.l,r);return n.val=i,n}function ux(e,t,r,a,n){var i=!n||n.biff==8,s=re(8+ +i+(1+i)*r.length);return la(e,t,a,s),s.write_shift(2,r.length),i&&s.write_shift(1,1),s.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),s}function dx(e,t,r){var a=e.read_shift(2),n=wa(e,0,r);return[a,n]}function xx(e,t,r,a){var n=r&&r.biff==5;a||(a=re(n?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(n?1:2,t.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le");var i=a.length>a.l?a.slice(0,a.l):a;return i.l==null&&(i.l=i.length),i}var px=wa;function X0(e,t,r){var a=e.l+t,n=r.biff==8||!r.biff?4:2,i=e.read_shift(n),s=e.read_shift(n),c=e.read_shift(2),o=e.read_shift(2);return e.l=a,{s:{r:i,c},e:{r:s,c:o}}}function gx(e,t){var r=t.biff==8||!t.biff?4:2,a=re(2*r+6);return a.write_shift(r,e.s.r),a.write_shift(r,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function mx(e){var t=e.read_shift(2),r=e.read_shift(2),a=sl(e);return{r:t,c:r,ixfe:a[0],rknum:a[1]}}function vx(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),i=[];e.l<r;)i.push(sl(e));if(e.l!==r)throw new Error("MulRK read error");var s=e.read_shift(2);if(i.length!=s-n+1)throw new Error("MulRK length mismatch");return{r:a,c:n,C:s,rkrec:i}}function wx(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var s=e.read_shift(2);if(i.length!=s-n+1)throw new Error("MulBlank length mismatch");return{r:a,c:n,C:s,ixfe:i}}function yx(e,t,r,a){var n={},i=e.read_shift(4),s=e.read_shift(4),c=e.read_shift(4),o=e.read_shift(2);return n.patternType=e1[c>>26],a.cellStyles&&(n.alc=i&7,n.fWrap=i>>3&1,n.alcV=i>>4&7,n.fJustLast=i>>7&1,n.trot=i>>8&255,n.cIndent=i>>16&15,n.fShrinkToFit=i>>20&1,n.iReadOrder=i>>22&2,n.fAtrNum=i>>26&1,n.fAtrFnt=i>>27&1,n.fAtrAlc=i>>28&1,n.fAtrBdr=i>>29&1,n.fAtrPat=i>>30&1,n.fAtrProt=i>>31&1,n.dgLeft=s&15,n.dgRight=s>>4&15,n.dgTop=s>>8&15,n.dgBottom=s>>12&15,n.icvLeft=s>>16&127,n.icvRight=s>>23&127,n.grbitDiag=s>>30&3,n.icvTop=c&127,n.icvBottom=c>>7&127,n.icvDiag=c>>14&127,n.dgDiag=c>>21&15,n.icvFore=o&127,n.icvBack=o>>7&127,n.fsxButton=o>>14&1),n}function _x(e,t,r){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,t-=6,a.data=yx(e,t,a.fStyle,r),a}function Y0(e,t,r,a){var n=r&&r.biff==5;a||(a=re(n?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&n&&(i|=1024),a.write_shift(4,i),a.write_shift(4,0),n||a.write_shift(4,0),a.write_shift(2,0),a}function kx(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Tx(e){var t=re(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function K0(e,t,r){var a=Ft(e);(r.biff==2||t==9)&&++e.l;var n=F1(e);return a.val=n,a.t=n===!0||n===!1?"b":"e",a}function Ex(e,t,r,a,n,i){var s=re(8);return la(e,t,a,s),tl(r,i,s),s}function Sx(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=Ft(e),n=Lr(e);return a.val=n,a}function Fx(e,t,r,a){var n=re(14);return la(e,t,a,n),ca(r,n),n}var Q0=P1;function Ax(e,t,r){var a=e.l+t,n=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,n];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var s=oa(e,i),c=[];a>e.l;)c.push(yn(e));return[i,n,s,c]}function q0(e,t,r){var a=e.read_shift(2),n,i={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(n=M1(e,t-2,r)),i.body=n||e.read_shift(t-2),typeof n=="string"&&(i.Name=n),i}var bx=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function J0(e,t,r){var a=e.l+t,n=e.read_shift(2),i=e.read_shift(1),s=e.read_shift(1),c=e.read_shift(r&&r.biff==2?1:2),o=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),o=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var l=oa(e,s,r);n&32&&(l=bx[l.charCodeAt(0)]);var f=a-e.l;r&&r.biff==2&&--f;var u=a==e.l||c===0||!(f>0)?[]:Hv(e,f,r,c);return{chKey:i,Name:l,itab:o,rgce:u}}function fl(e,t,r){if(r.biff<8)return Dx(e,t,r);for(var a=[],n=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)a.push(L1(e,r.biff>8?12:6,r));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return a}function Dx(e,t,r){e[e.l+1]==3&&e[e.l]++;var a=wn(e,t,r);return a.charCodeAt(0)==3?a.slice(1):a}function Cx(e,t,r){if(r.biff<8){e.l+=t;return}var a=e.read_shift(2),n=e.read_shift(2),i=oa(e,a,r),s=oa(e,n,r);return[i,s]}function Nx(e,t,r){var a=ol(e);e.l++;var n=e.read_shift(1);return t-=8,[$v(e,t,r),n,a]}function Z0(e,t,r){var a=j1(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[a,Wv(e,t,r)]}function Ix(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,a=e.read_shift(4);return[t,r,a]}function Rx(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),c=wa(e,0,r);return r.biff<8&&e.read_shift(1),[{r:a,c:n},c,s,i]}}function Bx(e,t,r){return Rx(e,t,r)}function Ox(e,t){for(var r=[],a=e.read_shift(2);a--;)r.push(di(e));return r}function Px(e){var t=re(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)cl(e[r],t);return t}function Lx(e,t,r){if(r&&r.biff<8)return jx(e,t,r);var a=ll(e),n=H1(e,t-22,a[1]);return{cmo:a,ft:n}}var Mx={8:function(e,t){var r=e.l+t;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e.read_shift(1);return e.l+=n,e.l=r,{fmt:a}}};function jx(e,t,r){e.l+=4;var a=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var s=[];return s.push((Mx[a]||jr)(e,t,r)),{cmo:[n,a,i],ft:s}}function Ux(e,t,r){var a=e.l,n="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:s=D1(e,6,r);var c=e.read_shift(2);e.read_shift(2),vr(e,2);var o=e.read_shift(2);e.l+=o;for(var l=1;l<e.lens.length-1;++l){if(e.l-a!=e.lens[l])throw new Error("TxO: bad continue record");var f=e[e.l],u=oa(e,e.lens[l+1]-e.lens[l]-1);if(n+=u,n.length>=(f?c:2*c))break}if(n.length!==c&&n.length!==c*2)throw new Error("cchText: "+c+" != "+n.length);return e.l=a+t,{t:n}}catch{return e.l=a+t,{t:n}}}function Wx(e,t){var r=di(e);e.l+=16;var a=R1(e,t-24);return[r,a]}function Vx(e){var t=re(24),r=cr(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)t.write_shift(1,parseInt(a[n],16));return Fr([t,B1(e[1])])}function Hx(e,t){e.read_shift(2);var r=di(e),a=e.read_shift((t-10)/2,"dbcs-cont");return a=a.replace(Gr,""),[r,a]}function $x(e){var t=e[1].Tooltip,r=re(10+2*(t.length+1));r.write_shift(2,2048);var a=cr(e[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var n=0;n<t.length;++n)r.write_shift(2,t.charCodeAt(n));return r.write_shift(2,0),r}function Gx(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=L0[r]||r,r=e.read_shift(2),t[1]=L0[r]||r,t}function zx(e){return e||(e=re(4)),e.write_shift(2,1),e.write_shift(2,1),e}function Xx(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(il(e));return r}function Yx(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(il(e));return r}function Kx(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function hl(e,t,r){if(!r.cellStyles)return jr(e,t);var a=r&&r.biff>=12?4:2,n=e.read_shift(a),i=e.read_shift(a),s=e.read_shift(a),c=e.read_shift(a),o=e.read_shift(2);a==2&&(e.l+=2);var l={s:n,e:i,w:s,ixfe:c,flags:o};return(r.biff>=5||!r.biff)&&(l.level=o>>8&7),l}function Qx(e,t){var r=re(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var a=0;return e.hidden&&(a|=1),r.write_shift(1,a),a=e.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function qx(e,t){var r={};return t<32||(e.l+=16,r.header=Lr(e),r.footer=Lr(e),e.l+=2),r}function Jx(e,t,r){var a={area:!1};if(r.biff!=5)return e.l+=t,a;var n=e.read_shift(1);return e.l+=3,n&16&&(a.area=!0),a}function Zx(e){for(var t=re(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var ep=Ft,rp=rl,tp=yn;function ap(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n={fmt:t,env:r,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,n}function np(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=Ft(e);++e.l;var n=wa(e,t-7,r);return a.t="str",a.val=n,a}function ip(e){var t=Ft(e);++e.l;var r=Lr(e);return t.t="n",t.val=r,t}function sp(e,t,r){var a=re(15);return En(a,e,t),a.write_shift(8,r,"f"),a}function cp(e){var t=Ft(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function op(e,t,r){var a=re(9);return En(a,e,t),a.write_shift(2,r),a}function lp(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function fp(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function hp(e,t,r){var a=e.l+t,n=Ft(e),i=e.read_shift(2),s=oa(e,i,r);return e.l=a,n.t="str",n.val=s,n}var up=[2,3,48,49,131,139,140,245],Qi=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=fi({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(c,o){var l=[],f=Wt(1);switch(o.type){case"base64":f=Zr(at(c));break;case"binary":f=Zr(c);break;case"buffer":case"array":f=c;break}Dr(f,0);var u=f.read_shift(1),d=!!(u&136),x=!1,g=!1;switch(u){case 2:break;case 3:break;case 48:x=!0,d=!0;break;case 49:x=!0,d=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+u.toString(16))}var p=0,m=521;u==2&&(p=f.read_shift(2)),f.l+=3,u!=2&&(p=f.read_shift(4)),p>1048576&&(p=1e6),u!=2&&(m=f.read_shift(2));var _=f.read_shift(2),k=o.codepage||1252;u!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(k=e[f[f.l]]),f.l+=1,f.l+=2),g&&(f.l+=36);for(var v=[],T={},b=Math.min(f.length,u==2?521:m-10-(x?264:0)),E=g?32:11;f.l<b&&f[f.l]!=13;)switch(T={},T.name=rn.utils.decode(k,f.slice(f.l,f.l+E)).replace(/[\u0000\r\n].*$/g,""),f.l+=E,T.type=String.fromCharCode(f.read_shift(1)),u!=2&&!g&&(T.offset=f.read_shift(4)),T.len=f.read_shift(1),u==2&&(T.offset=f.read_shift(2)),T.dec=f.read_shift(1),T.name.length&&v.push(T),u!=2&&(f.l+=g?13:14),T.type){case"B":(!x||T.len!=8)&&o.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"G":case"P":o.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+T.type)}if(f[f.l]!==13&&(f.l=m-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=m;var y=0,O=0;for(l[0]=[],O=0;O!=v.length;++O)l[0][O]=v[O].name;for(;p-- >0;){if(f[f.l]===42){f.l+=_;continue}for(++f.l,l[++y]=[],O=0,O=0;O!=v.length;++O){var B=f.slice(f.l,f.l+v[O].len);f.l+=v[O].len,Dr(B,0);var j=rn.utils.decode(k,B);switch(v[O].type){case"C":j.trim().length&&(l[y][O]=j.replace(/\s+$/,""));break;case"D":j.length===8?l[y][O]=new Date(+j.slice(0,4),+j.slice(4,6)-1,+j.slice(6,8)):l[y][O]=j;break;case"F":l[y][O]=parseFloat(j.trim());break;case"+":case"I":l[y][O]=g?B.read_shift(-4,"i")^2147483648:B.read_shift(4,"i");break;case"L":switch(j.trim().toUpperCase()){case"Y":case"T":l[y][O]=!0;break;case"N":case"F":l[y][O]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+j+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+u.toString(16));l[y][O]="##MEMO##"+(g?parseInt(j.trim(),10):B.read_shift(4));break;case"N":j=j.replace(/\u0000/g,"").trim(),j&&j!="."&&(l[y][O]=+j||0);break;case"@":l[y][O]=new Date(B.read_shift(-8,"f")-621356832e5);break;case"T":l[y][O]=new Date((B.read_shift(4)-2440588)*864e5+B.read_shift(4));break;case"Y":l[y][O]=B.read_shift(4,"i")/1e4+B.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":l[y][O]=-B.read_shift(-8,"f");break;case"B":if(x&&v[O].len==8){l[y][O]=B.read_shift(8,"f");break}case"G":case"P":B.l+=v[O].len;break;case"0":if(v[O].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+v[O].type)}}}if(u!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return o&&o.sheetRows&&(l=l.slice(0,o.sheetRows)),o.DBF=v,l}function a(c,o){var l=o||{};l.dateNF||(l.dateNF="yyyymmdd");var f=Ba(r(c,l),l);return f["!cols"]=l.DBF.map(function(u){return{wch:u.len,DBF:u}}),delete l.DBF,f}function n(c,o){try{return zt(a(c,o),o)}catch(l){if(o&&o.WTF)throw l}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function s(c,o){var l=o||{};if(+l.codepage>=0&&xt(+l.codepage),l.type=="string")throw new Error("Cannot write DBF to JS string");var f=Xr(),u=ni(c,{header:1,raw:!0,cellDates:!0}),d=u[0],x=u.slice(1),g=c["!cols"]||[],p=0,m=0,_=0,k=1;for(p=0;p<d.length;++p){if(((g[p]||{}).DBF||{}).name){d[p]=g[p].DBF.name,++_;continue}if(d[p]!=null){if(++_,typeof d[p]=="number"&&(d[p]=d[p].toString(10)),typeof d[p]!="string")throw new Error("DBF Invalid column name "+d[p]+" |"+typeof d[p]+"|");if(d.indexOf(d[p])!==p){for(m=0;m<1024;++m)if(d.indexOf(d[p]+"_"+m)==-1){d[p]+="_"+m;break}}}}var v=We(c["!ref"]),T=[],b=[],E=[];for(p=0;p<=v.e.c-v.s.c;++p){var y="",O="",B=0,j=[];for(m=0;m<x.length;++m)x[m][p]!=null&&j.push(x[m][p]);if(j.length==0||d[p]==null){T[p]="?";continue}for(m=0;m<j.length;++m){switch(typeof j[m]){case"number":O="B";break;case"string":O="C";break;case"boolean":O="L";break;case"object":O=j[m]instanceof Date?"D":"C";break;default:O="C"}B=Math.max(B,String(j[m]).length),y=y&&y!=O?"C":O}B>250&&(B=250),O=((g[p]||{}).DBF||{}).type,O=="C"&&g[p].DBF.len>B&&(B=g[p].DBF.len),y=="B"&&O=="N"&&(y="N",E[p]=g[p].DBF.dec,B=g[p].DBF.len),b[p]=y=="C"||O=="N"?B:i[y]||0,k+=b[p],T[p]=y}var U=f.next(32);for(U.write_shift(4,318902576),U.write_shift(4,x.length),U.write_shift(2,296+32*_),U.write_shift(2,k),p=0;p<4;++p)U.write_shift(4,0);for(U.write_shift(4,0|(+t[Jc]||3)<<8),p=0,m=0;p<d.length;++p)if(d[p]!=null){var L=f.next(32),Y=(d[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);L.write_shift(1,Y,"sbcs"),L.write_shift(1,T[p]=="?"?"C":T[p],"sbcs"),L.write_shift(4,m),L.write_shift(1,b[p]||i[T[p]]||0),L.write_shift(1,E[p]||0),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(1,0),L.write_shift(4,0),L.write_shift(4,0),m+=b[p]||i[T[p]]||0}var J=f.next(264);for(J.write_shift(4,13),p=0;p<65;++p)J.write_shift(4,0);for(p=0;p<x.length;++p){var Q=f.next(k);for(Q.write_shift(1,0),m=0;m<d.length;++m)if(d[m]!=null)switch(T[m]){case"L":Q.write_shift(1,x[p][m]==null?63:x[p][m]?84:70);break;case"B":Q.write_shift(8,x[p][m]||0,"f");break;case"N":var ce="0";for(typeof x[p][m]=="number"&&(ce=x[p][m].toFixed(E[m]||0)),_=0;_<b[m]-ce.length;++_)Q.write_shift(1,32);Q.write_shift(1,ce,"sbcs");break;case"D":x[p][m]?(Q.write_shift(4,("0000"+x[p][m].getFullYear()).slice(-4),"sbcs"),Q.write_shift(2,("00"+(x[p][m].getMonth()+1)).slice(-2),"sbcs"),Q.write_shift(2,("00"+x[p][m].getDate()).slice(-2),"sbcs")):Q.write_shift(8,"00000000","sbcs");break;case"C":var ne=String(x[p][m]!=null?x[p][m]:"").slice(0,b[m]);for(Q.write_shift(1,ne,"sbcs"),_=0;_<b[m]-ne.length;++_)Q.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:n,to_sheet:a,from_sheet:s}}(),ul=function(){var e={AA:"√Ä",BA:"√Å",CA:"√Ç",DA:195,HA:"√Ñ",JA:197,AE:"√à",BE:"√â",CE:"√ä",HE:"√ã",AI:"√å",BI:"√ç",CI:"√é",HI:"√è",AO:"√í",BO:"√ì",CO:"√î",DO:213,HO:"√ñ",AU:"√ô",BU:"√ö",CU:"√õ",HU:"√ú",Aa:"√†",Ba:"√°",Ca:"√¢",Da:227,Ha:"√§",Ja:229,Ae:"√®",Be:"√©",Ce:"√™",He:"√´",Ai:"√¨",Bi:"√≠",Ci:"√Æ",Hi:"√Ø",Ao:"√≤",Bo:"√≥",Co:"√¥",Do:245,Ho:"√∂",Au:"√π",Bu:"√∫",Cu:"√ª",Hu:"√º",KC:"√á",Kc:"√ß",q:"√¶",z:"≈ì",a:"√Ü",j:"≈í",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+hr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,x){var g=e[x];return typeof g=="number"?f0(g):g},a=function(d,x,g){var p=x.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return p==59?d:f0(p)};e["|"]=254;function n(d,x){switch(x.type){case"base64":return i(at(d),x);case"binary":return i(d,x);case"buffer":return i(Me&&Buffer.isBuffer(d)?d.toString("binary"):Gt(d),x);case"array":return i(sa(d),x)}throw new Error("Unrecognized type "+x.type)}function i(d,x){var g=d.split(/[\n\r]+/),p=-1,m=-1,_=0,k=0,v=[],T=[],b=null,E={},y=[],O=[],B=[],j=0,U;for(+x.codepage>=0&&xt(+x.codepage);_!==g.length;++_){j=0;var L=g[_].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),Y=L.replace(/;;/g,"\0").split(";").map(function(D){return D.replace(/\u0000/g,";")}),J=Y[0],Q;if(L.length>0)switch(J){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Y[1].charAt(0)=="P"&&T.push(L.slice(3).replace(/;;/g,";"));break;case"C":var ce=!1,ne=!1,Se=!1,V=!1,_e=-1,ge=-1;for(k=1;k<Y.length;++k)switch(Y[k].charAt(0)){case"A":break;case"X":m=parseInt(Y[k].slice(1))-1,ne=!0;break;case"Y":for(p=parseInt(Y[k].slice(1))-1,ne||(m=0),U=v.length;U<=p;++U)v[U]=[];break;case"K":Q=Y[k].slice(1),Q.charAt(0)==='"'?Q=Q.slice(1,Q.length-1):Q==="TRUE"?Q=!0:Q==="FALSE"?Q=!1:isNaN(gt(Q))?isNaN(Ca(Q).getDate())||(Q=rr(Q)):(Q=gt(Q),b!==null&&da(b)&&(Q=ui(Q))),ce=!0;break;case"E":V=!0;var A=ba(Y[k].slice(1),{r:p,c:m});v[p][m]=[v[p][m],A];break;case"S":Se=!0,v[p][m]=[v[p][m],"S5S"];break;case"G":break;case"R":_e=parseInt(Y[k].slice(1))-1;break;case"C":ge=parseInt(Y[k].slice(1))-1;break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+L)}if(ce&&(v[p][m]&&v[p][m].length==2?v[p][m][0]=Q:v[p][m]=Q,b=null),Se){if(V)throw new Error("SYLK shared formula cannot have own formula");var M=_e>-1&&v[_e][ge];if(!M||!M[1])throw new Error("SYLK shared formula cannot find base");v[p][m][1]=Cl(M[1],{r:p-_e,c:m-ge})}break;case"F":var P=0;for(k=1;k<Y.length;++k)switch(Y[k].charAt(0)){case"X":m=parseInt(Y[k].slice(1))-1,++P;break;case"Y":for(p=parseInt(Y[k].slice(1))-1,U=v.length;U<=p;++U)v[U]=[];break;case"M":j=parseInt(Y[k].slice(1))/20;break;case"F":break;case"G":break;case"P":b=T[parseInt(Y[k].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(B=Y[k].slice(1).split(" "),U=parseInt(B[0],10);U<=parseInt(B[1],10);++U)j=parseInt(B[2],10),O[U-1]=j===0?{hidden:!0}:{wch:j},Vt(O[U-1]);break;case"C":m=parseInt(Y[k].slice(1))-1,O[m]||(O[m]={});break;case"R":p=parseInt(Y[k].slice(1))-1,y[p]||(y[p]={}),j>0?(y[p].hpt=j,y[p].hpx=Ia(j)):j===0&&(y[p].hidden=!0);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+L)}P<1&&(b=null);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+L)}}return y.length>0&&(E["!rows"]=y),O.length>0&&(E["!cols"]=O),x&&x.sheetRows&&(v=v.slice(0,x.sheetRows)),[v,E]}function s(d,x){var g=n(d,x),p=g[0],m=g[1],_=Ba(p,x);return hr(m).forEach(function(k){_[k]=m[k]}),_}function c(d,x){return zt(s(d,x),x)}function o(d,x,g,p){var m="C;Y"+(g+1)+";X"+(p+1)+";K";switch(d.t){case"n":m+=d.v||0,d.f&&!d.F&&(m+=";E"+Ls(d.f,{r:g,c:p}));break;case"b":m+=d.v?"TRUE":"FALSE";break;case"e":m+=d.w||d.v;break;case"d":m+='"'+(d.w||d.v)+'"';break;case"s":m+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return m}function l(d,x){x.forEach(function(g,p){var m="F;W"+(p+1)+" "+(p+1)+" ";g.hidden?m+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=fn(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=hn(g.wpx)),typeof g.wch=="number"&&(m+=Math.round(g.wch))),m.charAt(m.length-1)!=" "&&d.push(m)})}function f(d,x){x.forEach(function(g,p){var m="F;";g.hidden?m+="M0;":g.hpt?m+="M"+20*g.hpt+";":g.hpx&&(m+="M"+20*un(g.hpx)+";"),m.length>2&&d.push(m+"R"+(p+1))})}function u(d,x){var g=["ID;PWXL;N;E"],p=[],m=We(d["!ref"]),_,k=Array.isArray(d),v=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),d["!cols"]&&l(g,d["!cols"]),d["!rows"]&&f(g,d["!rows"]),g.push("B;Y"+(m.e.r-m.s.r+1)+";X"+(m.e.c-m.s.c+1)+";D"+[m.s.c,m.s.r,m.e.c,m.e.r].join(" "));for(var T=m.s.r;T<=m.e.r;++T)for(var b=m.s.c;b<=m.e.c;++b){var E=be({r:T,c:b});_=k?(d[T]||[])[b]:d[E],!(!_||_.v==null&&(!_.f||_.F))&&p.push(o(_,d,T,b))}return g.join(v)+v+p.join(v)+v+"E"+v}return{to_workbook:c,to_sheet:s,from_sheet:u}}(),dl=function(){function e(i,s){switch(s.type){case"base64":return t(at(i),s);case"binary":return t(i,s);case"buffer":return t(Me&&Buffer.isBuffer(i)?i.toString("binary"):Gt(i),s);case"array":return t(sa(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){for(var c=i.split(`
`),o=-1,l=-1,f=0,u=[];f!==c.length;++f){if(c[f].trim()==="BOT"){u[++o]=[],l=0;continue}if(!(o<0)){var d=c[f].trim().split(","),x=d[0],g=d[1];++f;for(var p=c[f]||"";(p.match(/["]/g)||[]).length&1&&f<c.length-1;)p+=`
`+c[++f];switch(p=p.trim(),+x){case-1:if(p==="BOT"){u[++o]=[],l=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?u[o][l]=!0:p==="FALSE"?u[o][l]=!1:isNaN(gt(g))?isNaN(Ca(g).getDate())?u[o][l]=g:u[o][l]=rr(g):u[o][l]=gt(g),++l;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),u[o][l++]=p!==""?p:null;break}if(p==="EOD")break}}return s&&s.sheetRows&&(u=u.slice(0,s.sheetRows)),u}function r(i,s){return Ba(e(i,s),s)}function a(i,s){return zt(r(i,s),s)}var n=function(){var i=function(o,l,f,u,d){o.push(l),o.push(f+","+u),o.push('"'+d.replace(/"/g,'""')+'"')},s=function(o,l,f,u){o.push(l+","+f),o.push(l==1?'"'+u.replace(/"/g,'""')+'"':u)};return function(o){var l=[],f=We(o["!ref"]),u,d=Array.isArray(o);i(l,"TABLE",0,1,"sheetjs"),i(l,"VECTORS",0,f.e.r-f.s.r+1,""),i(l,"TUPLES",0,f.e.c-f.s.c+1,""),i(l,"DATA",0,0,"");for(var x=f.s.r;x<=f.e.r;++x){s(l,-1,0,"BOT");for(var g=f.s.c;g<=f.e.c;++g){var p=be({r:x,c:g});if(u=d?(o[x]||[])[g]:o[p],!u){s(l,1,0,"");continue}switch(u.t){case"n":var m=u.w;!m&&u.v!=null&&(m=u.v),m==null?u.f&&!u.F?s(l,1,0,"="+u.f):s(l,1,0,""):s(l,0,m,"V");break;case"b":s(l,0,u.v?1:0,u.v?"TRUE":"FALSE");break;case"s":s(l,1,0,isNaN(u.v)?u.v:'="'+u.v+'"');break;case"d":u.w||(u.w=nt(u.z||Ae[14],_r(rr(u.v)))),s(l,0,u.w,"V");break;default:s(l,1,0,"")}}}s(l,-1,0,"EOD");var _=`\r
`,k=l.join(_);return k}}();return{to_workbook:a,to_sheet:r,from_sheet:n}}(),xl=function(){function e(u){return u.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(u){return u.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(u,d){for(var x=u.split(`
`),g=-1,p=-1,m=0,_=[];m!==x.length;++m){var k=x[m].trim().split(":");if(k[0]==="cell"){var v=cr(k[1]);if(_.length<=v.r)for(g=_.length;g<=v.r;++g)_[g]||(_[g]=[]);switch(g=v.r,p=v.c,k[2]){case"t":_[g][p]=e(k[3]);break;case"v":_[g][p]=+k[3];break;case"vtf":var T=k[k.length-1];case"vtc":switch(k[3]){case"nl":_[g][p]=!!+k[4];break;default:_[g][p]=+k[4];break}k[2]=="vtf"&&(_[g][p]=[_[g][p],T])}}}return d&&d.sheetRows&&(_=_.slice(0,d.sheetRows)),_}function a(u,d){return Ba(r(u,d),d)}function n(u,d){return zt(a(u,d),d)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),o="--SocialCalcSpreadsheetControlSave--";function l(u){if(!u||!u["!ref"])return"";for(var d=[],x=[],g,p="",m=Yr(u["!ref"]),_=Array.isArray(u),k=m.s.r;k<=m.e.r;++k)for(var v=m.s.c;v<=m.e.c;++v)if(p=be({r:k,c:v}),g=_?(u[k]||[])[v]:u[p],!(!g||g.v==null||g.t==="z")){switch(x=["cell",p,"t"],g.t){case"s":case"str":x.push(t(g.v));break;case"n":g.f?(x[2]="vtf",x[3]="n",x[4]=g.v,x[5]=t(g.f)):(x[2]="v",x[3]=g.v);break;case"b":x[2]="vt"+(g.f?"f":"c"),x[3]="nl",x[4]=g.v?"1":"0",x[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var T=_r(rr(g.v));x[2]="vtc",x[3]="nd",x[4]=""+T,x[5]=g.w||nt(g.z||Ae[14],T);break;case"e":continue}d.push(x.join(":"))}return d.push("sheet:c:"+(m.e.c-m.s.c+1)+":r:"+(m.e.r-m.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function f(u){return[i,s,c,s,l(u),o].join(`
`)}return{to_workbook:n,to_sheet:a,from_sheet:f}}(),Na=function(){function e(f,u,d,x,g){g.raw?u[d][x]=f:f===""||(f==="TRUE"?u[d][x]=!0:f==="FALSE"?u[d][x]=!1:isNaN(gt(f))?isNaN(Ca(f).getDate())?u[d][x]=f:u[d][x]=rr(f):u[d][x]=gt(f))}function t(f,u){var d=u||{},x=[];if(!f||f.length===0)return x;for(var g=f.split(/[\r\n]/),p=g.length-1;p>=0&&g[p].length===0;)--p;for(var m=10,_=0,k=0;k<=p;++k)_=g[k].indexOf(" "),_==-1?_=g[k].length:_++,m=Math.max(m,_);for(k=0;k<=p;++k){x[k]=[];var v=0;for(e(g[k].slice(0,m).trim(),x,k,v,d),v=1;v<=(g[k].length-m)/10+1;++v)e(g[k].slice(m+(v-1)*10,m+v*10).trim(),x,k,v,d)}return d.sheetRows&&(x=x.slice(0,d.sheetRows)),x}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function n(f){for(var u={},d=!1,x=0,g=0;x<f.length;++x)(g=f.charCodeAt(x))==34?d=!d:!d&&g in r&&(u[g]=(u[g]||0)+1);g=[];for(x in u)Object.prototype.hasOwnProperty.call(u,x)&&g.push([u[x],x]);if(!g.length){u=a;for(x in u)Object.prototype.hasOwnProperty.call(u,x)&&g.push([u[x],x])}return g.sort(function(p,m){return p[0]-m[0]||a[p[1]]-a[m[1]]}),r[g.pop()[1]]||44}function i(f,u){var d=u||{},x="",g=d.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(x=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(x=f.charAt(4),f=f.slice(6)):x=n(f.slice(0,1024)):d&&d.FS?x=d.FS:x=n(f.slice(0,1024));var m=0,_=0,k=0,v=0,T=0,b=x.charCodeAt(0),E=!1,y=0,O=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var B=d.dateNF!=null?Ju(d.dateNF):null;function j(){var U=f.slice(v,T),L={};if(U.charAt(0)=='"'&&U.charAt(U.length-1)=='"'&&(U=U.slice(1,-1).replace(/""/g,'"')),U.length===0)L.t="z";else if(d.raw)L.t="s",L.v=U;else if(U.trim().length===0)L.t="s",L.v=U;else if(U.charCodeAt(0)==61)U.charCodeAt(1)==34&&U.charCodeAt(U.length-1)==34?(L.t="s",L.v=U.slice(2,-1).replace(/""/g,'"')):Am(U)?(L.t="n",L.f=U.slice(1)):(L.t="s",L.v=U);else if(U=="TRUE")L.t="b",L.v=!0;else if(U=="FALSE")L.t="b",L.v=!1;else if(!isNaN(k=gt(U)))L.t="n",d.cellText!==!1&&(L.w=U),L.v=k;else if(!isNaN(Ca(U).getDate())||B&&U.match(B)){L.z=d.dateNF||Ae[14];var Y=0;B&&U.match(B)&&(U=Zu(U,d.dateNF,U.match(B)||[]),Y=1),d.cellDates?(L.t="d",L.v=rr(U,Y)):(L.t="n",L.v=_r(rr(U,Y))),d.cellText!==!1&&(L.w=nt(L.z,L.v instanceof Date?_r(L.v):L.v)),d.cellNF||delete L.z}else L.t="s",L.v=U;if(L.t=="z"||(d.dense?(g[m]||(g[m]=[]),g[m][_]=L):g[be({c:_,r:m})]=L),v=T+1,O=f.charCodeAt(v),p.e.c<_&&(p.e.c=_),p.e.r<m&&(p.e.r=m),y==b)++_;else if(_=0,++m,d.sheetRows&&d.sheetRows<=m)return!0}e:for(;T<f.length;++T)switch(y=f.charCodeAt(T)){case 34:O===34&&(E=!E);break;case b:case 10:case 13:if(!E&&j())break e;break}return T-v>0&&j(),g["!ref"]=Pe(p),g}function s(f,u){return!(u&&u.PRN)||u.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?i(f,u):Ba(t(f,u),u)}function c(f,u){var d="",x=u.type=="string"?[0,0,0,0]:Gs(f,u);switch(u.type){case"base64":d=at(f);break;case"binary":d=f;break;case"buffer":u.codepage==65001?d=f.toString("utf8"):u.codepage&&typeof rn<"u"||(d=Me&&Buffer.isBuffer(f)?f.toString("binary"):Gt(f));break;case"array":d=sa(f);break;case"string":d=f;break;default:throw new Error("Unrecognized type "+u.type)}return x[0]==239&&x[1]==187&&x[2]==191?d=Qe(d.slice(3)):u.type!="string"&&u.type!="buffer"&&u.codepage==65001?d=Qe(d):u.type=="binary"&&typeof rn<"u",d.slice(0,19)=="socialcalc:version:"?xl.to_sheet(u.type=="string"?d:Qe(d),u):s(d,u)}function o(f,u){return zt(c(f,u),u)}function l(f){for(var u=[],d=We(f["!ref"]),x,g=Array.isArray(f),p=d.s.r;p<=d.e.r;++p){for(var m=[],_=d.s.c;_<=d.e.c;++_){var k=be({r:p,c:_});if(x=g?(f[p]||[])[_]:f[k],!x||x.v==null){m.push("          ");continue}for(var v=(x.w||(Rt(x),x.w)||"").slice(0,10);v.length<10;)v+=" ";m.push(v+(_===0?" ":""))}u.push(m.join(""))}return u.join(`
`)}return{to_workbook:o,to_sheet:c,from_sheet:l}}();function dp(e,t){var r=t||{},a=!!r.WTF;r.WTF=!0;try{var n=ul.to_workbook(e,r);return r.WTF=a,n}catch(i){if(r.WTF=a,!i.message.match(/SYLK bad record ID/)&&a)throw i;return Na.to_workbook(e,t)}}var ea=function(){function e(A,M,P){if(A){Dr(A,A.l||0);for(var D=P.Enum||_e;A.l<A.length;){var W=A.read_shift(2),Z=D[W]||D[65535],se=A.read_shift(2),ae=A.l+se,ee=Z.f&&Z.f(A,se,P);if(A.l=ae,M(ee,Z,W))return}}}function t(A,M){switch(M.type){case"base64":return r(Zr(at(A)),M);case"binary":return r(Zr(A),M);case"buffer":case"array":return r(A,M)}throw"Unsupported type "+M.type}function r(A,M){if(!A)return A;var P=M||{},D=P.dense?[]:{},W="Sheet1",Z="",se=0,ae={},ee=[],Ee=[],R={s:{r:0,c:0},e:{r:0,c:0}},q=P.sheetRows||0;if(A[2]==0&&(A[3]==8||A[3]==9)&&A.length>=16&&A[14]==5&&A[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(A[2]==2)P.Enum=_e,e(A,function(fe,H,we){switch(we){case 0:P.vers=fe,fe>=4096&&(P.qpro=!0);break;case 6:R=fe;break;case 204:fe&&(Z=fe);break;case 222:Z=fe;break;case 15:case 51:P.qpro||(fe[1].v=fe[1].v.slice(1));case 13:case 14:case 16:we==14&&(fe[2]&112)==112&&(fe[2]&15)>1&&(fe[2]&15)<15&&(fe[1].z=P.dateNF||Ae[14],P.cellDates&&(fe[1].t="d",fe[1].v=ui(fe[1].v))),P.qpro&&fe[3]>se&&(D["!ref"]=Pe(R),ae[W]=D,ee.push(W),D=P.dense?[]:{},R={s:{r:0,c:0},e:{r:0,c:0}},se=fe[3],W=Z||"Sheet"+(se+1),Z="");var Ne=P.dense?(D[fe[0].r]||[])[fe[0].c]:D[be(fe[0])];if(Ne){Ne.t=fe[1].t,Ne.v=fe[1].v,fe[1].z!=null&&(Ne.z=fe[1].z),fe[1].f!=null&&(Ne.f=fe[1].f);break}P.dense?(D[fe[0].r]||(D[fe[0].r]=[]),D[fe[0].r][fe[0].c]=fe[1]):D[be(fe[0])]=fe[1];break}},P);else if(A[2]==26||A[2]==14)P.Enum=ge,A[2]==14&&(P.qpro=!0,A.l=0),e(A,function(fe,H,we){switch(we){case 204:W=fe;break;case 22:fe[1].v=fe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(fe[3]>se&&(D["!ref"]=Pe(R),ae[W]=D,ee.push(W),D=P.dense?[]:{},R={s:{r:0,c:0},e:{r:0,c:0}},se=fe[3],W="Sheet"+(se+1)),q>0&&fe[0].r>=q)break;P.dense?(D[fe[0].r]||(D[fe[0].r]=[]),D[fe[0].r][fe[0].c]=fe[1]):D[be(fe[0])]=fe[1],R.e.c<fe[0].c&&(R.e.c=fe[0].c),R.e.r<fe[0].r&&(R.e.r=fe[0].r);break;case 27:fe[14e3]&&(Ee[fe[14e3][0]]=fe[14e3][1]);break;case 1537:Ee[fe[0]]=fe[1],fe[0]==se&&(W=fe[1]);break}},P);else throw new Error("Unrecognized LOTUS BOF "+A[2]);if(D["!ref"]=Pe(R),ae[Z||W]=D,ee.push(Z||W),!Ee.length)return{SheetNames:ee,Sheets:ae};for(var le={},ve=[],Te=0;Te<Ee.length;++Te)ae[ee[Te]]?(ve.push(Ee[Te]||ee[Te]),le[Ee[Te]]=ae[Ee[Te]]||ae[ee[Te]]):(ve.push(Ee[Te]),le[Ee[Te]]={"!ref":"A1"});return{SheetNames:ve,Sheets:le}}function a(A,M){var P=M||{};if(+P.codepage>=0&&xt(+P.codepage),P.type=="string")throw new Error("Cannot write WK1 to JS string");var D=Xr(),W=We(A["!ref"]),Z=Array.isArray(A),se=[];pe(D,0,i(1030)),pe(D,6,o(W));for(var ae=Math.min(W.e.r,8191),ee=W.s.r;ee<=ae;++ee)for(var Ee=xr(ee),R=W.s.c;R<=W.e.c;++R){ee===W.s.r&&(se[R]=sr(R));var q=se[R]+Ee,le=Z?(A[ee]||[])[R]:A[q];if(!(!le||le.t=="z"))if(le.t=="n")(le.v|0)==le.v&&le.v>=-32768&&le.v<=32767?pe(D,13,x(ee,R,le.v)):pe(D,14,p(ee,R,le.v));else{var ve=Rt(le);pe(D,15,u(ee,R,ve.slice(0,239)))}}return pe(D,1),D.end()}function n(A,M){var P=M||{};if(+P.codepage>=0&&xt(+P.codepage),P.type=="string")throw new Error("Cannot write WK3 to JS string");var D=Xr();pe(D,0,s(A));for(var W=0,Z=0;W<A.SheetNames.length;++W)(A.Sheets[A.SheetNames[W]]||{})["!ref"]&&pe(D,27,V(A.SheetNames[W],Z++));var se=0;for(W=0;W<A.SheetNames.length;++W){var ae=A.Sheets[A.SheetNames[W]];if(!(!ae||!ae["!ref"])){for(var ee=We(ae["!ref"]),Ee=Array.isArray(ae),R=[],q=Math.min(ee.e.r,8191),le=ee.s.r;le<=q;++le)for(var ve=xr(le),Te=ee.s.c;Te<=ee.e.c;++Te){le===ee.s.r&&(R[Te]=sr(Te));var fe=R[Te]+ve,H=Ee?(ae[le]||[])[Te]:ae[fe];if(!(!H||H.t=="z"))if(H.t=="n")pe(D,23,j(le,Te,se,H.v));else{var we=Rt(H);pe(D,22,y(le,Te,se,we.slice(0,239)))}}++se}}return pe(D,1),D.end()}function i(A){var M=re(2);return M.write_shift(2,A),M}function s(A){var M=re(26);M.write_shift(2,4096),M.write_shift(2,4),M.write_shift(4,0);for(var P=0,D=0,W=0,Z=0;Z<A.SheetNames.length;++Z){var se=A.SheetNames[Z],ae=A.Sheets[se];if(!(!ae||!ae["!ref"])){++W;var ee=Yr(ae["!ref"]);P<ee.e.r&&(P=ee.e.r),D<ee.e.c&&(D=ee.e.c)}}return P>8191&&(P=8191),M.write_shift(2,P),M.write_shift(1,W),M.write_shift(1,D),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(1,1),M.write_shift(1,2),M.write_shift(4,0),M.write_shift(4,0),M}function c(A,M,P){var D={s:{c:0,r:0},e:{c:0,r:0}};return M==8&&P.qpro?(D.s.c=A.read_shift(1),A.l++,D.s.r=A.read_shift(2),D.e.c=A.read_shift(1),A.l++,D.e.r=A.read_shift(2),D):(D.s.c=A.read_shift(2),D.s.r=A.read_shift(2),M==12&&P.qpro&&(A.l+=2),D.e.c=A.read_shift(2),D.e.r=A.read_shift(2),M==12&&P.qpro&&(A.l+=2),D.s.c==65535&&(D.s.c=D.e.c=D.s.r=D.e.r=0),D)}function o(A){var M=re(8);return M.write_shift(2,A.s.c),M.write_shift(2,A.s.r),M.write_shift(2,A.e.c),M.write_shift(2,A.e.r),M}function l(A,M,P){var D=[{c:0,r:0},{t:"n",v:0},0,0];return P.qpro&&P.vers!=20768?(D[0].c=A.read_shift(1),D[3]=A.read_shift(1),D[0].r=A.read_shift(2),A.l+=2):(D[2]=A.read_shift(1),D[0].c=A.read_shift(2),D[0].r=A.read_shift(2)),D}function f(A,M,P){var D=A.l+M,W=l(A,M,P);if(W[1].t="s",P.vers==20768){A.l++;var Z=A.read_shift(1);return W[1].v=A.read_shift(Z,"utf8"),W}return P.qpro&&A.l++,W[1].v=A.read_shift(D-A.l,"cstr"),W}function u(A,M,P){var D=re(7+P.length);D.write_shift(1,255),D.write_shift(2,M),D.write_shift(2,A),D.write_shift(1,39);for(var W=0;W<D.length;++W){var Z=P.charCodeAt(W);D.write_shift(1,Z>=128?95:Z)}return D.write_shift(1,0),D}function d(A,M,P){var D=l(A,M,P);return D[1].v=A.read_shift(2,"i"),D}function x(A,M,P){var D=re(7);return D.write_shift(1,255),D.write_shift(2,M),D.write_shift(2,A),D.write_shift(2,P,"i"),D}function g(A,M,P){var D=l(A,M,P);return D[1].v=A.read_shift(8,"f"),D}function p(A,M,P){var D=re(13);return D.write_shift(1,255),D.write_shift(2,M),D.write_shift(2,A),D.write_shift(8,P,"f"),D}function m(A,M,P){var D=A.l+M,W=l(A,M,P);if(W[1].v=A.read_shift(8,"f"),P.qpro)A.l=D;else{var Z=A.read_shift(2);T(A.slice(A.l,A.l+Z),W),A.l+=Z}return W}function _(A,M,P){var D=M&32768;return M&=-32769,M=(D?A:0)+(M>=8192?M-16384:M),(D?"":"$")+(P?sr(M):xr(M))}var k={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},v=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function T(A,M){Dr(A,0);for(var P=[],D=0,W="",Z="",se="",ae="";A.l<A.length;){var ee=A[A.l++];switch(ee){case 0:P.push(A.read_shift(8,"f"));break;case 1:Z=_(M[0].c,A.read_shift(2),!0),W=_(M[0].r,A.read_shift(2),!1),P.push(Z+W);break;case 2:{var Ee=_(M[0].c,A.read_shift(2),!0),R=_(M[0].r,A.read_shift(2),!1);Z=_(M[0].c,A.read_shift(2),!0),W=_(M[0].r,A.read_shift(2),!1),P.push(Ee+R+":"+Z+W)}break;case 3:if(A.l<A.length){console.error("WK1 premature formula end");return}break;case 4:P.push("("+P.pop()+")");break;case 5:P.push(A.read_shift(2));break;case 6:{for(var q="";ee=A[A.l++];)q+=String.fromCharCode(ee);P.push('"'+q.replace(/"/g,'""')+'"')}break;case 8:P.push("-"+P.pop());break;case 23:P.push("+"+P.pop());break;case 22:P.push("NOT("+P.pop()+")");break;case 20:case 21:ae=P.pop(),se=P.pop(),P.push(["AND","OR"][ee-20]+"("+se+","+ae+")");break;default:if(ee<32&&v[ee])ae=P.pop(),se=P.pop(),P.push(se+v[ee]+ae);else if(k[ee]){if(D=k[ee][1],D==69&&(D=A[A.l++]),D>P.length){console.error("WK1 bad formula parse 0x"+ee.toString(16)+":|"+P.join("|")+"|");return}var le=P.slice(-D);P.length-=D,P.push(k[ee][0]+"("+le.join(",")+")")}else return ee<=7?console.error("WK1 invalid opcode "+ee.toString(16)):ee<=24?console.error("WK1 unsupported op "+ee.toString(16)):ee<=30?console.error("WK1 invalid opcode "+ee.toString(16)):ee<=115?console.error("WK1 unsupported function opcode "+ee.toString(16)):console.error("WK1 unrecognized opcode "+ee.toString(16))}}P.length==1?M[1].f=""+P[0]:console.error("WK1 bad formula parse |"+P.join("|")+"|")}function b(A){var M=[{c:0,r:0},{t:"n",v:0},0];return M[0].r=A.read_shift(2),M[3]=A[A.l++],M[0].c=A[A.l++],M}function E(A,M){var P=b(A);return P[1].t="s",P[1].v=A.read_shift(M-4,"cstr"),P}function y(A,M,P,D){var W=re(6+D.length);W.write_shift(2,A),W.write_shift(1,P),W.write_shift(1,M),W.write_shift(1,39);for(var Z=0;Z<D.length;++Z){var se=D.charCodeAt(Z);W.write_shift(1,se>=128?95:se)}return W.write_shift(1,0),W}function O(A,M){var P=b(A);P[1].v=A.read_shift(2);var D=P[1].v>>1;if(P[1].v&1)switch(D&7){case 0:D=(D>>3)*5e3;break;case 1:D=(D>>3)*500;break;case 2:D=(D>>3)/20;break;case 3:D=(D>>3)/200;break;case 4:D=(D>>3)/2e3;break;case 5:D=(D>>3)/2e4;break;case 6:D=(D>>3)/16;break;case 7:D=(D>>3)/64;break}return P[1].v=D,P}function B(A,M){var P=b(A),D=A.read_shift(4),W=A.read_shift(4),Z=A.read_shift(2);if(Z==65535)return D===0&&W===3221225472?(P[1].t="e",P[1].v=15):D===0&&W===3489660928?(P[1].t="e",P[1].v=42):P[1].v=0,P;var se=Z&32768;return Z=(Z&32767)-16446,P[1].v=(1-se*2)*(W*Math.pow(2,Z+32)+D*Math.pow(2,Z)),P}function j(A,M,P,D){var W=re(14);if(W.write_shift(2,A),W.write_shift(1,P),W.write_shift(1,M),D==0)return W.write_shift(4,0),W.write_shift(4,0),W.write_shift(2,65535),W;var Z=0,se=0,ae=0,ee=0;return D<0&&(Z=1,D=-D),se=Math.log2(D)|0,D/=Math.pow(2,se-31),ee=D>>>0,ee&2147483648||(D/=2,++se,ee=D>>>0),D-=ee,ee|=2147483648,ee>>>=0,D*=Math.pow(2,32),ae=D>>>0,W.write_shift(4,ae),W.write_shift(4,ee),se+=16383+(Z?32768:0),W.write_shift(2,se),W}function U(A,M){var P=B(A);return A.l+=M-14,P}function L(A,M){var P=b(A),D=A.read_shift(4);return P[1].v=D>>6,P}function Y(A,M){var P=b(A),D=A.read_shift(8,"f");return P[1].v=D,P}function J(A,M){var P=Y(A);return A.l+=M-10,P}function Q(A,M){return A[A.l+M-1]==0?A.read_shift(M,"cstr"):""}function ce(A,M){var P=A[A.l++];P>M-1&&(P=M-1);for(var D="";D.length<P;)D+=String.fromCharCode(A[A.l++]);return D}function ne(A,M,P){if(!(!P.qpro||M<21)){var D=A.read_shift(1);A.l+=17,A.l+=1,A.l+=2;var W=A.read_shift(M-21,"cstr");return[D,W]}}function Se(A,M){for(var P={},D=A.l+M;A.l<D;){var W=A.read_shift(2);if(W==14e3){for(P[W]=[0,""],P[W][0]=A.read_shift(2);A[A.l];)P[W][1]+=String.fromCharCode(A[A.l]),A.l++;A.l++}}return P}function V(A,M){var P=re(5+A.length);P.write_shift(2,14e3),P.write_shift(2,M);for(var D=0;D<A.length;++D){var W=A.charCodeAt(D);P[P.l++]=W>127?95:W}return P[P.l++]=0,P}var _e={0:{n:"BOF",f:vr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:g},15:{n:"LABEL",f},16:{n:"FORMULA",f:m},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Q},222:{n:"SHEETNAMELP",f:ce},65535:{n:""}},ge={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:E},23:{n:"NUMBER17",f:B},24:{n:"NUMBER18",f:O},25:{n:"FORMULA19",f:U},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Se},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:L},38:{n:"??"},39:{n:"NUMBER27",f:Y},40:{n:"FORMULA28",f:J},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Q},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ne},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:n,to_workbook:t}}();function xp(e){var t={},r=e.match(Ur),a=0,n=!1;if(r)for(;a!=r.length;++a){var i=De(r[a]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=os[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(i[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+i[0])}}return t}var pp=function(){var e=nn("t"),t=nn("rPr");function r(i){var s=i.match(e);if(!s)return{t:"s",v:""};var c={t:"s",v:Ue(s[1])},o=i.match(t);return o&&(c.s=xp(o[1])),c}var a=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(s){return s.replace(a,"").split(n).map(r).filter(function(c){return c.v})}}(),gp=function(){var t=/(\r\n|\n)/g;function r(n,i,s){var c=[];n.u&&c.push("text-decoration: underline;"),n.uval&&c.push("text-underline-style:"+n.uval+";"),n.sz&&c.push("font-size:"+n.sz+"pt;"),n.outline&&c.push("text-effect: outline;"),n.shadow&&c.push("text-shadow: auto;"),i.push('<span style="'+c.join("")+'">'),n.b&&(i.push("<b>"),s.push("</b>")),n.i&&(i.push("<i>"),s.push("</i>")),n.strike&&(i.push("<s>"),s.push("</s>"));var o=n.valign||"";return o=="superscript"||o=="super"?o="sup":o=="subscript"&&(o="sub"),o!=""&&(i.push("<"+o+">"),s.push("</"+o+">")),s.push("</span>"),n}function a(n){var i=[[],n.v,[]];return n.v?(n.s&&r(n.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(a).join("")}}(),mp=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,vp=/<(?:\w+:)?r>/,wp=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Is(e,t){var r=t?t.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=Ue(Qe(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=Qe(e),r&&(a.h=vs(a.t))):e.match(vp)&&(a.r=Qe(e),a.t=Ue(Qe((e.replace(wp,"").match(mp)||[]).join("").replace(Ur,""))),r&&(a.h=gp(pp(a.r)))),a):{t:""}}var yp=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,_p=/<(?:\w+:)?(?:si|sstItem)>/g,kp=/<\/(?:\w+:)?(?:si|sstItem)>/;function Tp(e,t){var r=[],a="";if(!e)return r;var n=e.match(yp);if(n){a=n[2].replace(_p,"").split(kp);for(var i=0;i!=a.length;++i){var s=Is(a[i].trim(),t);s!=null&&(r[r.length]=s)}n=De(n[1]),r.Count=n.count,r.Unique=n.uniqueCount}return r}var Ep=/^\s|\s$|[\t\n\r]/;function pl(e,t){if(!t.bookSST)return"";var r=[pr];r[r.length]=de("sst",null,{xmlns:xa[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var n=e[a],i="<si>";n.r?i+=n.r:(i+="<t",n.t||(n.t=""),n.t.match(Ep)&&(i+=' xml:space="preserve"'),i+=">"+Ke(n.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function Sp(e){return[e.read_shift(4),e.read_shift(4)]}function Fp(e,t){var r=[],a=!1;return Ot(e,function(i,s,c){switch(c){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(s.T,!a||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function Ap(e,t){return t||(t=re(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var bp=Md;function Dp(e){var t=Xr();oe(t,159,Ap(e));for(var r=0;r<e.length;++r)oe(t,19,bp(e[r]));return oe(t,160),t.end()}function gl(e){for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function Nt(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function Cp(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Nt(e,4),t.U=Nt(e,4),t.W=Nt(e,4),t}function Np(e){for(var t=e.read_shift(4),r=e.l+t-4,a={},n=e.read_shift(4),i=[];n-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return a}function Ip(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(Np(e));return t}function Rp(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function Bp(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Nt(e,4),t.U=Nt(e,4),t.W=Nt(e,4),t}function Op(e){var t=Bp(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function ml(e,t){var r=e.l+t,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var n=!1;switch(a.AlgID){case 26126:case 26127:case 26128:n=a.Flags==36;break;case 26625:n=a.Flags==4;break;case 0:n=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,a}function vl(e,t){var r={},a=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,a),e.l=a,r}function Pp(e){var t=Nt(e);switch(t.Minor){case 2:return[t.Minor,Lp(e)];case 3:return[t.Minor,Mp()];case 4:return[t.Minor,jp(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function Lp(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),a=ml(e,r),n=vl(e,e.length-e.l);return{t:"Std",h:a,v:n}}function Mp(){throw new Error("File is password-protected: ECMA-376 Extensible")}function jp(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),a={};return r.replace(Ur,function(i){var s=De(i);switch(St(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(c){a[c]=s[c]});break;case"<dataIntegrity":a.encryptedHmacKey=s.encryptedHmacKey,a.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(s);break;default:throw s[0]}}),a}function Up(e,t){var r={},a=r.EncryptionVersionInfo=Nt(e,4);if(t-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=e.read_shift(4),t-=4;var n=e.read_shift(4);return t-=4,r.EncryptionHeader=ml(e,n),t-=n,r.EncryptionVerifier=vl(e,t),r}function Wp(e){var t={},r=t.EncryptionVersionInfo=Nt(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Rs(e){var t=0,r,a=gl(e),n=a.length+1,i,s,c,o,l;for(r=Wt(n),r[0]=a.length,i=1;i!=n;++i)r[i]=a[i-1];for(i=n-1;i>=0;--i)s=r[i],c=t&16384?1:0,o=t<<1&32767,l=c|o,t=l^s;return t^52811}var wl=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(s){return(s/2|s*128)&255},n=function(s,c){return a(s^c)},i=function(s){for(var c=t[s.length-1],o=104,l=s.length-1;l>=0;--l)for(var f=s[l],u=0;u!=7;++u)f&64&&(c^=r[o]),f*=2,--o;return c};return function(s){for(var c=gl(s),o=i(c),l=c.length,f=Wt(16),u=0;u!=16;++u)f[u]=0;var d,x,g;for((l&1)===1&&(d=o>>8,f[l]=n(e[0],d),--l,d=o&255,x=c[c.length-1],f[l]=n(x,d));l>0;)--l,d=o>>8,f[l]=n(c[l],d),--l,d=o&255,f[l]=n(c[l],d);for(l=15,g=15-c.length;g>0;)d=o>>8,f[l]=n(e[g],d),--l,--g,d=o&255,f[l]=n(c[l],d),--l,--g;return f}}(),Vp=function(e,t,r,a,n){n||(n=t),a||(a=wl(e));var i,s;for(i=0;i!=t.length;++i)s=t[i],s^=a[r],s=(s>>5|s<<3)&255,n[i]=s,++r;return[n,r,a]},Hp=function(e){var t=0,r=wl(e);return function(a){var n=Vp("",a,t,r);return t=n[1],n[0]}};function $p(e,t,r,a){var n={key:vr(e),verificationBytes:vr(e)};return r.password&&(n.verifier=Rs(r.password)),a.valid=n.verificationBytes===n.verifier,a.valid&&(a.insitu=Hp(r.password)),n}function Gp(e,t,r){var a=r||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=Wp(e):a.Data=Up(e,t),a}function zp(e,t,r){var a={Type:r.biff>=8?e.read_shift(2):0};return a.Type?Gp(e,t-2,a):$p(e,r.biff>=8?t:t-2,r,a),a}var yl=function(){function e(n,i){switch(i.type){case"base64":return t(at(n),i);case"binary":return t(n,i);case"buffer":return t(Me&&Buffer.isBuffer(n)?n.toString("binary"):Gt(n),i);case"array":return t(sa(n),i)}throw new Error("Unrecognized type "+i.type)}function t(n,i){var s=i||{},c=s.dense?[]:{},o=n.match(/\\trowd.*?\\row\b/g);if(!o.length)throw new Error("RTF missing table");var l={s:{c:0,r:0},e:{c:0,r:o.length-1}};return o.forEach(function(f,u){Array.isArray(c)&&(c[u]=[]);for(var d=/\\\w+\b/g,x=0,g,p=-1;g=d.exec(f);){switch(g[0]){case"\\cell":var m=f.slice(x,d.lastIndex-g[0].length);if(m[0]==" "&&(m=m.slice(1)),++p,m.length){var _={v:m,t:"s"};Array.isArray(c)?c[u][p]=_:c[be({r:u,c:p})]=_}break}x=d.lastIndex}p>l.e.c&&(l.e.c=p)}),c["!ref"]=Pe(l),c}function r(n,i){return zt(e(n,i),i)}function a(n){for(var i=["{\\rtf1\\ansi"],s=We(n["!ref"]),c,o=Array.isArray(n),l=s.s.r;l<=s.e.r;++l){i.push("\\trowd\\trautofit1");for(var f=s.s.c;f<=s.e.c;++f)i.push("\\cellx"+(f+1));for(i.push("\\pard\\intbl"),f=s.s.c;f<=s.e.c;++f){var u=be({r:l,c:f});c=o?(n[l]||[])[f]:n[u],!(!c||c.v==null&&(!c.f||c.F))&&(i.push(" "+(c.w||(Rt(c),c.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:a}}();function Xp(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function ln(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function Yp(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,n=Math.max(t,r,a),i=Math.min(t,r,a),s=n-i;if(s===0)return[0,0,t];var c=0,o=0,l=n+i;switch(o=s/(l>1?2-l:l),n){case t:c=((r-a)/s+6)%6;break;case r:c=(a-t)/s+2;break;case a:c=(t-r)/s+4;break}return[c/6,o,l/2]}function Kp(e){var t=e[0],r=e[1],a=e[2],n=r*2*(a<.5?a:1-a),i=a-n/2,s=[i,i,i],c=6*t,o;if(r!==0)switch(c|0){case 0:case 6:o=n*c,s[0]+=n,s[1]+=o;break;case 1:o=n*(2-c),s[0]+=o,s[1]+=n;break;case 2:o=n*(c-2),s[1]+=n,s[2]+=o;break;case 3:o=n*(4-c),s[1]+=o,s[2]+=n;break;case 4:o=n*(c-4),s[2]+=n,s[0]+=o;break;case 5:o=n*(6-c),s[2]+=o,s[0]+=n;break}for(var l=0;l!=3;++l)s[l]=Math.round(s[l]*255);return s}function ti(e,t){if(t===0)return e;var r=Yp(Xp(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),ln(Kp(r))}var _l=6,Qp=15,qp=1,Pr=_l;function fn(e){return Math.floor((e+Math.round(128/Pr)/256)*Pr)}function hn(e){return Math.floor((e-5)/Pr*100+.5)/100}function ai(e){return Math.round((e*Pr+5)/Pr*256)/256}function bi(e){return ai(hn(fn(e)))}function Bs(e){var t=Math.abs(e-bi(e)),r=Pr;if(t>.005)for(Pr=qp;Pr<Qp;++Pr)Math.abs(e-bi(e))<=t&&(t=Math.abs(e-bi(e)),r=Pr);Pr=r}function Vt(e){e.width?(e.wpx=fn(e.width),e.wch=hn(e.wpx),e.MDW=Pr):e.wpx?(e.wch=hn(e.wpx),e.width=ai(e.wch),e.MDW=Pr):typeof e.wch=="number"&&(e.width=ai(e.wch),e.wpx=fn(e.width),e.MDW=Pr),e.customWidth&&delete e.customWidth}var Jp=96,kl=Jp;function un(e){return e*96/kl}function Ia(e){return e*kl/96}var Zp={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function eg(e,t,r,a){t.Borders=[];var n={},i=!1;(e[0].match(Ur)||[]).forEach(function(s){var c=De(s);switch(St(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},c.diagonalUp&&(n.diagonalUp=er(c.diagonalUp)),c.diagonalDown&&(n.diagonalDown=er(c.diagonalDown)),t.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+c[0]+" in borders")}})}function rg(e,t,r,a){t.Fills=[];var n={},i=!1;(e[0].match(Ur)||[]).forEach(function(s){var c=De(s);switch(St(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},t.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":c.patternType&&(n.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),c.indexed&&(n.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(n.bgColor.theme=parseInt(c.theme,10)),c.tint&&(n.bgColor.tint=parseFloat(c.tint)),c.rgb&&(n.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),c.theme&&(n.fgColor.theme=parseInt(c.theme,10)),c.tint&&(n.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(n.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fills")}})}function tg(e,t,r,a){t.Fonts=[];var n={},i=!1;(e[0].match(Ur)||[]).forEach(function(s){var c=De(s);switch(St(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(n),n={};break;case"<name":c.val&&(n.name=Qe(c.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=c.val?er(c.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=c.val?er(c.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(c.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=c.val?er(c.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=c.val?er(c.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=c.val?er(c.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=c.val?er(c.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=c.val?er(c.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":c.val&&(n.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(n.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(n.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(n.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=os[parseInt(c.val,10)];break;case"<color":if(n.color||(n.color={}),c.auto&&(n.color.auto=er(c.auto)),c.rgb)n.color.rgb=c.rgb.slice(-6);else if(c.indexed){n.color.index=parseInt(c.indexed,10);var o=Jt[n.color.index];n.color.index==81&&(o=Jt[1]),o||(o=Jt[1]),n.color.rgb=o[0].toString(16)+o[1].toString(16)+o[2].toString(16)}else c.theme&&(n.color.theme=parseInt(c.theme,10),c.tint&&(n.color.tint=parseFloat(c.tint)),c.theme&&r.themeElements&&r.themeElements.clrScheme&&(n.color.rgb=ti(r.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a&&a.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fonts")}})}function ag(e,t,r){t.NumberFmt=[];for(var a=hr(Ae),n=0;n<a.length;++n)t.NumberFmt[a[n]]=Ae[a[n]];var i=e[0].match(Ur);if(i)for(n=0;n<i.length;++n){var s=De(i[n]);switch(St(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=Ue(Qe(s.formatCode)),o=parseInt(s.numFmtId,10);if(t.NumberFmt[o]=c,o>0){if(o>392){for(o=392;o>60&&t.NumberFmt[o]!=null;--o);t.NumberFmt[o]=c}Tt(c,o)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}function ng(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&(t[t.length]=de("numFmt",null,{numFmtId:a,formatCode:Ke(e[a])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=de("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var On=["numFmtId","fillId","fontId","borderId","xfId"],Pn=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function ig(e,t,r){t.CellXf=[];var a,n=!1;(e[0].match(Ur)||[]).forEach(function(i){var s=De(i),c=0;switch(St(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=s,delete a[0],c=0;c<On.length;++c)a[On[c]]&&(a[On[c]]=parseInt(a[On[c]],10));for(c=0;c<Pn.length;++c)a[Pn[c]]&&(a[Pn[c]]=er(a[Pn[c]]));if(t.NumberFmt&&a.numFmtId>392){for(c=392;c>60;--c)if(t.NumberFmt[a.numFmtId]==t.NumberFmt[c]){a.numFmtId=c;break}}t.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var o={};s.vertical&&(o.vertical=s.vertical),s.horizontal&&(o.horizontal=s.horizontal),s.textRotation!=null&&(o.textRotation=s.textRotation),s.indent&&(o.indent=s.indent),s.wrapText&&(o.wrapText=er(s.wrapText)),a.alignment=o;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}function sg(e){var t=[];return t[t.length]=de("cellXfs",null),e.forEach(function(r){t[t.length]=de("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=de("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var cg=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,o,l){var f={};if(!c)return f;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var u;return(u=c.match(t))&&ag(u,f,l),(u=c.match(n))&&tg(u,f,o,l),(u=c.match(a))&&rg(u,f,o,l),(u=c.match(i))&&eg(u,f,o,l),(u=c.match(r))&&ig(u,f,l),f}}();function Tl(e,t){var r=[pr,de("styleSheet",null,{xmlns:xa[0],"xmlns:vt":wr.vt})],a;return e.SSF&&(a=ng(e.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=sg(t.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function og(e,t){var r=e.read_shift(2),a=Mr(e);return[r,a]}function lg(e,t,r){r||(r=re(6+4*t.length)),r.write_shift(2,e),Ar(t,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function fg(e,t,r){var a={};a.sz=e.read_shift(2)/20;var n=Gd(e);n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1);var i=e.read_shift(2);switch(i===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(a.underline=s);var c=e.read_shift(1);c>0&&(a.family=c);var o=e.read_shift(1);switch(o>0&&(a.charset=o),e.l++,a.color=$d(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=Mr(e),a}function hg(e,t){t||(t=re(25+4*32)),t.write_shift(2,e.sz*20),zd(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Zn(e.color,t);var a=0;return a=2,t.write_shift(1,a),Ar(e.name,t),t.length>t.l?t.slice(0,t.l):t}var ug=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Di,dg=jr;function ec(e,t){t||(t=re(4*3+8*7+16*1)),Di||(Di=fi(ug));var r=Di[e.patternType];r==null&&(r=40),t.write_shift(4,r);var a=0;if(r!=40)for(Zn({auto:1},t),Zn({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function xg(e,t){var r=e.l+t,a=e.read_shift(2),n=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:n}}function El(e,t,r){r||(r=re(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function ja(e,t){return t||(t=re(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var pg=jr;function gg(e,t){return t||(t=re(51)),t.write_shift(1,0),ja(null,t),ja(null,t),ja(null,t),ja(null,t),ja(null,t),t.length>t.l?t.slice(0,t.l):t}function mg(e,t){return t||(t=re(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Jn(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function vg(e,t,r){var a=re(2052);return a.write_shift(4,e),Jn(t,a),Jn(r,a),a.length>a.l?a.slice(0,a.l):a}function wg(e,t,r){var a={};a.NumberFmt=[];for(var n in Ae)a.NumberFmt[n]=Ae[n];a.CellXf=[],a.Fonts=[];var i=[],s=!1;return Ot(e,function(o,l,f){switch(f){case 44:a.NumberFmt[o[0]]=o[1],Tt(o[1],o[0]);break;case 43:a.Fonts.push(o),o.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(o.color.rgb=ti(t.themeElements.clrScheme[o.color.theme].rgb,o.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&a.CellXf.push(o);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:i.push(f),s=!0;break;case 38:i.pop(),s=!1;break;default:if(l.T>0)i.push(f);else if(l.T<0)i.pop();else if(!s||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),a}function yg(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&++r}),r!=0&&(oe(e,615,mt(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&oe(e,44,lg(n,t[n]))}),oe(e,616))}}function _g(e){var t=1;oe(e,611,mt(t)),oe(e,43,hg({sz:12,color:{theme:1},name:"Calibri",family:2})),oe(e,612)}function kg(e){var t=2;oe(e,603,mt(t)),oe(e,45,ec({patternType:"none"})),oe(e,45,ec({patternType:"gray125"})),oe(e,604)}function Tg(e){var t=1;oe(e,613,mt(t)),oe(e,46,gg()),oe(e,614)}function Eg(e){var t=1;oe(e,626,mt(t)),oe(e,47,El({numFmtId:0},65535)),oe(e,627)}function Sg(e,t){oe(e,617,mt(t.length)),t.forEach(function(r){oe(e,47,El(r,0))}),oe(e,618)}function Fg(e){var t=1;oe(e,619,mt(t)),oe(e,48,mg({xfId:0,name:"Normal"})),oe(e,620)}function Ag(e){var t=0;oe(e,505,mt(t)),oe(e,506)}function bg(e){var t=0;oe(e,508,vg(t,"TableStyleMedium9","PivotStyleMedium4")),oe(e,509)}function Dg(e,t){var r=Xr();return oe(r,278),yg(r,e.SSF),_g(r),kg(r),Tg(r),Eg(r),Sg(r,t.cellXfs),Fg(r),Ag(r),bg(r),oe(r,279),r.end()}var Cg=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Ng(e,t,r){t.themeElements.clrScheme=[];var a={};(e[0].match(Ur)||[]).forEach(function(n){var i=De(n);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=i.val;break;case"<a:sysClr":a.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[Cg.indexOf(i[0])]=a,a={}):a.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function Ig(){}function Rg(){}var Bg=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Og=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Pg=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Lg(e,t,r){t.themeElements={};var a;[["clrScheme",Bg,Ng],["fontScheme",Og,Ig],["fmtScheme",Pg,Rg]].forEach(function(n){if(!(a=e.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](a,t,r)})}var Mg=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Sl(e,t){(!e||e.length===0)&&(e=Os());var r,a={};if(!(r=e.match(Mg)))throw new Error("themeElements not found in theme");return Lg(r[0],a,t),a.raw=e,a}function Os(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[pr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="Ôº≠Ôº≥ Ôº∞„Ç¥„Ç∑„ÉÉ„ÇØ"/>',r[r.length]='<a:font script="Hang" typeface="ÎßëÏùÄ Í≥†Îîï"/>',r[r.length]='<a:font script="Hans" typeface="ÂÆã‰Ωì"/>',r[r.length]='<a:font script="Hant" typeface="Êñ∞Á¥∞ÊòéÈ´î"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="Ôº≠Ôº≥ Ôº∞„Ç¥„Ç∑„ÉÉ„ÇØ"/>',r[r.length]='<a:font script="Hang" typeface="ÎßëÏùÄ Í≥†Îîï"/>',r[r.length]='<a:font script="Hans" typeface="ÂÆã‰Ωì"/>',r[r.length]='<a:font script="Hant" typeface="Êñ∞Á¥∞ÊòéÈ´î"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function jg(e,t,r){var a=e.l+t,n=e.read_shift(4);if(n!==124226){if(!r.cellStyles){e.l=a;return}var i=e.slice(e.l);e.l=a;var s;try{s=mo(i,{type:"array"})}catch{return}var c=et(s,"theme/theme/theme1.xml",!0);if(c)return Sl(c,r)}}function Ug(e){return e.read_shift(4)}function Wg(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=Vg(e,4);break;case 2:t.xclrValue=nl(e);break;case 3:t.xclrValue=Ug(e);break;case 4:e.l+=4;break}return e.l+=8,t}function Vg(e,t){return jr(e,t)}function Hg(e,t){return jr(e,t)}function $g(e){var t=e.read_shift(2),r=e.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=Wg(e);break;case 6:a[1]=Hg(e,r);break;case 14:case 15:a[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return a}function Gg(e,t){var r=e.l+t;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),i=[];n-- >0;)i.push($g(e,r-e.l));return{ixfe:a,ext:i}}function zg(e,t){t.forEach(function(r){switch(r[0]){}})}function Xg(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Mr(e)}}function Yg(e){var t=re(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Ar(e.name,t),t.slice(0,t.l)}function Kg(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Qg(e){var t=re(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function qg(e,t){var r=re(8+2*t.length);return r.write_shift(4,e),Ar(t,r),r.slice(0,r.l)}function Jg(e){return e.l+=4,e.read_shift(4)!=0}function Zg(e,t){var r=re(8);return r.write_shift(4,e),r.write_shift(4,1),r}function em(e,t,r){var a={Types:[],Cell:[],Value:[]},n=r||{},i=[],s=!1,c=2;return Ot(e,function(o,l,f){switch(f){case 335:a.Types.push({name:o.name});break;case 51:o.forEach(function(u){c==1?a.Cell.push({type:a.Types[u[0]-1].name,index:u[1]}):c==0&&a.Value.push({type:a.Types[u[0]-1].name,index:u[1]})});break;case 337:c=o?1:0;break;case 338:c=2;break;case 35:i.push(f),s=!0;break;case 36:i.pop(),s=!1;break;default:if(!l.T){if(!s||n.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),a}function rm(){var e=Xr();return oe(e,332),oe(e,334,mt(1)),oe(e,335,Yg({name:"XLDAPR",version:12e4,flags:3496657072})),oe(e,336),oe(e,339,qg(1,"XLDAPR")),oe(e,52),oe(e,35,mt(514)),oe(e,4096,mt(0)),oe(e,4097,ft(1)),oe(e,36),oe(e,53),oe(e,340),oe(e,337,Zg(1)),oe(e,51,Qg([[1,0]])),oe(e,338),oe(e,333),e.end()}function tm(e,t,r){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var n=!1,i=2,s;return e.replace(Ur,function(c){var o=De(c);switch(St(o[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:o.name});break;case"</metadataType>":break;case"<futureMetadata":for(var l=0;l<a.Types.length;++l)a.Types[l].name==o.name&&(s=a.Types[l]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?a.Cell.push({type:a.Types[o.t-1].name,index:+o.v}):i==0&&a.Value.push({type:a.Types[o.t-1].name,index:+o.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+o.i);break;default:if(!n&&r.WTF)throw new Error("unrecognized "+o[0]+" in metadata")}return c}),a}function Fl(){var e=[pr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function am(e){var t=[];if(!e)return t;var r=1;return(e.match(Ur)||[]).forEach(function(a){var n=De(a);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,t.push(n);break}}),t}function nm(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=be(r);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}function im(e,t,r){var a=[];return Ot(e,function(i,s,c){switch(c){case 63:a.push(i);break;default:if(!s.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),a}function sm(e,t,r,a){if(!e)return e;var n=a||{},i=!1;Ot(e,function(c,o,l){switch(l){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!o.T){if(!i||n.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}},n)}function cm(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Ea=1024;function Al(e,t){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),n=[de("xml",null,{"xmlns:v":qr.v,"xmlns:o":qr.o,"xmlns:x":qr.x,"xmlns:mv":qr.mv}).replace(/\/>/,">"),de("o:shapelayout",de("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),de("v:shapetype",[de("v:stroke",null,{joinstyle:"miter"}),de("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];Ea<e*1e3;)Ea+=1e3;return t.forEach(function(i){var s=cr(i[0]),c={color2:"#BEFF82",type:"gradient"};c.type=="gradient"&&(c.angle="-180");var o=c.type=="gradient"?de("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,l=de("v:fill",o,c),f={on:"t",obscured:"t"};++Ea,n=n.concat(["<v:shape"+sn({id:"_x0000_s"+Ea,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",l,de("v:shadow",null,f),de("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Cr("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),Cr("x:AutoFill","False"),Cr("x:Row",String(s.r)),Cr("x:Column",String(s.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function rc(e,t,r,a){var n=Array.isArray(e),i;t.forEach(function(s){var c=cr(s.ref);if(n?(e[c.r]||(e[c.r]=[]),i=e[c.r][c.c]):i=e[s.ref],!i){i={t:"z"},n?e[c.r][c.c]=i:e[s.ref]=i;var o=We(e["!ref"]||"BDWGO1000001:A1");o.s.r>c.r&&(o.s.r=c.r),o.e.r<c.r&&(o.e.r=c.r),o.s.c>c.c&&(o.s.c=c.c),o.e.c<c.c&&(o.e.c=c.c);var l=Pe(o);l!==e["!ref"]&&(e["!ref"]=l)}i.c||(i.c=[]);var f={a:s.author,t:s.t,r:s.r,T:r};s.h&&(f.h=s.h);for(var u=i.c.length-1;u>=0;--u){if(!r&&i.c[u].T)return;r&&!i.c[u].T&&i.c.splice(u,1)}if(r&&a){for(u=0;u<a.length;++u)if(f.a==a[u].id){f.a=a[u].name||f.a;break}}i.c.push(f)})}function om(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],n=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var c=s.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&r.push(c[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var c=s.match(/<(?:\w+:)?comment[^>]*>/);if(c){var o=De(c[0]),l={author:o.authorId&&r[o.authorId]||"sheetjsghost",ref:o.ref,guid:o.guid},f=cr(o.ref);if(!(t.sheetRows&&t.sheetRows<=f.r)){var u=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!u&&!!u[1]&&Is(u[1])||{r:"",t:"",h:""};l.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),l.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(l.h=d.h),a.push(l)}}}}),a}function bl(e){var t=[pr,de("comments",null,{xmlns:xa[0]})],r=[];return t.push("<authors>"),e.forEach(function(a){a[1].forEach(function(n){var i=Ke(n.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),n.T&&n.ID&&r.indexOf("tc="+n.ID)==-1&&(r.push("tc="+n.ID),t.push("<author>tc="+n.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(a){var n=0,i=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?n=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(o){o.a&&(n=r.indexOf(Ke(o.a))),i.push(o.t||"")}),t.push('<comment ref="'+a[0]+'" authorId="'+n+'"><text>'),i.length<=1)t.push(Cr("t",Ke(i[0]||"")));else{for(var s=`Comment:
    `+i[0]+`
`,c=1;c<i.length;++c)s+=`Reply:
    `+i[c]+`
`;t.push(Cr("t",Ke(s)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function lm(e,t){var r=[],a=!1,n={},i=0;return e.replace(Ur,function(c,o){var l=De(c);switch(St(l[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":n.t!=null&&r.push(n);break;case"<text>":case"<text":i=o+c.length;break;case"</text>":n.t=e.slice(i,o).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return c}),r}function fm(e,t,r){var a=[pr,de("ThreadedComments",null,{xmlns:wr.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(n){var i="";(n[1]||[]).forEach(function(s,c){if(!s.T){delete s.ID;return}s.a&&t.indexOf(s.a)==-1&&t.push(s.a);var o={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};c==0?i=o.id:o.parentId=i,s.ID=o.id,s.a&&(o.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),a.push(de("threadedComment",Cr("text",s.t||""),o))})}),a.push("</ThreadedComments>"),a.join("")}function hm(e,t){var r=[],a=!1;return e.replace(Ur,function(i){var s=De(i);switch(St(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return i}),r}function um(e){var t=[pr,de("personList",null,{xmlns:wr.TCMNT,"xmlns:x":xa[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,a){t.push(de("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function dm(e){var t={};t.iauthor=e.read_shift(4);var r=va(e);return t.rfx=r.s,t.ref=be(r.s),e.l+=16,t}function xm(e,t){return t==null&&(t=re(36)),t.write_shift(4,e[1].iauthor),Oa(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var pm=Mr;function gm(e){return Ar(e.slice(0,54))}function mm(e,t){var r=[],a=[],n={},i=!1;return Ot(e,function(c,o,l){switch(l){case 632:a.push(c);break;case 635:n=c;break;case 637:n.t=c.t,n.h=c.h,n.r=c.r;break;case 636:if(n.author=a[n.iauthor],delete n.iauthor,t.sheetRows&&n.rfx&&t.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,r.push(n);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!o.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}}),r}function vm(e){var t=Xr(),r=[];return oe(t,628),oe(t,630),e.forEach(function(a){a[1].forEach(function(n){r.indexOf(n.a)>-1||(r.push(n.a.slice(0,54)),oe(t,632,gm(n.a)))})}),oe(t,631),oe(t,633),e.forEach(function(a){a[1].forEach(function(n){n.iauthor=r.indexOf(n.a);var i={s:cr(a[0]),e:cr(a[0])};oe(t,635,xm([i,n])),n.t&&n.t.length>0&&oe(t,637,Ud(n)),oe(t,636),delete n.iauthor})}),oe(t,634),oe(t,629),t.end()}var wm="application/vnd.ms-office.vbaProject";function ym(e){var t=Fe.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var n=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Fe.utils.cfb_add(t,n,e.FileIndex[a].content)}}),Fe.write(t)}function _m(e,t){t.FullPaths.forEach(function(r,a){if(a!=0){var n=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&Fe.utils.cfb_add(e,n,t.FileIndex[a].content)}})}var Dl=["xlsb","xlsm","xlam","biff8","xla"];function km(){return{"!type":"dialog"}}function Tm(){return{"!type":"dialog"}}function Em(){return{"!type":"macro"}}function Sm(){return{"!type":"macro"}}var ba=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(a,n,i,s){var c=!1,o=!1;i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1)),s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1));var l=i.length>0?parseInt(i,10)|0:0,f=s.length>0?parseInt(s,10)|0:0;return c?f+=t.c:--f,o?l+=t.r:--l,n+(c?"":"$")+sr(f)+(o?"":"$")+xr(l)}return function(n,i){return t=i,n.replace(e,r)}}(),Ps=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Ls=function(){return function(t,r){return t.replace(Ps,function(a,n,i,s,c,o){var l=Ts(s)-(i?0:r.c),f=ks(o)-(c?0:r.r),u=f==0?"":c?f+1:"["+f+"]",d=l==0?"":i?l+1:"["+l+"]";return n+"R"+u+"C"+d})}}();function Cl(e,t){return e.replace(Ps,function(r,a,n,i,s,c){return a+(n=="$"?n+i:sr(Ts(i)+t.c))+(s=="$"?s+c:xr(ks(c)+t.r))})}function Fm(e,t,r){var a=Yr(t),n=a.s,i=cr(r),s={r:i.r-n.r,c:i.c-n.c};return Cl(e,s)}function Am(e){return e.length!=1}function tc(e){return e.replace(/_xlfn\./g,"")}function gr(e){e.l+=1}function Ht(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Nl(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return Il(e);r.biff==12&&(a=4)}var n=e.read_shift(a),i=e.read_shift(a),s=Ht(e),c=Ht(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:c[0],cRel:c[1],rRel:c[2]}}}function Il(e){var t=Ht(e),r=Ht(e),a=e.read_shift(1),n=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function bm(e,t,r){if(r.biff<8)return Il(e);var a=e.read_shift(r.biff==12?4:2),n=e.read_shift(r.biff==12?4:2),i=Ht(e),s=Ht(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:n,c:s[0],cRel:s[1],rRel:s[2]}}}function Rl(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return Dm(e);var a=e.read_shift(r&&r.biff==12?4:2),n=Ht(e);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function Dm(e){var t=Ht(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function Cm(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Nm(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return Im(e);var n=e.read_shift(a>=12?4:2),i=e.read_shift(2),s=(i&16384)>>14,c=(i&32768)>>15;if(i&=16383,c==1)for(;n>524287;)n-=1048576;if(s==1)for(;i>8191;)i=i-16384;return{r:n,c:i,cRel:s,rRel:c}}function Im(e){var t=e.read_shift(2),r=e.read_shift(1),a=(t&32768)>>15,n=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),n==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:n,rRel:a}}function Rm(e,t,r){var a=(e[e.l++]&96)>>5,n=Nl(e,r.biff>=2&&r.biff<=5?6:8,r);return[a,n]}function Bm(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var s=Nl(e,i,r);return[a,n,s]}function Om(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function Pm(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[a,n]}function Lm(e,t,r){var a=(e[e.l++]&96)>>5,n=bm(e,t-1,r);return[a,n]}function Mm(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[a]}function ac(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function jm(e,t,r){e.l+=2;for(var a=e.read_shift(r&&r.biff==2?1:2),n=[],i=0;i<=a;++i)n.push(e.read_shift(r&&r.biff==2?1:2));return n}function Um(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function Wm(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function Vm(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Hm(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[a]}function Bl(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function $m(e){return e.read_shift(2),Bl(e)}function Gm(e){return e.read_shift(2),Bl(e)}function zm(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=Rl(e,0,r);return[a,n]}function Xm(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=Nm(e,0,r);return[a,n]}function Ym(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=Rl(e,0,r);return[a,n,i]}function Km(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(r&&r.biff<=3?1:2);return[Jv[n],Ll[n],a]}function Qm(e,t,r){var a=e[e.l++],n=e.read_shift(1),i=r&&r.biff<=3?[a==88?-1:0,e.read_shift(1)]:qm(e);return[n,(i[0]===0?Ll:qv)[i[1]]]}function qm(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Jm(e,t,r){e.l+=r&&r.biff==2?3:4}function Zm(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function ev(e){return e.l++,Pt[e.read_shift(1)]}function rv(e){return e.l++,e.read_shift(2)}function tv(e){return e.l++,e.read_shift(1)!==0}function av(e){return e.l++,Lr(e)}function nv(e,t,r){return e.l++,wn(e,t-1,r)}function iv(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=dr(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Pt[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Lr(e);break;case 2:r[1]=wa(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function sv(e,t,r){for(var a=e.read_shift(r.biff==12?4:2),n=[],i=0;i!=a;++i)n.push((r.biff==12?va:di)(e));return n}function cv(e,t,r){var a=0,n=0;r.biff==12?(a=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--n==0&&(n=256));for(var i=0,s=[];i!=a&&(s[i]=[]);++i)for(var c=0;c!=n;++c)s[i][c]=iv(e,r.biff);return s}function ov(e,t,r){var a=e.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,i=e.read_shift(n);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,i]}function lv(e,t,r){if(r.biff==5)return fv(e);var a=e.read_shift(1)>>>5&3,n=e.read_shift(2),i=e.read_shift(4);return[a,n,i]}function fv(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}function hv(e,t,r){var a=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function uv(e,t,r){var a=e.read_shift(1)>>>5&3,n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function dv(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[a]}function xv(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[a,n]}var pv=jr,gv=jr,mv=jr;function _n(e,t,r){return e.l+=2,[Cm(e)]}function Ms(e){return e.l+=6,[]}var vv=_n,wv=Ms,yv=Ms,_v=_n;function Ol(e){return e.l+=2,[vr(e),e.read_shift(2)&1]}var kv=_n,Tv=Ol,Ev=Ms,Sv=_n,Fv=_n,Av=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function bv(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n=e.read_shift(2),i=e.read_shift(2),s=Av[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:a,c:n,C:i}}function Dv(e){return e.l+=2,[e.read_shift(4)]}function Cv(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function Nv(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Iv(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Rv(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Bv(e){return e.l+=4,[0,0]}var nc={1:{n:"PtgExp",f:Zm},2:{n:"PtgTbl",f:mv},3:{n:"PtgAdd",f:gr},4:{n:"PtgSub",f:gr},5:{n:"PtgMul",f:gr},6:{n:"PtgDiv",f:gr},7:{n:"PtgPower",f:gr},8:{n:"PtgConcat",f:gr},9:{n:"PtgLt",f:gr},10:{n:"PtgLe",f:gr},11:{n:"PtgEq",f:gr},12:{n:"PtgGe",f:gr},13:{n:"PtgGt",f:gr},14:{n:"PtgNe",f:gr},15:{n:"PtgIsect",f:gr},16:{n:"PtgUnion",f:gr},17:{n:"PtgRange",f:gr},18:{n:"PtgUplus",f:gr},19:{n:"PtgUminus",f:gr},20:{n:"PtgPercent",f:gr},21:{n:"PtgParen",f:gr},22:{n:"PtgMissArg",f:gr},23:{n:"PtgStr",f:nv},26:{n:"PtgSheet",f:Cv},27:{n:"PtgEndSheet",f:Nv},28:{n:"PtgErr",f:ev},29:{n:"PtgBool",f:tv},30:{n:"PtgInt",f:rv},31:{n:"PtgNum",f:av},32:{n:"PtgArray",f:Mm},33:{n:"PtgFunc",f:Km},34:{n:"PtgFuncVar",f:Qm},35:{n:"PtgName",f:ov},36:{n:"PtgRef",f:zm},37:{n:"PtgArea",f:Rm},38:{n:"PtgMemArea",f:hv},39:{n:"PtgMemErr",f:pv},40:{n:"PtgMemNoMem",f:gv},41:{n:"PtgMemFunc",f:uv},42:{n:"PtgRefErr",f:dv},43:{n:"PtgAreaErr",f:Om},44:{n:"PtgRefN",f:Xm},45:{n:"PtgAreaN",f:Lm},46:{n:"PtgMemAreaN",f:Iv},47:{n:"PtgMemNoMemN",f:Rv},57:{n:"PtgNameX",f:lv},58:{n:"PtgRef3d",f:Ym},59:{n:"PtgArea3d",f:Bm},60:{n:"PtgRefErr3d",f:xv},61:{n:"PtgAreaErr3d",f:Pm},255:{}},Ov={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Pv={1:{n:"PtgElfLel",f:Ol},2:{n:"PtgElfRw",f:Sv},3:{n:"PtgElfCol",f:vv},6:{n:"PtgElfRwV",f:Fv},7:{n:"PtgElfColV",f:_v},10:{n:"PtgElfRadical",f:kv},11:{n:"PtgElfRadicalS",f:Ev},13:{n:"PtgElfColS",f:wv},15:{n:"PtgElfColSV",f:yv},16:{n:"PtgElfRadicalLel",f:Tv},25:{n:"PtgList",f:bv},29:{n:"PtgSxName",f:Dv},255:{}},Lv={0:{n:"PtgAttrNoop",f:Bv},1:{n:"PtgAttrSemi",f:Hm},2:{n:"PtgAttrIf",f:Wm},4:{n:"PtgAttrChoose",f:jm},8:{n:"PtgAttrGoto",f:Um},16:{n:"PtgAttrSum",f:Jm},32:{n:"PtgAttrBaxcel",f:ac},33:{n:"PtgAttrBaxcel",f:ac},64:{n:"PtgAttrSpace",f:$m},65:{n:"PtgAttrSpaceSemi",f:Gm},128:{n:"PtgAttrIfError",f:Vm},255:{}};function kn(e,t,r,a){if(a.biff<8)return jr(e,t);for(var n=e.l+t,i=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=cv(e,0,a),i.push(r[s][1]);break;case"PtgMemArea":r[s][2]=sv(e,r[s][1],a),i.push(r[s][2]);break;case"PtgExp":a&&a.biff==12&&(r[s][1][1]=e.read_shift(4),i.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return t=n-e.l,t!==0&&i.push(jr(e,t)),i}function Tn(e,t,r){for(var a=e.l+t,n,i,s=[];a!=e.l;)t=a-e.l,i=e[e.l],n=nc[i]||nc[Ov[i]],(i===24||i===25)&&(n=(i===24?Pv:Lv)[e[e.l+1]]),!n||!n.f?jr(e,t):s.push([n.n,n.f(e,t,r)]);return s}function Mv(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],n=[],i=0;i<a.length;++i){var s=a[i];if(s)switch(s[0]){case 2:n.push('"'+s[1].replace(/"/g,'""')+'"');break;default:n.push(s[1])}else n.push("")}t.push(n.join(","))}return t.join(";")}var jv={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Uv(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Pl(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var n="";if(r.biff>8)switch(e[a[0]][0]){case 357:return n=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return n=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[a[0]][0][3]?(n=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function ic(e,t,r){var a=Pl(e,t,r);return a=="#REF"?a:Uv(a,r)}function Or(e,t,r,a,n){var i=n&&n.biff||8,s={s:{c:0,r:0}},c=[],o,l,f,u=0,d=0,x,g="";if(!e[0]||!e[0][0])return"";for(var p=-1,m="",_=0,k=e[0].length;_<k;++_){var v=e[0][_];switch(v[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(o=c.pop(),l=c.pop(),p>=0){switch(e[0][p][1][0]){case 0:m=lr(" ",e[0][p][1][1]);break;case 1:m=lr("\r",e[0][p][1][1]);break;default:if(m="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}l=l+m,p=-1}c.push(l+jv[v[0]]+o);break;case"PtgIsect":o=c.pop(),l=c.pop(),c.push(l+" "+o);break;case"PtgUnion":o=c.pop(),l=c.pop(),c.push(l+","+o);break;case"PtgRange":o=c.pop(),l=c.pop(),c.push(l+":"+o);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Ya(v[1][1],s,n),c.push(Ka(f,i));break;case"PtgRefN":f=r?Ya(v[1][1],r,n):v[1][1],c.push(Ka(f,i));break;case"PtgRef3d":u=v[1][1],f=Ya(v[1][2],s,n),g=ic(a,u,n),c.push(g+"!"+Ka(f,i));break;case"PtgFunc":case"PtgFuncVar":var T=v[1][0],b=v[1][1];T||(T=0),T&=127;var E=T==0?[]:c.slice(-T);c.length-=T,b==="User"&&(b=E.shift()),c.push(b+"("+E.join(",")+")");break;case"PtgBool":c.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(v[1]);break;case"PtgNum":c.push(String(v[1]));break;case"PtgStr":c.push('"'+v[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(v[1]);break;case"PtgAreaN":x=B0(v[1][1],r?{s:r}:s,n),c.push(Si(x,n));break;case"PtgArea":x=B0(v[1][1],s,n),c.push(Si(x,n));break;case"PtgArea3d":u=v[1][1],x=v[1][2],g=ic(a,u,n),c.push(g+"!"+Si(x,n));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=v[1][2];var y=(a.names||[])[d-1]||(a[0]||[])[d],O=y?y.Name:"SH33TJSNAME"+String(d);O&&O.slice(0,6)=="_xlfn."&&!n.xlfn&&(O=O.slice(6)),c.push(O);break;case"PtgNameX":var B=v[1][1];d=v[1][2];var j;if(n.biff<=5)B<0&&(B=-B),a[B]&&(j=a[B][d]);else{var U="";if(((a[B]||[])[0]||[])[0]==14849||(((a[B]||[])[0]||[])[0]==1025?a[B][d]&&a[B][d].itab>0&&(U=a.SheetNames[a[B][d].itab-1]+"!"):U=a.SheetNames[d-1]+"!"),a[B]&&a[B][d])U+=a[B][d].Name;else if(a[0]&&a[0][d])U+=a[0][d].Name;else{var L=(Pl(a,B,n)||"").split(";;");L[d-1]?U=L[d-1]:U+="SH33TJSERRX"}c.push(U);break}j||(j={Name:"SH33TJSERRY"}),c.push(j.Name);break;case"PtgParen":var Y="(",J=")";if(p>=0){switch(m="",e[0][p][1][0]){case 2:Y=lr(" ",e[0][p][1][1])+Y;break;case 3:Y=lr("\r",e[0][p][1][1])+Y;break;case 4:J=lr(" ",e[0][p][1][1])+J;break;case 5:J=lr("\r",e[0][p][1][1])+J;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}c.push(Y+c.pop()+J);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":f={c:v[1][1],r:v[1][0]};var Q={c:r.c,r:r.r};if(a.sharedf[be(f)]){var ce=a.sharedf[be(f)];c.push(Or(ce,s,Q,a,n))}else{var ne=!1;for(o=0;o!=a.arrayf.length;++o)if(l=a.arrayf[o],!(f.c<l[0].s.c||f.c>l[0].e.c)&&!(f.r<l[0].s.r||f.r>l[0].e.r)){c.push(Or(l[1],s,Q,a,n)),ne=!0;break}ne||c.push(v[1])}break;case"PtgArray":c.push("{"+Mv(v[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=_;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+v[1].idx+"[#"+v[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(v));default:throw new Error("Unrecognized Formula Token: "+String(v))}var Se=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&p>=0&&Se.indexOf(e[0][_][0])==-1){v=e[0][p];var V=!0;switch(v[1][0]){case 4:V=!1;case 0:m=lr(" ",v[1][1]);break;case 5:V=!1;case 1:m=lr("\r",v[1][1]);break;default:if(m="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+v[1][0])}c.push((V?m:"")+c.pop()+(V?"":m)),p=-1}}if(c.length>1&&n.WTF)throw new Error("bad formula stack");return c[0]}function Wv(e,t,r){var a=e.l+t,n=r.biff==2?1:2,i,s=e.read_shift(n);if(s==65535)return[[],jr(e,t-2)];var c=Tn(e,s,r);return t!==s+n&&(i=kn(e,t-s-n,c,r)),e.l=a,[c,i]}function Vv(e,t,r){var a=e.l+t,n=r.biff==2?1:2,i,s=e.read_shift(n);if(s==65535)return[[],jr(e,t-2)];var c=Tn(e,s,r);return t!==s+n&&(i=kn(e,t-s-n,c,r)),e.l=a,[c,i]}function Hv(e,t,r,a){var n=e.l+t,i=Tn(e,a,r),s;return n!==e.l&&(s=kn(e,n-e.l,i,r)),[i,s]}function $v(e,t,r){var a=e.l+t,n,i=e.read_shift(2),s=Tn(e,i,r);return i==65535?[[],jr(e,t-2)]:(t!==i+2&&(n=kn(e,a-i-2,s,r)),[s,n])}function Gv(e){var t;if(Dt(e,e.l+6)!==65535)return[Lr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function zv(e){if(e==null){var t=re(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return ca(e);return ca(0)}function Ci(e,t,r){var a=e.l+t,n=Ft(e);r.biff==2&&++e.l;var i=Gv(e),s=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var c=Vv(e,a-e.l,r);return{cell:n,val:i[0],formula:c,shared:s>>3&1,tt:i[1]}}function Xv(e,t,r,a,n){var i=la(t,r,n),s=zv(e.v),c=re(6),o=33;c.write_shift(2,o),c.write_shift(4,0);for(var l=re(e.bf.length),f=0;f<e.bf.length;++f)l[f]=e.bf[f];var u=Fr([i,s,c,l]);return u}function xi(e,t,r){var a=e.read_shift(4),n=Tn(e,a,r),i=e.read_shift(4),s=i>0?kn(e,i,n,r):null;return[n,s]}var Yv=xi,pi=xi,Kv=xi,Qv=xi,qv={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Ll={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Jv={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function sc(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Zv(e){var t="of:="+e.replace(Ps,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Ni(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function e2(e){return e.replace(/\./,"!")}var qa={},Da={},Ja=typeof Map<"u";function js(e,t,r){var a=0,n=e.length;if(r){if(Ja?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=Ja?r.get(t):r[t];a<i.length;++a)if(e[i[a]].t===t)return e.Count++,i[a]}}else for(;a<n;++a)if(e[a].t===t)return e.Count++,a;return e[n]={t},e.Count++,e.Unique++,r&&(Ja?(r.has(t)||r.set(t,[]),r.get(t).push(n)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(n))),n}function gi(e,t){var r={min:e+1,max:e+1},a=-1;return t.MDW&&(Pr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?a=hn(t.wpx):t.wch!=null&&(a=t.wch),a>-1?(r.width=ai(a),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function ra(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Xt(e,t,r){var a=r.revssf[t.z!=null?t.z:"General"],n=60,i=e.length;if(a==null&&r.ssf){for(;n<392;++n)if(r.ssf[n]==null){Tt(t.z,n),r.ssf[n]=t.z,r.revssf[t.z]=a=n;break}}for(n=0;n!=i;++n)if(e[n].numFmtId===a)return n;return e[i]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function Ml(e,t,r,a,n,i){try{a.cellNF&&(e.z=Ae[t])}catch(c){if(a.WTF)throw c}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=rr(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(Ae[t]==null&&Tt(qu[t]||"General",t),e.t==="e")e.w=e.w||Pt[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=an(e.v);else if(e.t==="d"){var s=_r(e.v);(s|0)===s?e.w=s.toString(10):e.w=an(s)}else{if(e.v===void 0)return"";e.w=ia(e.v,Da)}else e.t==="d"?e.w=nt(t,_r(e.v),Da):e.w=nt(t,e.v,Da)}catch(c){if(a.WTF)throw c}if(a.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=ti(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=ti(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(c){if(a.WTF&&i.Fills)throw c}}}function r2(e,t,r){if(e&&e["!ref"]){var a=We(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function t2(e,t){var r=We(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Pe(r))}var a2=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,n2=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,i2=/<(?:\w:)?hyperlink [^>]*>/mg,s2=/"(\w*:\w*)"/,c2=/<(?:\w:)?col\b[^>]*[\/]?>/g,o2=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,l2=/<(?:\w:)?pageMargins[^>]*\/>/g,jl=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,f2=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,h2=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function u2(e,t,r,a,n,i,s){if(!e)return e;a||(a={"!id":{}});var c=t.dense?[]:{},o={s:{r:2e6,c:2e6},e:{r:0,c:0}},l="",f="",u=e.match(n2);u?(l=e.slice(0,u.index),f=e.slice(u.index+u[0].length)):l=f=e;var d=l.match(jl);d?Us(d[0],c,n,r):(d=l.match(f2))&&x2(d[0],d[1]||"",c,n,r);var x=(l.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(x>0){var g=l.slice(x,x+50).match(s2);g&&t2(c,g[1])}var p=l.match(h2);p&&p[1]&&A2(p[1],n);var m=[];if(t.cellStyles){var _=l.match(c2);_&&k2(m,_)}u&&C2(u[1],c,t,o,i,s);var k=f.match(o2);k&&(c["!autofilter"]=E2(k[0]));var v=[],T=f.match(a2);if(T)for(x=0;x!=T.length;++x)v[x]=We(T[x].slice(T[x].indexOf('"')+1));var b=f.match(i2);b&&w2(c,b,a);var E=f.match(l2);if(E&&(c["!margins"]=y2(De(E[0]))),!c["!ref"]&&o.e.c>=o.s.c&&o.e.r>=o.s.r&&(c["!ref"]=Pe(o)),t.sheetRows>0&&c["!ref"]){var y=We(c["!ref"]);t.sheetRows<=+y.e.r&&(y.e.r=t.sheetRows-1,y.e.r>o.e.r&&(y.e.r=o.e.r),y.e.r<y.s.r&&(y.s.r=y.e.r),y.e.c>o.e.c&&(y.e.c=o.e.c),y.e.c<y.s.c&&(y.s.c=y.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Pe(y))}return m.length>0&&(c["!cols"]=m),v.length>0&&(c["!merges"]=v),c}function d2(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Pe(e[r])+'"/>';return t+"</mergeCells>"}function Us(e,t,r,a){var n=De(e);r.Sheets[a]||(r.Sheets[a]={}),n.codeName&&(r.Sheets[a].CodeName=Ue(Qe(n.codeName)))}function x2(e,t,r,a,n){Us(e.slice(0,e.indexOf(">")),r,a,n)}function p2(e,t,r,a,n){var i=!1,s={},c=null;if(a.bookType!=="xlsx"&&t.vbaraw){var o=t.SheetNames[r];try{t.Workbook&&(o=t.Workbook.Sheets[r].CodeName||o)}catch{}i=!0,s.codeName=kt(Ke(o))}if(e&&e["!outline"]){var l={summaryBelow:1,summaryRight:1};e["!outline"].above&&(l.summaryBelow=0),e["!outline"].left&&(l.summaryRight=0),c=(c||"")+de("outlinePr",null,l)}!i&&!c||(n[n.length]=de("sheetPr",c,s))}var g2=["objects","scenarios","selectLockedCells","selectUnlockedCells"],m2=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function v2(e){var t={sheet:1};return g2.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),m2.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Rs(e.password).toString(16).toUpperCase()),de("sheetProtection",null,t)}function w2(e,t,r){for(var a=Array.isArray(e),n=0;n!=t.length;++n){var i=De(Qe(t[n]),!0);if(!i.ref)return;var s=((r||{})["!id"]||[])[i.id];s?(i.Target=s.Target,i.location&&(i.Target+="#"+Ue(i.location))):(i.Target="#"+Ue(i.location),s={Target:i.Target,TargetMode:"Internal"}),i.Rel=s,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var c=We(i.ref),o=c.s.r;o<=c.e.r;++o)for(var l=c.s.c;l<=c.e.c;++l){var f=be({c:l,r:o});a?(e[o]||(e[o]=[]),e[o][l]||(e[o][l]={t:"z",v:void 0}),e[o][l].l=i):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=i)}}}function y2(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function _2(e){return ra(e),de("pageMargins",null,e)}function k2(e,t){for(var r=!1,a=0;a!=t.length;++a){var n=De(t[a],!0);n.hidden&&(n.hidden=er(n.hidden));var i=parseInt(n.min,10)-1,s=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!r&&n.width&&(r=!0,Bs(n.width)),Vt(n);i<=s;)e[i++]=tr(n)}}function T2(e,t){for(var r=["<cols>"],a,n=0;n!=t.length;++n)(a=t[n])&&(r[r.length]=de("col",null,gi(n,a)));return r[r.length]="</cols>",r.join("")}function E2(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function S2(e,t,r,a){var n=typeof e.ref=="string"?e.ref:Pe(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,s=Yr(n);s.s.r==s.e.r&&(s.e.r=Yr(t["!ref"]).e.r,n=Pe(s));for(var c=0;c<i.length;++c){var o=i[c];if(o.Name=="_xlnm._FilterDatabase"&&o.Sheet==a){o.Ref="'"+r.SheetNames[a]+"'!"+n;break}}return c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+n}),de("autoFilter",null,{ref:n})}var F2=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function A2(e,t){t.Views||(t.Views=[{}]),(e.match(F2)||[]).forEach(function(r,a){var n=De(r);t.Views[a]||(t.Views[a]={}),+n.zoomScale&&(t.Views[a].zoom=+n.zoomScale),er(n.rightToLeft)&&(t.Views[a].RTL=!0)})}function b2(e,t,r,a){var n={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),de("sheetViews",de("sheetView",null,n),{})}function D2(e,t,r,a){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var n="",i=e.t,s=e.v;if(e.t!=="z")switch(e.t){case"b":n=e.v?"1":"0";break;case"n":n=""+e.v;break;case"e":n=Pt[e.v];break;case"d":a&&a.cellDates?n=rr(e.v,-1).toISOString():(e=tr(e),e.t="n",n=""+(e.v=_r(rr(e.v)))),typeof e.z>"u"&&(e.z=Ae[14]);break;default:n=e.v;break}var c=Cr("v",Ke(n)),o={r:t},l=Xt(a.cellXfs,e,a);switch(l!==0&&(o.s=l),e.t){case"n":break;case"d":o.t="d";break;case"b":o.t="b";break;case"e":o.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){c=Cr("v",""+js(a.Strings,e.v,a.revStrings)),o.t="s";break}o.t="str";break}if(e.t!=i&&(e.t=i,e.v=s),typeof e.f=="string"&&e.f){var f=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;c=de("f",Ke(e.f),f)+(e.v!=null?c:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(o.cm=1),de("c",c,o)}var C2=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,i=nn("v"),s=nn("f");return function(o,l,f,u,d,x){for(var g=0,p="",m=[],_=[],k=0,v=0,T=0,b="",E,y,O=0,B=0,j,U,L=0,Y=0,J=Array.isArray(x.CellXf),Q,ce=[],ne=[],Se=Array.isArray(l),V=[],_e={},ge=!1,A=!!f.sheetStubs,M=o.split(t),P=0,D=M.length;P!=D;++P){p=M[P].trim();var W=p.length;if(W!==0){var Z=0;e:for(g=0;g<W;++g)switch(p[g]){case">":if(p[g-1]!="/"){++g;break e}if(f&&f.cellStyles){if(y=De(p.slice(Z,g),!0),O=y.r!=null?parseInt(y.r,10):O+1,B=-1,f.sheetRows&&f.sheetRows<O)continue;_e={},ge=!1,y.ht&&(ge=!0,_e.hpt=parseFloat(y.ht),_e.hpx=Ia(_e.hpt)),y.hidden=="1"&&(ge=!0,_e.hidden=!0),y.outlineLevel!=null&&(ge=!0,_e.level=+y.outlineLevel),ge&&(V[O-1]=_e)}break;case"<":Z=g;break}if(Z>=g)break;if(y=De(p.slice(Z,g),!0),O=y.r!=null?parseInt(y.r,10):O+1,B=-1,!(f.sheetRows&&f.sheetRows<O)){u.s.r>O-1&&(u.s.r=O-1),u.e.r<O-1&&(u.e.r=O-1),f&&f.cellStyles&&(_e={},ge=!1,y.ht&&(ge=!0,_e.hpt=parseFloat(y.ht),_e.hpx=Ia(_e.hpt)),y.hidden=="1"&&(ge=!0,_e.hidden=!0),y.outlineLevel!=null&&(ge=!0,_e.level=+y.outlineLevel),ge&&(V[O-1]=_e)),m=p.slice(g).split(e);for(var se=0;se!=m.length&&m[se].trim().charAt(0)=="<";++se);for(m=m.slice(se),g=0;g!=m.length;++g)if(p=m[g].trim(),p.length!==0){if(_=p.match(r),k=g,v=0,T=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,_!=null&&_.length===2){for(k=0,b=_[1],v=0;v!=b.length&&!((T=b.charCodeAt(v)-64)<1||T>26);++v)k=26*k+T;--k,B=k}else++B;for(v=0;v!=p.length&&p.charCodeAt(v)!==62;++v);if(++v,y=De(p.slice(0,v),!0),y.r||(y.r=be({r:O-1,c:B})),b=p.slice(v),E={t:""},(_=b.match(i))!=null&&_[1]!==""&&(E.v=Ue(_[1])),f.cellFormula){if((_=b.match(s))!=null&&_[1]!==""){if(E.f=Ue(Qe(_[1])).replace(/\r\n/g,`
`),f.xlfn||(E.f=tc(E.f)),_[0].indexOf('t="array"')>-1)E.F=(b.match(n)||[])[1],E.F.indexOf(":")>-1&&ce.push([We(E.F),E.F]);else if(_[0].indexOf('t="shared"')>-1){U=De(_[0]);var ae=Ue(Qe(_[1]));f.xlfn||(ae=tc(ae)),ne[parseInt(U.si,10)]=[U,ae,y.r]}}else(_=b.match(/<f[^>]*\/>/))&&(U=De(_[0]),ne[U.si]&&(E.f=Fm(ne[U.si][1],ne[U.si][2],y.r)));var ee=cr(y.r);for(v=0;v<ce.length;++v)ee.r>=ce[v][0].s.r&&ee.r<=ce[v][0].e.r&&ee.c>=ce[v][0].s.c&&ee.c<=ce[v][0].e.c&&(E.F=ce[v][1])}if(y.t==null&&E.v===void 0)if(E.f||E.F)E.v=0,E.t="n";else if(A)E.t="z";else continue;else E.t=y.t||"n";switch(u.s.c>B&&(u.s.c=B),u.e.c<B&&(u.e.c=B),E.t){case"n":if(E.v==""||E.v==null){if(!A)continue;E.t="z"}else E.v=parseFloat(E.v);break;case"s":if(typeof E.v>"u"){if(!A)continue;E.t="z"}else j=qa[parseInt(E.v,10)],E.v=j.t,E.r=j.r,f.cellHTML&&(E.h=j.h);break;case"str":E.t="s",E.v=E.v!=null?Qe(E.v):"",f.cellHTML&&(E.h=vs(E.v));break;case"inlineStr":_=b.match(a),E.t="s",_!=null&&(j=Is(_[1]))?(E.v=j.t,f.cellHTML&&(E.h=j.h)):E.v="";break;case"b":E.v=er(E.v);break;case"d":f.cellDates?E.v=rr(E.v,1):(E.v=_r(rr(E.v,1)),E.t="n");break;case"e":(!f||f.cellText!==!1)&&(E.w=E.v),E.v=Wo[E.v];break}if(L=Y=0,Q=null,J&&y.s!==void 0&&(Q=x.CellXf[y.s],Q!=null&&(Q.numFmtId!=null&&(L=Q.numFmtId),f.cellStyles&&Q.fillId!=null&&(Y=Q.fillId))),Ml(E,L,Y,f,d,x),f.cellDates&&J&&E.t=="n"&&da(Ae[L])&&(E.t="d",E.v=ui(E.v)),y.cm&&f.xlmeta){var Ee=(f.xlmeta.Cell||[])[+y.cm-1];Ee&&Ee.type=="XLDAPR"&&(E.D=!0)}if(Se){var R=cr(y.r);l[R.r]||(l[R.r]=[]),l[R.r][R.c]=E}else l[y.r]=E}}}}V.length>0&&(l["!rows"]=V)}}();function N2(e,t,r,a){var n=[],i=[],s=We(e["!ref"]),c="",o,l="",f=[],u=0,d=0,x=e["!rows"],g=Array.isArray(e),p={r:l},m,_=-1;for(d=s.s.c;d<=s.e.c;++d)f[d]=sr(d);for(u=s.s.r;u<=s.e.r;++u){for(i=[],l=xr(u),d=s.s.c;d<=s.e.c;++d){o=f[d]+l;var k=g?(e[u]||[])[d]:e[o];k!==void 0&&(c=D2(k,o,e,t))!=null&&i.push(c)}(i.length>0||x&&x[u])&&(p={r:l},x&&x[u]&&(m=x[u],m.hidden&&(p.hidden=1),_=-1,m.hpx?_=un(m.hpx):m.hpt&&(_=m.hpt),_>-1&&(p.ht=_,p.customHeight=1),m.level&&(p.outlineLevel=m.level)),n[n.length]=de("row",i.join(""),p))}if(x)for(;u<x.length;++u)x&&x[u]&&(p={r:u+1},m=x[u],m.hidden&&(p.hidden=1),_=-1,m.hpx?_=un(m.hpx):m.hpt&&(_=m.hpt),_>-1&&(p.ht=_,p.customHeight=1),m.level&&(p.outlineLevel=m.level),n[n.length]=de("row","",p));return n.join("")}function Ul(e,t,r,a){var n=[pr,de("worksheet",null,{xmlns:xa[0],"xmlns:r":wr.r})],i=r.SheetNames[e],s=0,c="",o=r.Sheets[i];o==null&&(o={});var l=o["!ref"]||"A1",f=We(l);if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+l+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),l=Pe(f)}a||(a={}),o["!comments"]=[];var u=[];p2(o,r,e,t,n),n[n.length]=de("dimension",null,{ref:l}),n[n.length]=b2(o,t,e,r),t.sheetFormat&&(n[n.length]=de("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),o["!cols"]!=null&&o["!cols"].length>0&&(n[n.length]=T2(o,o["!cols"])),n[s=n.length]="<sheetData/>",o["!links"]=[],o["!ref"]!=null&&(c=N2(o,t),c.length>0&&(n[n.length]=c)),n.length>s+1&&(n[n.length]="</sheetData>",n[s]=n[s].replace("/>",">")),o["!protect"]&&(n[n.length]=v2(o["!protect"])),o["!autofilter"]!=null&&(n[n.length]=S2(o["!autofilter"],o,r,e)),o["!merges"]!=null&&o["!merges"].length>0&&(n[n.length]=d2(o["!merges"]));var d=-1,x,g=-1;return o["!links"].length>0&&(n[n.length]="<hyperlinks>",o["!links"].forEach(function(p){p[1].Target&&(x={ref:p[0]},p[1].Target.charAt(0)!="#"&&(g=Ye(a,-1,Ke(p[1].Target).replace(/#.*$/,""),je.HLINK),x["r:id"]="rId"+g),(d=p[1].Target.indexOf("#"))>-1&&(x.location=Ke(p[1].Target.slice(d+1))),p[1].Tooltip&&(x.tooltip=Ke(p[1].Tooltip)),n[n.length]=de("hyperlink",null,x))}),n[n.length]="</hyperlinks>"),delete o["!links"],o["!margins"]!=null&&(n[n.length]=_2(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(n[n.length]=Cr("ignoredErrors",de("ignoredError",null,{numberStoredAsText:1,sqref:l}))),u.length>0&&(g=Ye(a,-1,"../drawings/drawing"+(e+1)+".xml",je.DRAW),n[n.length]=de("drawing",null,{"r:id":"rId"+g}),o["!drawing"]=u),o["!comments"].length>0&&(g=Ye(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",je.VML),n[n.length]=de("legacyDrawing",null,{"r:id":"rId"+g}),o["!legacy"]=g),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function I2(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=a,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=n/20),r}function R2(e,t,r){var a=re(145),n=(r["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var i=320;n.hpx?i=un(n.hpx)*20:n.hpt&&(i=n.hpt*20),a.write_shift(2,i),a.write_shift(1,0);var s=0;n.level&&(s|=n.level),n.hidden&&(s|=16),(n.hpx||n.hpt)&&(s|=32),a.write_shift(1,s),a.write_shift(1,0);var c=0,o=a.l;a.l+=4;for(var l={r:e,c:0},f=0;f<16;++f)if(!(t.s.c>f+1<<10||t.e.c<f<<10)){for(var u=-1,d=-1,x=f<<10;x<f+1<<10;++x){l.c=x;var g=Array.isArray(r)?(r[l.r]||[])[l.c]:r[be(l)];g&&(u<0&&(u=x),d=x)}u<0||(++c,a.write_shift(4,u),a.write_shift(4,d))}var p=a.l;return a.l=o,a.write_shift(4,c),a.l=p,a.length>a.l?a.slice(0,a.l):a}function B2(e,t,r,a){var n=R2(a,r,t);(n.length>17||(t["!rows"]||[])[a])&&oe(e,0,n)}var O2=va,P2=Oa;function L2(){}function M2(e,t){var r={},a=e[e.l];return++e.l,r.above=!(a&64),r.left=!(a&128),e.l+=18,r.name=Wd(e),r}function j2(e,t,r){r==null&&(r=re(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),r.write_shift(1,a);for(var n=1;n<3;++n)r.write_shift(1,0);return Zn({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Po(e,r),r.slice(0,r.l)}function U2(e){var t=ut(e);return[t]}function W2(e,t,r){return r==null&&(r=re(8)),pa(t,r)}function V2(e){var t=ga(e);return[t]}function H2(e,t,r){return r==null&&(r=re(4)),ma(t,r)}function $2(e){var t=ut(e),r=e.read_shift(1);return[t,r,"b"]}function G2(e,t,r){return r==null&&(r=re(9)),pa(t,r),r.write_shift(1,e.v?1:0),r}function z2(e){var t=ga(e),r=e.read_shift(1);return[t,r,"b"]}function X2(e,t,r){return r==null&&(r=re(5)),ma(t,r),r.write_shift(1,e.v?1:0),r}function Y2(e){var t=ut(e),r=e.read_shift(1);return[t,r,"e"]}function K2(e,t,r){return r==null&&(r=re(9)),pa(t,r),r.write_shift(1,e.v),r}function Q2(e){var t=ga(e),r=e.read_shift(1);return[t,r,"e"]}function q2(e,t,r){return r==null&&(r=re(8)),ma(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function J2(e){var t=ut(e),r=e.read_shift(4);return[t,r,"s"]}function Z2(e,t,r){return r==null&&(r=re(12)),pa(t,r),r.write_shift(4,t.v),r}function ew(e){var t=ga(e),r=e.read_shift(4);return[t,r,"s"]}function rw(e,t,r){return r==null&&(r=re(8)),ma(t,r),r.write_shift(4,t.v),r}function tw(e){var t=ut(e),r=Lr(e);return[t,r,"n"]}function aw(e,t,r){return r==null&&(r=re(16)),pa(t,r),ca(e.v,r),r}function Wl(e){var t=ga(e),r=Lr(e);return[t,r,"n"]}function nw(e,t,r){return r==null&&(r=re(12)),ma(t,r),ca(e.v,r),r}function iw(e){var t=ut(e),r=As(e);return[t,r,"n"]}function sw(e,t,r){return r==null&&(r=re(12)),pa(t,r),Lo(e.v,r),r}function cw(e){var t=ga(e),r=As(e);return[t,r,"n"]}function ow(e,t,r){return r==null&&(r=re(8)),ma(t,r),Lo(e.v,r),r}function lw(e){var t=ut(e),r=Es(e);return[t,r,"is"]}function fw(e){var t=ut(e),r=Mr(e);return[t,r,"str"]}function hw(e,t,r){return r==null&&(r=re(12+4*e.v.length)),pa(t,r),Ar(e.v,r),r.length>r.l?r.slice(0,r.l):r}function uw(e){var t=ga(e),r=Mr(e);return[t,r,"str"]}function dw(e,t,r){return r==null&&(r=re(8+4*e.v.length)),ma(t,r),Ar(e.v,r),r.length>r.l?r.slice(0,r.l):r}function xw(e,t,r){var a=e.l+t,n=ut(e);n.r=r["!row"];var i=e.read_shift(1),s=[n,i,"b"];if(r.cellFormula){e.l+=2;var c=pi(e,a-e.l,r);s[3]=Or(c,null,n,r.supbooks,r)}else e.l=a;return s}function pw(e,t,r){var a=e.l+t,n=ut(e);n.r=r["!row"];var i=e.read_shift(1),s=[n,i,"e"];if(r.cellFormula){e.l+=2;var c=pi(e,a-e.l,r);s[3]=Or(c,null,n,r.supbooks,r)}else e.l=a;return s}function gw(e,t,r){var a=e.l+t,n=ut(e);n.r=r["!row"];var i=Lr(e),s=[n,i,"n"];if(r.cellFormula){e.l+=2;var c=pi(e,a-e.l,r);s[3]=Or(c,null,n,r.supbooks,r)}else e.l=a;return s}function mw(e,t,r){var a=e.l+t,n=ut(e);n.r=r["!row"];var i=Mr(e),s=[n,i,"str"];if(r.cellFormula){e.l+=2;var c=pi(e,a-e.l,r);s[3]=Or(c,null,n,r.supbooks,r)}else e.l=a;return s}var vw=va,ww=Oa;function yw(e,t){return t==null&&(t=re(4)),t.write_shift(4,e),t}function _w(e,t){var r=e.l+t,a=va(e),n=Ss(e),i=Mr(e),s=Mr(e),c=Mr(e);e.l=r;var o={rfx:a,relId:n,loc:i,display:c};return s&&(o.Tooltip=s),o}function kw(e,t){var r=re(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Oa({s:cr(e[0]),e:cr(e[0])},r),Fs("rId"+t,r);var a=e[1].Target.indexOf("#"),n=a==-1?"":e[1].Target.slice(a+1);return Ar(n||"",r),Ar(e[1].Tooltip||"",r),Ar("",r),r.slice(0,r.l)}function Tw(){}function Ew(e,t,r){var a=e.l+t,n=Mo(e),i=e.read_shift(1),s=[n];if(s[2]=i,r.cellFormula){var c=Yv(e,a-e.l,r);s[1]=c}else e.l=a;return s}function Sw(e,t,r){var a=e.l+t,n=va(e),i=[n];if(r.cellFormula){var s=Qv(e,a-e.l,r);i[1]=s,e.l=a}else e.l=a;return i}function Fw(e,t,r){r==null&&(r=re(18));var a=gi(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var n=0;return t.hidden&&(n|=1),typeof a.width=="number"&&(n|=2),t.level&&(n|=t.level<<8),r.write_shift(2,n),r}var Vl=["left","right","top","bottom","header","footer"];function Aw(e){var t={};return Vl.forEach(function(r){t[r]=Lr(e)}),t}function bw(e,t){return t==null&&(t=re(6*8)),ra(e),Vl.forEach(function(r){ca(e[r],t)}),t}function Dw(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function Cw(e,t,r){r==null&&(r=re(30));var a=924;return(((t||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Nw(e){var t=re(24);return t.write_shift(4,4),t.write_shift(4,1),Oa(e,t),t}function Iw(e,t){return t==null&&(t=re(16*4+2)),t.write_shift(2,e.password?Rs(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function Rw(){}function Bw(){}function Ow(e,t,r,a,n,i,s){if(!e)return e;var c=t||{};a||(a={"!id":{}});var o=c.dense?[]:{},l,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},u=!1,d=!1,x,g,p,m,_,k,v,T,b,E=[];c.biff=12,c["!row"]=0;var y=0,O=!1,B=[],j={},U=c.supbooks||n.supbooks||[[]];if(U.sharedf=j,U.arrayf=B,U.SheetNames=n.SheetNames||n.Sheets.map(function(Se){return Se.name}),!c.supbooks&&(c.supbooks=U,n.Names))for(var L=0;L<n.Names.length;++L)U[0][L+1]=n.Names[L];var Y=[],J=[],Q=!1;dn[16]={n:"BrtShortReal",f:Wl};var ce;if(Ot(e,function(V,_e,ge){if(!d)switch(ge){case 148:l=V;break;case 0:x=V,c.sheetRows&&c.sheetRows<=x.r&&(d=!0),T=xr(m=x.r),c["!row"]=x.r,(V.hidden||V.hpt||V.level!=null)&&(V.hpt&&(V.hpx=Ia(V.hpt)),J[V.r]=V);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:V[2]},V[2]){case"n":g.v=V[1];break;case"s":v=qa[V[1]],g.v=v.t,g.r=v.r;break;case"b":g.v=!!V[1];break;case"e":g.v=V[1],c.cellText!==!1&&(g.w=Pt[g.v]);break;case"str":g.t="s",g.v=V[1];break;case"is":g.t="s",g.v=V[1].t;break}if((p=s.CellXf[V[0].iStyleRef])&&Ml(g,p.numFmtId,null,c,i,s),_=V[0].c==-1?_+1:V[0].c,c.dense?(o[m]||(o[m]=[]),o[m][_]=g):o[sr(_)+T]=g,c.cellFormula){for(O=!1,y=0;y<B.length;++y){var A=B[y];x.r>=A[0].s.r&&x.r<=A[0].e.r&&_>=A[0].s.c&&_<=A[0].e.c&&(g.F=Pe(A[0]),O=!0)}!O&&V.length>3&&(g.f=V[3])}if(f.s.r>x.r&&(f.s.r=x.r),f.s.c>_&&(f.s.c=_),f.e.r<x.r&&(f.e.r=x.r),f.e.c<_&&(f.e.c=_),c.cellDates&&p&&g.t=="n"&&da(Ae[p.numFmtId])){var M=jt(g.v);M&&(g.t="d",g.v=new Date(M.y,M.m-1,M.d,M.H,M.M,M.S,M.u))}ce&&(ce.type=="XLDAPR"&&(g.D=!0),ce=void 0);break;case 1:case 12:if(!c.sheetStubs||u)break;g={t:"z",v:void 0},_=V[0].c==-1?_+1:V[0].c,c.dense?(o[m]||(o[m]=[]),o[m][_]=g):o[sr(_)+T]=g,f.s.r>x.r&&(f.s.r=x.r),f.s.c>_&&(f.s.c=_),f.e.r<x.r&&(f.e.r=x.r),f.e.c<_&&(f.e.c=_),ce&&(ce.type=="XLDAPR"&&(g.D=!0),ce=void 0);break;case 176:E.push(V);break;case 49:ce=((c.xlmeta||{}).Cell||[])[V-1];break;case 494:var P=a["!id"][V.relId];for(P?(V.Target=P.Target,V.loc&&(V.Target+="#"+V.loc),V.Rel=P):V.relId==""&&(V.Target="#"+V.loc),m=V.rfx.s.r;m<=V.rfx.e.r;++m)for(_=V.rfx.s.c;_<=V.rfx.e.c;++_)c.dense?(o[m]||(o[m]=[]),o[m][_]||(o[m][_]={t:"z",v:void 0}),o[m][_].l=V):(k=be({c:_,r:m}),o[k]||(o[k]={t:"z",v:void 0}),o[k].l=V);break;case 426:if(!c.cellFormula)break;B.push(V),b=c.dense?o[m][_]:o[sr(_)+T],b.f=Or(V[1],f,{r:x.r,c:_},U,c),b.F=Pe(V[0]);break;case 427:if(!c.cellFormula)break;j[be(V[0].s)]=V[1],b=c.dense?o[m][_]:o[sr(_)+T],b.f=Or(V[1],f,{r:x.r,c:_},U,c);break;case 60:if(!c.cellStyles)break;for(;V.e>=V.s;)Y[V.e--]={width:V.w/256,hidden:!!(V.flags&1),level:V.level},Q||(Q=!0,Bs(V.w/256)),Vt(Y[V.e+1]);break;case 161:o["!autofilter"]={ref:Pe(V)};break;case 476:o["!margins"]=V;break;case 147:n.Sheets[r]||(n.Sheets[r]={}),V.name&&(n.Sheets[r].CodeName=V.name),(V.above||V.left)&&(o["!outline"]={above:V.above,left:V.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),V.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:u=!0;break;case 36:u=!1;break;case 37:u=!0;break;case 38:u=!1;break;default:if(!_e.T){if(!u||c.WTF)throw new Error("Unexpected record 0x"+ge.toString(16))}}},c),delete c.supbooks,delete c["!row"],!o["!ref"]&&(f.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(o["!ref"]=Pe(l||f)),c.sheetRows&&o["!ref"]){var ne=We(o["!ref"]);c.sheetRows<=+ne.e.r&&(ne.e.r=c.sheetRows-1,ne.e.r>f.e.r&&(ne.e.r=f.e.r),ne.e.r<ne.s.r&&(ne.s.r=ne.e.r),ne.e.c>f.e.c&&(ne.e.c=f.e.c),ne.e.c<ne.s.c&&(ne.s.c=ne.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Pe(ne))}return E.length>0&&(o["!merges"]=E),Y.length>0&&(o["!cols"]=Y),J.length>0&&(o["!rows"]=J),o}function Pw(e,t,r,a,n,i,s){if(t.v===void 0)return!1;var c="";switch(t.t){case"b":c=t.v?"1":"0";break;case"d":t=tr(t),t.z=t.z||Ae[14],t.v=_r(rr(t.v)),t.t="n";break;case"n":case"e":c=""+t.v;break;default:c=t.v;break}var o={r,c:a};switch(o.s=Xt(n.cellXfs,t,n),t.l&&i["!links"].push([be(o),t.l]),t.c&&i["!comments"].push([be(o),t.c]),t.t){case"s":case"str":return n.bookSST?(c=js(n.Strings,t.v,n.revStrings),o.t="s",o.v=c,s?oe(e,18,rw(t,o)):oe(e,7,Z2(t,o))):(o.t="str",s?oe(e,17,dw(t,o)):oe(e,6,hw(t,o))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?s?oe(e,13,ow(t,o)):oe(e,2,sw(t,o)):s?oe(e,16,nw(t,o)):oe(e,5,aw(t,o)),!0;case"b":return o.t="b",s?oe(e,15,X2(t,o)):oe(e,4,G2(t,o)),!0;case"e":return o.t="e",s?oe(e,14,q2(t,o)):oe(e,3,K2(t,o)),!0}return s?oe(e,12,H2(t,o)):oe(e,1,W2(t,o)),!0}function Lw(e,t,r,a){var n=We(t["!ref"]||"A1"),i,s="",c=[];oe(e,145);var o=Array.isArray(t),l=n.e.r;t["!rows"]&&(l=Math.max(n.e.r,t["!rows"].length-1));for(var f=n.s.r;f<=l;++f){s=xr(f),B2(e,t,n,f);var u=!1;if(f<=n.e.r)for(var d=n.s.c;d<=n.e.c;++d){f===n.s.r&&(c[d]=sr(d)),i=c[d]+s;var x=o?(t[f]||[])[d]:t[i];if(!x){u=!1;continue}u=Pw(e,x,f,d,a,t,u)}}oe(e,146)}function Mw(e,t){!t||!t["!merges"]||(oe(e,177,yw(t["!merges"].length)),t["!merges"].forEach(function(r){oe(e,176,ww(r))}),oe(e,178))}function jw(e,t){!t||!t["!cols"]||(oe(e,390),t["!cols"].forEach(function(r,a){r&&oe(e,60,Fw(a,r))}),oe(e,391))}function Uw(e,t){!t||!t["!ref"]||(oe(e,648),oe(e,649,Nw(We(t["!ref"]))),oe(e,650))}function Ww(e,t,r){t["!links"].forEach(function(a){if(a[1].Target){var n=Ye(r,-1,a[1].Target.replace(/#.*$/,""),je.HLINK);oe(e,494,kw(a,n))}}),delete t["!links"]}function Vw(e,t,r,a){if(t["!comments"].length>0){var n=Ye(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",je.VML);oe(e,551,Fs("rId"+n)),t["!legacy"]=n}}function Hw(e,t,r,a){if(t["!autofilter"]){var n=t["!autofilter"],i=typeof n.ref=="string"?n.ref:Pe(n.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,c=Yr(i);c.s.r==c.e.r&&(c.e.r=Yr(t["!ref"]).e.r,i=Pe(c));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==a){l.Ref="'"+r.SheetNames[a]+"'!"+i;break}}o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+i}),oe(e,161,Oa(We(i))),oe(e,162)}}function $w(e,t,r){oe(e,133),oe(e,137,Cw(t,r)),oe(e,138),oe(e,134)}function Gw(e,t){t["!protect"]&&oe(e,535,Iw(t["!protect"]))}function zw(e,t,r,a){var n=Xr(),i=r.SheetNames[e],s=r.Sheets[i]||{},c=i;try{r&&r.Workbook&&(c=r.Workbook.Sheets[e].CodeName||c)}catch{}var o=We(s["!ref"]||"A1");if(o.e.c>16383||o.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");o.e.c=Math.min(o.e.c,16383),o.e.r=Math.min(o.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],oe(n,129),(r.vbaraw||s["!outline"])&&oe(n,147,j2(c,s["!outline"])),oe(n,148,P2(o)),$w(n,s,r.Workbook),jw(n,s),Lw(n,s,e,t),Gw(n,s),Hw(n,s,r,e),Mw(n,s),Ww(n,s,a),s["!margins"]&&oe(n,476,bw(s["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&Uw(n,s),Vw(n,s,e,a),oe(n,130),n.end()}function Xw(e){var t=[],r=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var s=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(t[+s[1]]=r?+s[2]:s[2])});var n=Ue((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){a=i.replace(/<.*?>/g,"")}),[t,n,a]}function Yw(e,t,r,a,n,i){var s=i||{"!type":"chart"};if(!e)return i;var c=0,o=0,l="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(u){var d=Xw(u);f.s.r=f.s.c=0,f.e.c=c,l=sr(c),d[0].forEach(function(x,g){s[l+xr(g)]={t:"n",v:x,z:d[1]},o=g}),f.e.r<o&&(f.e.r=o),++c}),c>0&&(s["!ref"]=Pe(f)),s}function Kw(e,t,r,a,n){if(!e)return e;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s,c=e.match(jl);return c&&Us(c[0],i,n,r),(s=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=s[1]),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}function Qw(e,t){e.l+=10;var r=Mr(e);return{name:r}}function qw(e,t,r,a,n){if(!e)return e;a||(a={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},s=!1;return Ot(e,function(o,l,f){switch(f){case 550:i["!rel"]=o;break;case 651:n.Sheets[r]||(n.Sheets[r]={}),o.name&&(n.Sheets[r].CodeName=o.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!(l.T>0)){if(!(l.T<0)){if(!s||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},t),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}var Ws=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Jw=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Zw=[],ey=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function cc(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],n=0;n!=t.length;++n){var i=t[n];if(a[i[0]]==null)a[i[0]]=i[1];else switch(i[2]){case"bool":typeof a[i[0]]=="string"&&(a[i[0]]=er(a[i[0]]));break;case"int":typeof a[i[0]]=="string"&&(a[i[0]]=parseInt(a[i[0]],10));break}}}function oc(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=er(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function Hl(e){oc(e.WBProps,Ws),oc(e.CalcPr,ey),cc(e.WBView,Jw),cc(e.Sheets,Zw),Da.date1904=er(e.WBProps.date1904)}function ry(e){return!e.Workbook||!e.Workbook.WBProps?"false":er(e.Workbook.WBProps.date1904)?"true":"false"}var ty="][*?/\\".split("");function $l(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return ty.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function ay(e,t,r){e.forEach(function(a,n){$l(a);for(var i=0;i<n;++i)if(a==e[i])throw new Error("Duplicate Sheet Name: "+a);if(r){var s=t&&t[n]&&t[n].CodeName||a;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function ny(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];ay(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)r2(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var iy=/<\w+:workbook/;function sy(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,n="xmlns",i={},s=0;if(e.replace(Ur,function(o,l){var f=De(o);switch(St(f[0])){case"<?xml":break;case"<workbook":o.match(iy)&&(n="xmlns"+o.match(/<(\w+):/)[1]),r.xmlns=f[n];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Ws.forEach(function(u){if(f[u[0]]!=null)switch(u[2]){case"bool":r.WBProps[u[0]]=er(f[u[0]]);break;case"int":r.WBProps[u[0]]=parseInt(f[u[0]],10);break;default:r.WBProps[u[0]]=f[u[0]]}}),f.codeName&&(r.WBProps.CodeName=Qe(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=Ue(Qe(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":i={},i.Name=Qe(f.name),f.comment&&(i.Comment=f.comment),f.localSheetId&&(i.Sheet=+f.localSheetId),er(f.hidden||"0")&&(i.Hidden=!0),s=l+o.length;break;case"</definedName>":i.Ref=Ue(Qe(e.slice(s,l))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&t.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return o}),xa.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return Hl(r),r}function Gl(e){var t=[pr];t[t.length]=de("workbook",null,{xmlns:xa[0],"xmlns:r":wr.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Ws.forEach(function(c){e.Workbook.WBProps[c[0]]!=null&&e.Workbook.WBProps[c[0]]!=c[1]&&(a[c[0]]=e.Workbook.WBProps[c[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=de("workbookPr",null,a);var n=e.Workbook&&e.Workbook.Sheets||[],i=0;if(n&&n[0]&&n[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!n[i]||!n[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var s={name:Ke(e.SheetNames[i].slice(0,31))};if(s.sheetId=""+(i+1),s["r:id"]="rId"+(i+1),n[i])switch(n[i].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}t[t.length]=de("sheet",null,s)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(c){var o={name:c.Name};c.Comment&&(o.comment=c.Comment),c.Sheet!=null&&(o.localSheetId=""+c.Sheet),c.Hidden&&(o.hidden="1"),c.Ref&&(t[t.length]=de("definedName",Ke(c.Ref),o))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function cy(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=$i(e),r.name=Mr(e),r}function oy(e,t){return t||(t=re(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Fs(e.strRelID,t),Ar(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function ly(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var n=t>8?Mr(e):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function fy(e,t){t||(t=re(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),Po(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function hy(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function uy(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var n=e.read_shift(4),i=Vd(e),s=Kv(e,0,r),c=Ss(e);e.l=a;var o={Name:i,Ptg:s};return n<268435455&&(o.Sheet=n),c&&(o.Comment=c),o}function dy(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],n=!1;t||(t={}),t.biff=12;var i=[],s=[[]];return s.SheetNames=[],s.XTI=[],dn[16]={n:"BrtFRTArchID$",f:hy},Ot(e,function(o,l,f){switch(f){case 156:s.SheetNames.push(o.name),r.Sheets.push(o);break;case 153:r.WBProps=o;break;case 39:o.Sheet!=null&&(t.SID=o.Sheet),o.Ref=Or(o.Ptg,null,null,s,t),delete t.SID,delete o.Ptg,i.push(o);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([f,o]):s[0]=[f,o],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(o),s.XTI=s.XTI.concat(o);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(f),n=!0;break;case 36:a.pop(),n=!1;break;case 37:a.push(f),n=!0;break;case 38:a.pop(),n=!1;break;case 16:break;default:if(!l.T){if(!n||t.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},t),Hl(r),r.Names=i,r.supbooks=s,r}function xy(e,t){oe(e,143);for(var r=0;r!=t.SheetNames.length;++r){var a=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,n={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};oe(e,156,oy(n))}oe(e,144)}function py(e,t){t||(t=re(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Ar("SheetJS",t),Ar(zn.version,t),Ar(zn.version,t),Ar("7262",t),t.length>t.l?t.slice(0,t.l):t}function gy(e,t){t||(t=re(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function my(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,a=0,n=-1,i=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&n==-1?n=a:r[a].Hidden==1&&i==-1&&(i=a);i>n||(oe(e,135),oe(e,158,gy(n)),oe(e,136))}}function vy(e,t){var r=Xr();return oe(r,131),oe(r,128,py()),oe(r,153,fy(e.Workbook&&e.Workbook.WBProps||null)),my(r,e),xy(r,e),oe(r,132),r.end()}function wy(e,t,r){return t.slice(-4)===".bin"?dy(e,r):sy(e,r)}function yy(e,t,r,a,n,i,s,c){return t.slice(-4)===".bin"?Ow(e,a,r,n,i,s,c):u2(e,a,r,n,i,s,c)}function _y(e,t,r,a,n,i,s,c){return t.slice(-4)===".bin"?qw(e,a,r,n,i):Kw(e,a,r,n,i)}function ky(e,t,r,a,n,i,s,c){return t.slice(-4)===".bin"?Em():Sm()}function Ty(e,t,r,a,n,i,s,c){return t.slice(-4)===".bin"?km():Tm()}function Ey(e,t,r,a){return t.slice(-4)===".bin"?wg(e,r,a):cg(e,r,a)}function Sy(e,t,r){return Sl(e,r)}function Fy(e,t,r){return t.slice(-4)===".bin"?Fp(e,r):Tp(e,r)}function Ay(e,t,r){return t.slice(-4)===".bin"?mm(e,r):om(e,r)}function by(e,t,r){return t.slice(-4)===".bin"?im(e):am(e)}function Dy(e,t,r,a){return r.slice(-4)===".bin"?sm(e,t,r,a):void 0}function Cy(e,t,r){return t.slice(-4)===".bin"?em(e,t,r):tm(e,t,r)}function Ny(e,t,r){return(t.slice(-4)===".bin"?vy:Gl)(e)}function Iy(e,t,r,a,n){return(t.slice(-4)===".bin"?zw:Ul)(e,r,a,n)}function Ry(e,t,r){return(t.slice(-4)===".bin"?Dg:Tl)(e,r)}function By(e,t,r){return(t.slice(-4)===".bin"?Dp:pl)(e,r)}function Oy(e,t,r){return(t.slice(-4)===".bin"?vm:bl)(e)}function Py(e){return(e.slice(-4)===".bin"?rm:Fl)()}var zl=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Xl=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function dt(e,t){var r=e.split(/\s+/),a=[];if(a[0]=r[0],r.length===1)return a;var n=e.match(zl),i,s,c,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(Xl),(s=i[1].indexOf(":"))===-1?a[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?c="xmlns"+i[1].slice(6):c=i[1].slice(s+1),a[c]=i[2].slice(1,i[2].length-1));return a}function Ly(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var a=e.match(zl),n,i,s,c;if(a)for(c=0;c!=a.length;++c)n=a[c].match(Xl),(i=n[1].indexOf(":"))===-1?r[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?s="xmlns"+n[1].slice(6):s=n[1].slice(i+1),r[s]=n[2].slice(1,n[2].length-1));return r}var Za;function My(e,t){var r=Za[e]||Ue(e);return r==="General"?ia(t):nt(r,t)}function jy(e,t,r,a){var n=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=er(a);break;case"i2":case"int":n=parseInt(a,10);break;case"r4":case"float":n=parseFloat(a);break;case"date":case"dateTime.tz":n=rr(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Ue(t)]=n}function Uy(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Pt[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=an(e.v):e.w=ia(e.v):e.w=My(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var a=Za[t]||t||"General";if(r.cellNF&&(e.z=a),r.cellDates&&e.t=="n"&&da(a)){var n=jt(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(i){if(r.WTF)throw i}}}function Wy(e,t,r){if(r.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=Zp[a.Pattern]||a.Pattern)}e[t.ID]=t}function Vy(e,t,r,a,n,i,s,c,o,l){var f="General",u=a.StyleID,d={};l=l||{};var x=[],g=0;for(u===void 0&&c&&(u=c.StyleID),u===void 0&&s&&(u=s.StyleID);i[u]!==void 0&&(i[u].nf&&(f=i[u].nf),i[u].Interior&&x.push(i[u].Interior),!!i[u].Parent);)u=i[u].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=er(e);break;case"String":a.t="s",a.r=S0(Ue(e)),a.v=e.indexOf("<")>-1?Ue(t||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(rr(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),a.v!==a.v?a.v=Ue(e):a.v<60&&(a.v=a.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=Wo[e],l.cellText!==!1&&(a.w=e);break;default:e==""&&t==""?a.t="z":(a.t="s",a.v=S0(t||e));break}if(Uy(a,f,l),l.cellFormula!==!1)if(a.Formula){var p=Ue(a.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),a.f=ba(p,n),delete a.Formula,a.ArrayRange=="RC"?a.F=ba("RC:RC",n):a.ArrayRange&&(a.F=ba(a.ArrayRange,n),o.push([We(a.F),a.F]))}else for(g=0;g<o.length;++g)n.r>=o[g][0].s.r&&n.r<=o[g][0].e.r&&n.c>=o[g][0].s.c&&n.c<=o[g][0].e.c&&(a.F=o[g][1]);l.cellStyles&&(x.forEach(function(m){!d.patternType&&m.patternType&&(d.patternType=m.patternType)}),a.s=d),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function Hy(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Ii(e,t){var r=t||{};Ra();var a=$a(ws(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(a=Qe(a));var n=a.slice(0,1024).toLowerCase(),i=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var s=tr(r);return s.type="string",Na.to_workbook(a,s)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(H){n.indexOf("<"+H)>=0&&(i=!0)}),i)return b_(a,r);Za={"General Number":"General","General Date":Ae[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ae[15],"Short Date":Ae[14],"Long Time":Ae[19],"Medium Time":Ae[18],"Short Time":Ae[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ae[2],Standard:Ae[4],Percent:Ae[10],Scientific:Ae[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,o=[],l,f={},u=[],d=r.dense?[]:{},x="",g={},p={},m=dt('<Data ss:Type="String">'),_=0,k=0,v=0,T={s:{r:2e6,c:2e6},e:{r:0,c:0}},b={},E={},y="",O=0,B=[],j={},U={},L=0,Y=[],J=[],Q={},ce=[],ne,Se=!1,V=[],_e=[],ge={},A=0,M=0,P={Sheets:[],WBProps:{date1904:!1}},D={};cn.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var W="";c=cn.exec(a);)switch(c[3]=(W=c[3]).toLowerCase()){case"data":if(W=="data"){if(c[1]==="/"){if((l=o.pop())[0]!==c[3])throw new Error("Bad state: "+l.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&o.push([c[3],!0]);break}if(o[o.length-1][1])break;c[1]==="/"?Vy(a.slice(_,c.index),y,m,o[o.length-1][0]=="comment"?Q:g,{c:k,r:v},b,ce[k],p,V,r):(y="",m=dt(c[0]),_=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(J.length>0&&(g.c=J),(!r.sheetRows||r.sheetRows>v)&&g.v!==void 0&&(r.dense?(d[v]||(d[v]=[]),d[v][k]=g):d[sr(k)+xr(v)]=g),g.HRef&&(g.l={Target:Ue(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(A=k+(parseInt(g.MergeAcross,10)|0),M=v+(parseInt(g.MergeDown,10)|0),B.push({s:{c:k,r:v},e:{c:A,r:M}})),!r.sheetStubs)g.MergeAcross?k=A+1:++k;else if(g.MergeAcross||g.MergeDown){for(var Z=k;Z<=A;++Z)for(var se=v;se<=M;++se)(Z>k||se>v)&&(r.dense?(d[se]||(d[se]=[]),d[se][Z]={t:"z"}):d[sr(Z)+xr(se)]={t:"z"});k=A+1}else++k;else g=Ly(c[0]),g.Index&&(k=+g.Index-1),k<T.s.c&&(T.s.c=k),k>T.e.c&&(T.e.c=k),c[0].slice(-2)==="/>"&&++k,J=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(v<T.s.r&&(T.s.r=v),v>T.e.r&&(T.e.r=v),c[0].slice(-2)==="/>"&&(p=dt(c[0]),p.Index&&(v=+p.Index-1)),k=0,++v):(p=dt(c[0]),p.Index&&(v=+p.Index-1),ge={},(p.AutoFitHeight=="0"||p.Height)&&(ge.hpx=parseInt(p.Height,10),ge.hpt=un(ge.hpx),_e[v]=ge),p.Hidden=="1"&&(ge.hidden=!0,_e[v]=ge));break;case"worksheet":if(c[1]==="/"){if((l=o.pop())[0]!==c[3])throw new Error("Bad state: "+l.join("|"));u.push(x),T.s.r<=T.e.r&&T.s.c<=T.e.c&&(d["!ref"]=Pe(T),r.sheetRows&&r.sheetRows<=T.e.r&&(d["!fullref"]=d["!ref"],T.e.r=r.sheetRows-1,d["!ref"]=Pe(T))),B.length&&(d["!merges"]=B),ce.length>0&&(d["!cols"]=ce),_e.length>0&&(d["!rows"]=_e),f[x]=d}else T={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=k=0,o.push([c[3],!1]),l=dt(c[0]),x=Ue(l.Name),d=r.dense?[]:{},B=[],V=[],_e=[],D={name:x,Hidden:0},P.Sheets.push(D);break;case"table":if(c[1]==="/"){if((l=o.pop())[0]!==c[3])throw new Error("Bad state: "+l.join("|"))}else{if(c[0].slice(-2)=="/>")break;o.push([c[3],!1]),ce=[],Se=!1}break;case"style":c[1]==="/"?Wy(b,E,r):E=dt(c[0]);break;case"numberformat":E.nf=Ue(dt(c[0]).Format||"General"),Za[E.nf]&&(E.nf=Za[E.nf]);for(var ae=0;ae!=392&&Ae[ae]!=E.nf;++ae);if(ae==392){for(ae=57;ae!=392;++ae)if(Ae[ae]==null){Tt(E.nf,ae);break}}break;case"column":if(o[o.length-1][0]!=="table")break;if(ne=dt(c[0]),ne.Hidden&&(ne.hidden=!0,delete ne.Hidden),ne.Width&&(ne.wpx=parseInt(ne.Width,10)),!Se&&ne.wpx>10){Se=!0,Pr=_l;for(var ee=0;ee<ce.length;++ee)ce[ee]&&Vt(ce[ee])}Se&&Vt(ne),ce[ne.Index-1||ce.length]=ne;for(var Ee=0;Ee<+ne.Span;++Ee)ce[ce.length]=tr(ne);break;case"namedrange":if(c[1]==="/")break;P.Names||(P.Names=[]);var R=De(c[0]),q={Name:R.Name,Ref:ba(R.RefersTo.slice(1),{r:0,c:0})};P.Sheets.length>0&&(q.Sheet=P.Sheets.length-1),P.Names.push(q);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?y+=a.slice(O,c.index):O=c.index+c[0].length;break;case"interior":if(!r.cellStyles)break;E.Interior=dt(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?d1(j,W,a.slice(L,c.index)):L=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((l=o.pop())[0]!==c[3])throw new Error("Bad state: "+l.join("|"))}else o.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((l=o.pop())[0]!==c[3])throw new Error("Bad state: "+l.join("|"));Hy(Q),J.push(Q)}else o.push([c[3],!1]),l=dt(c[0]),Q={a:l.Author};break;case"autofilter":if(c[1]==="/"){if((l=o.pop())[0]!==c[3])throw new Error("Bad state: "+l.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var le=dt(c[0]);d["!autofilter"]={ref:ba(le.Range).replace(/\$/g,"")},o.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((l=o.pop())[0]!==c[3])throw new Error("Bad state: "+l.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&o.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((l=o.pop())[0]!==c[3])throw new Error("Bad state: "+l.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&o.push([c[3],!0]);break;case"null":break;default:if(o.length==0&&c[3]=="document"||o.length==0&&c[3]=="uof")return dc(a,r);var ve=!0;switch(o[o.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ve=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ve=!1}break;case"excelworkbook":switch(c[3]){case"date1904":P.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ve=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:ve=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(a.slice(L,c.index)){case"SheetHidden":D.Hidden=1;break;case"SheetVeryHidden":D.Hidden=2;break}else L=c.index+c[0].length;break;case"header":d["!margins"]||ra(d["!margins"]={},"xlml"),isNaN(+De(c[0]).Margin)||(d["!margins"].header=+De(c[0]).Margin);break;case"footer":d["!margins"]||ra(d["!margins"]={},"xlml"),isNaN(+De(c[0]).Margin)||(d["!margins"].footer=+De(c[0]).Margin);break;case"pagemargins":var Te=De(c[0]);d["!margins"]||ra(d["!margins"]={},"xlml"),isNaN(+Te.Top)||(d["!margins"].top=+Te.Top),isNaN(+Te.Left)||(d["!margins"].left=+Te.Left),isNaN(+Te.Right)||(d["!margins"].right=+Te.Right),isNaN(+Te.Bottom)||(d["!margins"].bottom=+Te.Bottom);break;case"displayrighttoleft":P.Views||(P.Views=[]),P.Views[0]||(P.Views[0]={}),P.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ve=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ve=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ve=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ve=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ve=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ve=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ve=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ve=!1}break;case"smarttags":break;default:ve=!1;break}if(ve||c[3].match(/!\[CDATA/))break;if(!o[o.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+o.join("|");if(o[o.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?jy(U,W,Y,a.slice(L,c.index)):(Y=c,L=c.index+c[0].length);break}if(r.WTF)throw"Unrecognized tag: "+c[3]+"|"+o.join("|")}var fe={};return!r.bookSheets&&!r.bookProps&&(fe.Sheets=f),fe.SheetNames=u,fe.Workbook=P,fe.SSF=tr(Ae),fe.Props=j,fe.Custprops=U,fe}function qi(e,t){switch(Hs(t=t||{}),t.type||"base64"){case"base64":return Ii(at(e),t);case"binary":case"buffer":case"file":return Ii(e,t);case"array":return Ii(Gt(e),t)}}function $y(e,t){var r=[];return e.Props&&r.push(x1(e.Props,t)),e.Custprops&&r.push(p1(e.Props,e.Custprops)),r.join("")}function Gy(){return""}function zy(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(a,n){var i=[];i.push(de("NumberFormat",null,{"ss:Format":Ke(Ae[a.numFmtId])}));var s={"ss:ID":"s"+(21+n)};r.push(de("Style",i.join(""),s))}),de("Styles",r.join(""))}function Yl(e){return de("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Ls(e.Ref,{r:0,c:0})})}function Xy(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],a=0;a<t.length;++a){var n=t[a];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||r.push(Yl(n)))}return de("Names",r.join(""))}function Yy(e,t,r,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var n=a.Workbook.Names,i=[],s=0;s<n.length;++s){var c=n[s];c.Sheet==r&&(c.Name.match(/^_xlfn\./)||i.push(Yl(c)))}return i.join("")}function Ky(e,t,r,a){if(!e)return"";var n=[];if(e["!margins"]&&(n.push("<PageSetup>"),e["!margins"].header&&n.push(de("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&n.push(de("Footer",null,{"x:Margin":e["!margins"].footer})),n.push(de("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),n.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)n.push(de("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(a.Workbook.Sheets[i]&&!a.Workbook.Sheets[i].Hidden);++i);i==r&&n.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),e["!protect"]&&(n.push(Cr("ProtectContents","True")),e["!protect"].objects&&n.push(Cr("ProtectObjects","True")),e["!protect"].scenarios&&n.push(Cr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?n.push(Cr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&n.push(Cr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){e["!protect"][s[0]]&&n.push("<"+s[1]+"/>")})),n.length==0?"":de("WorksheetOptions",n.join(""),{xmlns:qr.x})}function Qy(e){return e.map(function(t){var r=md(t.t||""),a=de("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return de("Comment",a,{"ss:Author":t.a})}).join("")}function qy(e,t,r,a,n,i,s){if(!e||e.v==null&&e.f==null)return"";var c={};if(e.f&&(c["ss:Formula"]="="+Ke(Ls(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var o=cr(e.F.slice(t.length+1));c["ss:ArrayRange"]="RC:R"+(o.r==s.r?"":"["+(o.r-s.r)+"]")+"C"+(o.c==s.c?"":"["+(o.c-s.c)+"]")}if(e.l&&e.l.Target&&(c["ss:HRef"]=Ke(e.l.Target),e.l.Tooltip&&(c["x:HRefScreenTip"]=Ke(e.l.Tooltip))),r["!merges"])for(var l=r["!merges"],f=0;f!=l.length;++f)l[f].s.c!=s.c||l[f].s.r!=s.r||(l[f].e.c>l[f].s.c&&(c["ss:MergeAcross"]=l[f].e.c-l[f].s.c),l[f].e.r>l[f].s.r&&(c["ss:MergeDown"]=l[f].e.r-l[f].s.r));var u="",d="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":u="Number",d=String(e.v);break;case"b":u="Boolean",d=e.v?"1":"0";break;case"e":u="Error",d=Pt[e.v];break;case"d":u="DateTime",d=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Ae[14]);break;case"s":u="String",d=gd(e.v||"");break}var x=Xt(a.cellXfs,e,a);c["ss:StyleID"]="s"+(21+x),c["ss:Index"]=s.c+1;var g=e.v!=null?d:"",p=e.t=="z"?"":'<Data ss:Type="'+u+'">'+g+"</Data>";return(e.c||[]).length>0&&(p+=Qy(e.c)),de("Cell",p,c)}function Jy(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Ia(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Zy(e,t,r,a){if(!e["!ref"])return"";var n=We(e["!ref"]),i=e["!merges"]||[],s=0,c=[];e["!cols"]&&e["!cols"].forEach(function(m,_){Vt(m);var k=!!m.width,v=gi(_,m),T={"ss:Index":_+1};k&&(T["ss:Width"]=fn(v.width)),m.hidden&&(T["ss:Hidden"]="1"),c.push(de("Column",null,T))});for(var o=Array.isArray(e),l=n.s.r;l<=n.e.r;++l){for(var f=[Jy(l,(e["!rows"]||[])[l])],u=n.s.c;u<=n.e.c;++u){var d=!1;for(s=0;s!=i.length;++s)if(!(i[s].s.c>u)&&!(i[s].s.r>l)&&!(i[s].e.c<u)&&!(i[s].e.r<l)){(i[s].s.c!=u||i[s].s.r!=l)&&(d=!0);break}if(!d){var x={r:l,c:u},g=be(x),p=o?(e[l]||[])[u]:e[g];f.push(qy(p,g,e,t,r,a,x))}}f.push("</Row>"),f.length>2&&c.push(f.join(""))}return c.join("")}function e_(e,t,r){var a=[],n=r.SheetNames[e],i=r.Sheets[n],s=i?Yy(i,t,e,r):"";return s.length>0&&a.push("<Names>"+s+"</Names>"),s=i?Zy(i,t,e,r):"",s.length>0&&a.push("<Table>"+s+"</Table>"),a.push(Ky(i,t,e,r)),a.join("")}function r_(e,t){t||(t={}),e.SSF||(e.SSF=tr(Ae)),e.SSF&&(Ra(),gn(e.SSF),t.revssf=hi(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Xt(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push($y(e,t)),r.push(Gy()),r.push(""),r.push("");for(var a=0;a<e.SheetNames.length;++a)r.push(de("Worksheet",e_(a,t,e),{"ss:Name":Ke(e.SheetNames[a])}));return r[2]=zy(e,t),r[3]=Xy(e),pr+de("Workbook",r.join(""),{xmlns:qr.ss,"xmlns:o":qr.o,"xmlns:x":qr.x,"xmlns:ss":qr.ss,"xmlns:dt":qr.dt,"xmlns:html":qr.html})}function t_(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=Xd(r),r.length-r.l<=4)return t;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(t.UnicodeClipboardFormat=Yd(r),a=r.read_shift(4),a==0||a>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var a_=[60,1084,2066,2165,2175];function n_(e,t,r,a,n){var i=a,s=[],c=r.slice(r.l,r.l+i);if(n&&n.enc&&n.enc.insitu&&c.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(c)}s.push(c),r.l+=i;for(var o=Dt(r,r.l),l=Ji[o],f=0;l!=null&&a_.indexOf(o)>-1;)i=Dt(r,r.l+2),f=r.l+4,o==2066?f+=4:(o==2165||o==2175)&&(f+=12),c=r.slice(f,r.l+4+i),s.push(c),r.l+=4+i,l=Ji[o=Dt(r,r.l)];var u=Fr(s);Dr(u,0);var d=0;u.lens=[];for(var x=0;x<s.length;++x)u.lens.push(d),d+=s[x].length;if(u.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+u.length+" < "+a;return t.f(u,u.length,n)}function wt(e,t,r){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Ae[a])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Pt[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=an(e.v):e.w=ia(e.v):e.w=nt(a,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&a&&e.t=="n"&&da(Ae[a]||String(a))){var n=jt(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function Ln(e,t,r){return{v:e,ixfe:t,t:r}}function i_(e,t){var r={opts:{}},a={},n=t.dense?[]:{},i={},s={},c=null,o=[],l="",f={},u,d="",x,g,p,m,_={},k=[],v,T,b=[],E=[],y={Sheets:[],WBProps:{date1904:!1},Views:[{}]},O={},B=function(Ce){return Ce<8?Jt[Ce]:Ce<64&&E[Ce-8]||Jt[Ce]},j=function(Ce,Ze,Tr){var ar=Ze.XF.data;if(!(!ar||!ar.patternType||!Tr||!Tr.cellStyles)){Ze.s={},Ze.s.patternType=ar.patternType;var At;(At=ln(B(ar.icvFore)))&&(Ze.s.fgColor={rgb:At}),(At=ln(B(ar.icvBack)))&&(Ze.s.bgColor={rgb:At})}},U=function(Ce,Ze,Tr){if(!(ge>1)&&!(Tr.sheetRows&&Ce.r>=Tr.sheetRows)){if(Tr.cellStyles&&Ze.XF&&Ze.XF.data&&j(Ce,Ze,Tr),delete Ze.ixfe,delete Ze.XF,u=Ce,d=be(Ce),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),Ce.r<s.s.r&&(s.s.r=Ce.r),Ce.c<s.s.c&&(s.s.c=Ce.c),Ce.r+1>s.e.r&&(s.e.r=Ce.r+1),Ce.c+1>s.e.c&&(s.e.c=Ce.c+1),Tr.cellFormula&&Ze.f){for(var ar=0;ar<k.length;++ar)if(!(k[ar][0].s.c>Ce.c||k[ar][0].s.r>Ce.r)&&!(k[ar][0].e.c<Ce.c||k[ar][0].e.r<Ce.r)){Ze.F=Pe(k[ar][0]),(k[ar][0].s.c!=Ce.c||k[ar][0].s.r!=Ce.r)&&delete Ze.f,Ze.f&&(Ze.f=""+Or(k[ar][1],s,Ce,V,L));break}}Tr.dense?(n[Ce.r]||(n[Ce.r]=[]),n[Ce.r][Ce.c]=Ze):n[d]=Ze}},L={enc:!1,sbcch:0,snames:[],sharedf:_,arrayf:k,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(L.password=t.password);var Y,J=[],Q=[],ce=[],ne=[],Se=!1,V=[];V.SheetNames=L.snames,V.sharedf=L.sharedf,V.arrayf=L.arrayf,V.names=[],V.XTI=[];var _e=0,ge=0,A=0,M=[],P=[],D;L.codepage=1200,xt(1200);for(var W=!1;e.l<e.length-1;){var Z=e.l,se=e.read_shift(2);if(se===0&&_e===10)break;var ae=e.l===e.length?0:e.read_shift(2),ee=Ji[se];if(ee&&ee.f){if(t.bookSheets&&_e===133&&se!==133)break;if(_e=se,ee.r===2||ee.r==12){var Ee=e.read_shift(2);if(ae-=2,!L.enc&&Ee!==se&&((Ee&255)<<8|Ee>>8)!==se)throw new Error("rt mismatch: "+Ee+"!="+se);ee.r==12&&(e.l+=10,ae-=10)}var R={};if(se===10?R=ee.f(e,ae,L):R=n_(se,ee,e,ae,L),ge==0&&[9,521,1033,2057].indexOf(_e)===-1)continue;switch(se){case 34:r.opts.Date1904=y.WBProps.date1904=R;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(L.enc||(e.l=0),L.enc=R,!t.password)throw new Error("File is password-protected");if(R.valid==null)throw new Error("Encryption scheme unsupported");if(!R.valid)throw new Error("Password is incorrect");break;case 92:L.lastuser=R;break;case 66:var q=Number(R);switch(q){case 21010:q=1200;break;case 32768:q=1e4;break;case 32769:q=1252;break}xt(L.codepage=q),W=!0;break;case 317:L.rrtabid=R;break;case 25:L.winlocked=R;break;case 439:r.opts.RefreshAll=R;break;case 12:r.opts.CalcCount=R;break;case 16:r.opts.CalcDelta=R;break;case 17:r.opts.CalcIter=R;break;case 13:r.opts.CalcMode=R;break;case 14:r.opts.CalcPrecision=R;break;case 95:r.opts.CalcSaveRecalc=R;break;case 15:L.CalcRefMode=R;break;case 2211:r.opts.FullCalc=R;break;case 129:R.fDialog&&(n["!type"]="dialog"),R.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),R.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:b.push(R);break;case 430:V.push([R]),V[V.length-1].XTI=[];break;case 35:case 547:V[V.length-1].push(R);break;case 24:case 536:D={Name:R.Name,Ref:Or(R.rgce,s,null,V,L)},R.itab>0&&(D.Sheet=R.itab-1),V.names.push(D),V[0]||(V[0]=[],V[0].XTI=[]),V[V.length-1].push(R),R.Name=="_xlnm._FilterDatabase"&&R.itab>0&&R.rgce&&R.rgce[0]&&R.rgce[0][0]&&R.rgce[0][0][0]=="PtgArea3d"&&(P[R.itab-1]={ref:Pe(R.rgce[0][0][1][2])});break;case 22:L.ExternCount=R;break;case 23:V.length==0&&(V[0]=[],V[0].XTI=[]),V[V.length-1].XTI=V[V.length-1].XTI.concat(R),V.XTI=V.XTI.concat(R);break;case 2196:if(L.biff<8)break;D!=null&&(D.Comment=R[1]);break;case 18:n["!protect"]=R;break;case 19:R!==0&&L.WTF&&console.error("Password verifier: "+R);break;case 133:i[R.pos]=R,L.snames.push(R.name);break;case 10:{if(--ge)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,n["!ref"]=Pe(s),t.sheetRows&&t.sheetRows<=s.e.r){var le=s.e.r;s.e.r=t.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=Pe(s),s.e.r=le}s.e.r++,s.e.c++}J.length>0&&(n["!merges"]=J),Q.length>0&&(n["!objects"]=Q),ce.length>0&&(n["!cols"]=ce),ne.length>0&&(n["!rows"]=ne),y.Sheets.push(O)}l===""?f=n:a[l]=n,n=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(L.biff===8&&(L.biff={9:2,521:3,1033:4}[se]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[R.BIFFVer]||8),L.biffguess=R.BIFFVer==0,R.BIFFVer==0&&R.dt==4096&&(L.biff=5,W=!0,xt(L.codepage=28591)),L.biff==8&&R.BIFFVer==0&&R.dt==16&&(L.biff=2),ge++)break;if(n=t.dense?[]:{},L.biff<8&&!W&&(W=!0,xt(L.codepage=t.codepage||1252)),L.biff<5||R.BIFFVer==0&&R.dt==4096){l===""&&(l="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var ve={pos:e.l-ae,name:l};i[ve.pos]=ve,L.snames.push(l)}else l=(i[Z]||{name:""}).name;R.dt==32&&(n["!type"]="chart"),R.dt==64&&(n["!type"]="macro"),J=[],Q=[],L.arrayf=k=[],ce=[],ne=[],Se=!1,O={Hidden:(i[Z]||{hs:0}).hs,name:l}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(t.dense?(n[R.r]||[])[R.c]:n[be({c:R.c,r:R.r})])&&++R.c,v={ixfe:R.ixfe,XF:b[R.ixfe]||{},v:R.val,t:"n"},A>0&&(v.z=M[v.ixfe>>8&63]),wt(v,t,r.opts.Date1904),U({c:R.c,r:R.r},v,t);break;case 5:case 517:v={ixfe:R.ixfe,XF:b[R.ixfe],v:R.val,t:R.t},A>0&&(v.z=M[v.ixfe>>8&63]),wt(v,t,r.opts.Date1904),U({c:R.c,r:R.r},v,t);break;case 638:v={ixfe:R.ixfe,XF:b[R.ixfe],v:R.rknum,t:"n"},A>0&&(v.z=M[v.ixfe>>8&63]),wt(v,t,r.opts.Date1904),U({c:R.c,r:R.r},v,t);break;case 189:for(var Te=R.c;Te<=R.C;++Te){var fe=R.rkrec[Te-R.c][0];v={ixfe:fe,XF:b[fe],v:R.rkrec[Te-R.c][1],t:"n"},A>0&&(v.z=M[v.ixfe>>8&63]),wt(v,t,r.opts.Date1904),U({c:Te,r:R.r},v,t)}break;case 6:case 518:case 1030:{if(R.val=="String"){c=R;break}if(v=Ln(R.val,R.cell.ixfe,R.tt),v.XF=b[v.ixfe],t.cellFormula){var H=R.formula;if(H&&H[0]&&H[0][0]&&H[0][0][0]=="PtgExp"){var we=H[0][0][1][0],Ne=H[0][0][1][1],He=be({r:we,c:Ne});_[He]?v.f=""+Or(R.formula,s,R.cell,V,L):v.F=((t.dense?(n[we]||[])[Ne]:n[He])||{}).F}else v.f=""+Or(R.formula,s,R.cell,V,L)}A>0&&(v.z=M[v.ixfe>>8&63]),wt(v,t,r.opts.Date1904),U(R.cell,v,t),c=R}break;case 7:case 519:if(c)c.val=R,v=Ln(R,c.cell.ixfe,"s"),v.XF=b[v.ixfe],t.cellFormula&&(v.f=""+Or(c.formula,s,c.cell,V,L)),A>0&&(v.z=M[v.ixfe>>8&63]),wt(v,t,r.opts.Date1904),U(c.cell,v,t),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{k.push(R);var Wr=be(R[0].s);if(x=t.dense?(n[R[0].s.r]||[])[R[0].s.c]:n[Wr],t.cellFormula&&x){if(!c||!Wr||!x)break;x.f=""+Or(R[1],s,R[0],V,L),x.F=Pe(R[0])}}break;case 1212:{if(!t.cellFormula)break;if(d){if(!c)break;_[be(c.cell)]=R[0],x=t.dense?(n[c.cell.r]||[])[c.cell.c]:n[be(c.cell)],(x||{}).f=""+Or(R[0],s,u,V,L)}}break;case 253:v=Ln(o[R.isst].t,R.ixfe,"s"),o[R.isst].h&&(v.h=o[R.isst].h),v.XF=b[v.ixfe],A>0&&(v.z=M[v.ixfe>>8&63]),wt(v,t,r.opts.Date1904),U({c:R.c,r:R.r},v,t);break;case 513:t.sheetStubs&&(v={ixfe:R.ixfe,XF:b[R.ixfe],t:"z"},A>0&&(v.z=M[v.ixfe>>8&63]),wt(v,t,r.opts.Date1904),U({c:R.c,r:R.r},v,t));break;case 190:if(t.sheetStubs)for(var Ge=R.c;Ge<=R.C;++Ge){var ze=R.ixfe[Ge-R.c];v={ixfe:ze,XF:b[ze],t:"z"},A>0&&(v.z=M[v.ixfe>>8&63]),wt(v,t,r.opts.Date1904),U({c:Ge,r:R.r},v,t)}break;case 214:case 516:case 4:v=Ln(R.val,R.ixfe,"s"),v.XF=b[v.ixfe],A>0&&(v.z=M[v.ixfe>>8&63]),wt(v,t,r.opts.Date1904),U({c:R.c,r:R.r},v,t);break;case 0:case 512:ge===1&&(s=R);break;case 252:o=R;break;case 1054:if(L.biff==4){M[A++]=R[1];for(var kr=0;kr<A+163&&Ae[kr]!=R[1];++kr);kr>=163&&Tt(R[1],A+163)}else Tt(R[1],R[0]);break;case 30:{M[A++]=R;for(var Re=0;Re<A+163&&Ae[Re]!=R;++Re);Re>=163&&Tt(R,A+163)}break;case 229:J=J.concat(R);break;case 93:Q[R.cmo[0]]=L.lastobj=R;break;case 438:L.lastobj.TxO=R;break;case 127:L.lastobj.ImData=R;break;case 440:for(m=R[0].s.r;m<=R[0].e.r;++m)for(p=R[0].s.c;p<=R[0].e.c;++p)x=t.dense?(n[m]||[])[p]:n[be({c:p,r:m})],x&&(x.l=R[1]);break;case 2048:for(m=R[0].s.r;m<=R[0].e.r;++m)for(p=R[0].s.c;p<=R[0].e.c;++p)x=t.dense?(n[m]||[])[p]:n[be({c:p,r:m})],x&&x.l&&(x.l.Tooltip=R[1]);break;case 28:{if(L.biff<=5&&L.biff>=2)break;x=t.dense?(n[R[0].r]||[])[R[0].c]:n[be(R[0])];var xe=Q[R[2]];x||(t.dense?(n[R[0].r]||(n[R[0].r]=[]),x=n[R[0].r][R[0].c]={t:"z"}):x=n[be(R[0])]={t:"z"},s.e.r=Math.max(s.e.r,R[0].r),s.s.r=Math.min(s.s.r,R[0].r),s.e.c=Math.max(s.e.c,R[0].c),s.s.c=Math.min(s.s.c,R[0].c)),x.c||(x.c=[]),g={a:R[1],t:xe.TxO.t},x.c.push(g)}break;case 2173:zg(b[R.ixfe],R.ext);break;case 125:{if(!L.cellStyles)break;for(;R.e>=R.s;)ce[R.e--]={width:R.w/256,level:R.level||0,hidden:!!(R.flags&1)},Se||(Se=!0,Bs(R.w/256)),Vt(ce[R.e+1])}break;case 520:{var Oe={};R.level!=null&&(ne[R.r]=Oe,Oe.level=R.level),R.hidden&&(ne[R.r]=Oe,Oe.hidden=!0),R.hpt&&(ne[R.r]=Oe,Oe.hpt=R.hpt,Oe.hpx=Ia(R.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||ra(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[se]]=R;break;case 161:n["!margins"]||ra(n["!margins"]={}),n["!margins"].header=R.header,n["!margins"].footer=R.footer;break;case 574:R.RTL&&(y.Views[0].RTL=!0);break;case 146:E=R;break;case 2198:Y=R;break;case 140:T=R;break;case 442:l?O.CodeName=R||O.name:y.WBProps.CodeName=R||"ThisWorkbook";break}}else ee||console.error("Missing Info for XLS Record 0x"+se.toString(16)),e.l+=ae}return r.SheetNames=hr(i).sort(function(Je,Ce){return Number(Je)-Number(Ce)}).map(function(Je){return i[Je].name}),t.bookSheets||(r.Sheets=a),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&P.forEach(function(Je,Ce){r.Sheets[r.SheetNames[Ce]]["!autofilter"]=Je}),r.Strings=o,r.SSF=tr(Ae),L.enc&&(r.Encryption=L.enc),Y&&(r.Themes=Y),r.Metadata={},T!==void 0&&(r.Metadata.Country=T),V.names.length>0&&(y.Names=V.names),r.Workbook=y,r}var en={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function s_(e,t,r){var a=Fe.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var n=H0(a,Gi,en.DSI);for(var i in n)t[i]=n[i]}catch(l){if(r.WTF)throw l}var s=Fe.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var c=H0(s,zi,en.SI);for(var o in c)t[o]==null&&(t[o]=c[o])}catch(l){if(r.WTF)throw l}t.HeadingPairs&&t.TitlesOfParts&&(Xo(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function c_(e,t){var r=[],a=[],n=[],i=0,s,c=w0(Gi,"n"),o=w0(zi,"n");if(e.Props)for(s=hr(e.Props),i=0;i<s.length;++i)(Object.prototype.hasOwnProperty.call(c,s[i])?r:Object.prototype.hasOwnProperty.call(o,s[i])?a:n).push([s[i],e.Props[s[i]]]);if(e.Custprops)for(s=hr(e.Custprops),i=0;i<s.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},s[i])||(Object.prototype.hasOwnProperty.call(c,s[i])?r:Object.prototype.hasOwnProperty.call(o,s[i])?a:n).push([s[i],e.Custprops[s[i]]]);var l=[];for(i=0;i<n.length;++i)el.indexOf(n[i][0])>-1||zo.indexOf(n[i][0])>-1||n[i][1]!=null&&l.push(n[i]);a.length&&Fe.utils.cfb_add(t,"/SummaryInformation",$0(a,en.SI,o,zi)),(r.length||l.length)&&Fe.utils.cfb_add(t,"/DocumentSummaryInformation",$0(r,en.DSI,c,Gi,l.length?l:null,en.UDI))}function Kl(e,t){t||(t={}),Hs(t),fs(),t.codepage&&ls(t.codepage);var r,a;if(e.FullPaths){if(Fe.find(e,"/encryption"))throw new Error("File is password-protected");r=Fe.find(e,"!CompObj"),a=Fe.find(e,"/Workbook")||Fe.find(e,"/Book")}else{switch(t.type){case"base64":e=Zr(at(e));break;case"binary":e=Zr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Dr(e,0),a={content:e}}var n,i;if(r&&t_(r),t.bookProps&&!t.bookSheets)n={};else{var s=Me?"buffer":"array";if(a&&a.content)n=i_(a.content,t);else if((i=Fe.find(e,"PerfectOffice_MAIN"))&&i.content)n=ea.to_workbook(i.content,(t.type=s,t));else if((i=Fe.find(e,"NativeContent_MAIN"))&&i.content)n=ea.to_workbook(i.content,(t.type=s,t));else throw(i=Fe.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Fe.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=ym(e))}var c={};return e.FullPaths&&s_(e,c,t),n.Props=n.Custprops=c,t.bookFiles&&(n.cfb=e),n}function o_(e,t){var r=t||{},a=Fe.utils.cfb_new({root:"R"}),n="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":n="/Workbook",r.biff=8;break;case"biff5":n="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Fe.utils.cfb_add(a,n,Ql(e,r)),r.biff==8&&(e.Props||e.Custprops)&&c_(e,a),r.biff==8&&e.vbaraw&&_m(a,Fe.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var dn={0:{f:I2},1:{f:U2},2:{f:iw},3:{f:Y2},4:{f:$2},5:{f:tw},6:{f:fw},7:{f:J2},8:{f:mw},9:{f:gw},10:{f:xw},11:{f:pw},12:{f:V2},13:{f:cw},14:{f:Q2},15:{f:z2},16:{f:Wl},17:{f:uw},18:{f:ew},19:{f:Es},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:uy},40:{},42:{},43:{f:fg},44:{f:og},45:{f:dg},46:{f:pg},47:{f:xg},48:{},49:{f:Od},50:{},51:{f:Kg},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:hl},62:{f:lw},63:{f:nm},64:{f:Rw},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:jr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Dw},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:M2},148:{f:O2,p:16},151:{f:Tw},152:{},153:{f:ly},154:{},155:{},156:{f:cy},157:{},158:{},159:{T:1,f:Sp},160:{T:-1},161:{T:1,f:va},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:vw},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Xg},336:{T:-1},337:{f:Jg,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:$i},357:{},358:{},359:{},360:{T:1},361:{},362:{f:fl},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Ew},427:{f:Sw},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Aw},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:L2},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:_w},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:$i},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:pm},633:{T:1},634:{T:-1},635:{T:1,f:dm},636:{T:-1},637:{f:jd},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Qw},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Bw},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Ji={6:{f:Ci},10:{f:Lt},12:{f:vr},13:{f:vr},14:{f:dr},15:{f:dr},16:{f:Lr},17:{f:dr},18:{f:dr},19:{f:vr},20:{f:Q0},21:{f:Q0},23:{f:fl},24:{f:J0},25:{f:dr},26:{},27:{},28:{f:Bx},29:{},34:{f:dr},35:{f:q0},38:{f:Lr},39:{f:Lr},40:{f:Lr},41:{f:Lr},42:{f:dr},43:{f:dr},47:{f:zp},49:{f:cx},51:{f:vr},60:{},61:{f:tx},64:{f:dr},65:{f:sx},66:{f:vr},77:{},80:{},81:{},82:{},85:{f:vr},89:{},90:{},91:{},92:{f:G1},93:{f:Lx},94:{},95:{f:dr},96:{},97:{},99:{f:dr},125:{f:hl},128:{f:kx},129:{f:X1},130:{f:vr},131:{f:dr},132:{f:dr},133:{f:Y1},134:{},140:{f:Gx},141:{f:vr},144:{},146:{f:Yx},151:{},152:{},153:{},154:{},155:{},156:{f:vr},157:{},158:{},160:{f:rp},161:{f:qx},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:vx},190:{f:wx},193:{f:Lt},197:{},198:{},199:{},200:{},201:{},202:{f:dr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:vr},220:{},221:{f:dr},222:{},224:{f:_x},225:{f:$1},226:{f:Lt},227:{},229:{f:Ox},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Q1},253:{f:lx},255:{f:J1},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:rl},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:dr},353:{f:Lt},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Ax},431:{f:dr},432:{},433:{},434:{},437:{},438:{f:Ux},439:{f:dr},440:{f:Wx},441:{},442:{f:yn},443:{},444:{f:vr},445:{},446:{},448:{f:Lt},449:{f:rx,r:2},450:{f:Lt},512:{f:X0},513:{f:ep},515:{f:Sx},516:{f:hx},517:{f:K0},519:{f:tp},520:{f:Z1},523:{},545:{f:Z0},549:{f:z0},566:{},574:{f:nx},638:{f:mx},659:{},1048:{},1054:{f:dx},1084:{},1212:{f:Nx},2048:{f:Hx},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Bn},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Lt},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Kx,r:12},2173:{f:Gg,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:dr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Cx,r:12},2197:{},2198:{f:jg,r:12},2199:{},2200:{},2201:{},2202:{f:Ix,r:12},2203:{f:Lt},2204:{},2205:{},2206:{},2207:{},2211:{f:ex},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:vr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Jx},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Xx},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:X0},1:{},2:{f:cp},3:{f:ip},4:{f:np},5:{f:K0},7:{f:lp},8:{},9:{f:Bn},11:{},22:{f:vr},30:{f:px},31:{},32:{},33:{f:Z0},36:{},37:{f:z0},50:{f:fp},62:{},52:{},67:{},68:{f:vr},69:{},86:{},126:{},127:{f:ap},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:hp},223:{},234:{},354:{},421:{},518:{f:Ci},521:{f:Bn},536:{f:J0},547:{f:q0},561:{},579:{},1030:{f:Ci},1033:{f:Bn},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function pe(e,t,r,a){var n=t;if(!isNaN(n)){var i=a||(r||[]).length||0,s=e.next(4);s.write_shift(2,n),s.write_shift(2,i),i>0&&_s(r)&&e.push(r)}}function l_(e,t,r,a){var n=(r||[]).length||0;if(n<=8224)return pe(e,t,r,n);var i=t;if(!isNaN(i)){for(var s=r.parts||[],c=0,o=0,l=0;l+(s[c]||8224)<=8224;)l+=s[c]||8224,c++;var f=e.next(4);for(f.write_shift(2,i),f.write_shift(2,l),e.push(r.slice(o,o+l)),o+=l;o<n;){for(f=e.next(4),f.write_shift(2,60),l=0;l+(s[c]||8224)<=8224;)l+=s[c]||8224,c++;f.write_shift(2,l),e.push(r.slice(o,o+l)),o+=l}}}function En(e,t,r){return e||(e=re(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function f_(e,t,r,a){var n=re(9);return En(n,e,t),tl(r,a||"b",n),n}function h_(e,t,r){var a=re(8+2*r.length);return En(a,e,t),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function u_(e,t,r,a){if(t.v!=null)switch(t.t){case"d":case"n":var n=t.t=="d"?_r(rr(t.v)):t.v;n==(n|0)&&n>=0&&n<65536?pe(e,2,op(r,a,n)):pe(e,3,sp(r,a,n));return;case"b":case"e":pe(e,5,f_(r,a,t.v,t.t));return;case"s":case"str":pe(e,4,h_(r,a,(t.v||"").slice(0,255)));return}pe(e,1,En(null,r,a))}function d_(e,t,r,a){var n=Array.isArray(t),i=We(t["!ref"]||"A1"),s,c="",o=[];if(i.e.c>255||i.e.r>16383){if(a.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),s=Pe(i)}for(var l=i.s.r;l<=i.e.r;++l){c=xr(l);for(var f=i.s.c;f<=i.e.c;++f){l===i.s.r&&(o[f]=sr(f)),s=o[f]+c;var u=n?(t[l]||[])[f]:t[s];u&&u_(e,u,l,f)}}}function x_(e,t){for(var r=t||{},a=Xr(),n=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(n=i);if(n==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return pe(a,r.biff==4?1033:r.biff==3?521:9,Ns(e,16,r)),d_(a,e.Sheets[e.SheetNames[n]],n,r),pe(a,10),a.end()}function p_(e,t,r){pe(e,49,ox({sz:12,name:"Arial"},r))}function g_(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&pe(e,1054,xx(n,t[n],r))})}function m_(e,t){var r=re(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),pe(e,2151,r),r=re(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),cl(We(t["!ref"]||"A1"),r),r.write_shift(4,4),pe(e,2152,r)}function v_(e,t){for(var r=0;r<16;++r)pe(e,224,Y0({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(a){pe(e,224,Y0(a,0,t))})}function w_(e,t){for(var r=0;r<t["!links"].length;++r){var a=t["!links"][r];pe(e,440,Vx(a)),a[1].Tooltip&&pe(e,2048,$x(a))}delete t["!links"]}function y_(e,t){if(t){var r=0;t.forEach(function(a,n){++r<=256&&a&&pe(e,125,Qx(gi(n,a),n))})}}function __(e,t,r,a,n){var i=16+Xt(n.cellXfs,t,n);if(t.v==null&&!t.bf){pe(e,513,la(r,a,i));return}if(t.bf)pe(e,6,Xv(t,r,a,n,i));else switch(t.t){case"d":case"n":var s=t.t=="d"?_r(rr(t.v)):t.v;pe(e,515,Fx(r,a,s,i));break;case"b":case"e":pe(e,517,Ex(r,a,t.v,i,n,t.t));break;case"s":case"str":if(n.bookSST){var c=js(n.Strings,t.v,n.revStrings);pe(e,253,fx(r,a,c,i))}else pe(e,516,ux(r,a,(t.v||"").slice(0,255),i,n));break;default:pe(e,513,la(r,a,i))}}function k_(e,t,r){var a=Xr(),n=r.SheetNames[e],i=r.Sheets[n]||{},s=(r||{}).Workbook||{},c=(s.Sheets||[])[e]||{},o=Array.isArray(i),l=t.biff==8,f,u="",d=[],x=We(i["!ref"]||"A1"),g=l?65536:16384;if(x.e.c>255||x.e.r>=g){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");x.e.c=Math.min(x.e.c,255),x.e.r=Math.min(x.e.c,g-1)}pe(a,2057,Ns(r,16,t)),pe(a,13,ft(1)),pe(a,12,ft(100)),pe(a,15,Hr(!0)),pe(a,17,Hr(!1)),pe(a,16,ca(.001)),pe(a,95,Hr(!0)),pe(a,42,Hr(!1)),pe(a,43,Hr(!1)),pe(a,130,ft(1)),pe(a,128,Tx()),pe(a,131,Hr(!1)),pe(a,132,Hr(!1)),l&&y_(a,i["!cols"]),pe(a,512,gx(x,t)),l&&(i["!links"]=[]);for(var p=x.s.r;p<=x.e.r;++p){u=xr(p);for(var m=x.s.c;m<=x.e.c;++m){p===x.s.r&&(d[m]=sr(m)),f=d[m]+u;var _=o?(i[p]||[])[m]:i[f];_&&(__(a,_,p,m,t),l&&_.l&&i["!links"].push([f,_.l]))}}var k=c.CodeName||c.name||n;return l&&pe(a,574,ix((s.Views||[])[0])),l&&(i["!merges"]||[]).length&&pe(a,229,Px(i["!merges"])),l&&w_(a,i),pe(a,442,al(k)),l&&m_(a,i),pe(a,10),a.end()}function T_(e,t,r){var a=Xr(),n=(e||{}).Workbook||{},i=n.Sheets||[],s=n.WBProps||{},c=r.biff==8,o=r.biff==5;if(pe(a,2057,Ns(e,5,r)),r.bookType=="xla"&&pe(a,135),pe(a,225,c?ft(1200):null),pe(a,193,E1(2)),o&&pe(a,191),o&&pe(a,192),pe(a,226),pe(a,92,z1("SheetJS",r)),pe(a,66,ft(c?1200:1252)),c&&pe(a,353,ft(0)),c&&pe(a,448),pe(a,317,Zx(e.SheetNames.length)),c&&e.vbaraw&&pe(a,211),c&&e.vbaraw){var l=s.CodeName||"ThisWorkbook";pe(a,442,al(l))}pe(a,156,ft(17)),pe(a,25,Hr(!1)),pe(a,18,Hr(!1)),pe(a,19,ft(0)),c&&pe(a,431,Hr(!1)),c&&pe(a,444,ft(0)),pe(a,61,ax()),pe(a,64,Hr(!1)),pe(a,141,ft(0)),pe(a,34,Hr(ry(e)=="true")),pe(a,14,Hr(!0)),c&&pe(a,439,Hr(!1)),pe(a,218,ft(0)),p_(a,e,r),g_(a,e.SSF,r),v_(a,r),c&&pe(a,352,Hr(!1));var f=a.end(),u=Xr();c&&pe(u,140,zx()),c&&r.Strings&&l_(u,252,q1(r.Strings)),pe(u,10);var d=u.end(),x=Xr(),g=0,p=0;for(p=0;p<e.SheetNames.length;++p)g+=(c?12:11)+(c?2:1)*e.SheetNames[p].length;var m=f.length+g+d.length;for(p=0;p<e.SheetNames.length;++p){var _=i[p]||{};pe(x,133,K1({pos:m,hs:_.Hidden||0,dt:0,name:e.SheetNames[p]},r)),m+=t[p].length}var k=x.end();if(g!=k.length)throw new Error("BS8 "+g+" != "+k.length);var v=[];return f.length&&v.push(f),k.length&&v.push(k),d.length&&v.push(d),Fr(v)}function E_(e,t){var r=t||{},a=[];e&&!e.SSF&&(e.SSF=tr(Ae)),e&&e.SSF&&(Ra(),gn(e.SSF),r.revssf=hi(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,$s(r),r.cellXfs=[],Xt(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var n=0;n<e.SheetNames.length;++n)a[a.length]=k_(n,r,e);return a.unshift(T_(e,a,r)),Fr(a)}function Ql(e,t){for(var r=0;r<=e.SheetNames.length;++r){var a=e.Sheets[e.SheetNames[r]];if(!(!a||!a["!ref"])){var n=Yr(a["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return E_(e,t);case 4:case 3:case 2:return x_(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function lc(e,t){var r=t||{},a=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var n=e.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),s=n.index,c=i&&i.index||e.length,o=od(e.slice(s,c),/(:?<tr[^>]*>)/i,"<tr>"),l=-1,f=0,u=0,d=0,x={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(s=0;s<o.length;++s){var p=o[s].trim(),m=p.slice(0,3).toLowerCase();if(m=="<tr"){if(++l,r.sheetRows&&r.sheetRows<=l){--l;break}f=0;continue}if(!(m!="<td"&&m!="<th")){var _=p.split(/<\/t[dh]>/i);for(c=0;c<_.length;++c){var k=_[c].trim();if(k.match(/<t[dh]/i)){for(var v=k,T=0;v.charAt(0)=="<"&&(T=v.indexOf(">"))>-1;)v=v.slice(T+1);for(var b=0;b<g.length;++b){var E=g[b];E.s.c==f&&E.s.r<l&&l<=E.e.r&&(f=E.e.c+1,b=-1)}var y=De(k.slice(0,k.indexOf(">")));d=y.colspan?+y.colspan:1,((u=+y.rowspan)>1||d>1)&&g.push({s:{r:l,c:f},e:{r:l+(u||1)-1,c:f+d-1}});var O=y.t||y["data-t"]||"";if(!v.length){f+=d;continue}if(v=yo(v),x.s.r>l&&(x.s.r=l),x.e.r<l&&(x.e.r=l),x.s.c>f&&(x.s.c=f),x.e.c<f&&(x.e.c=f),!v.length){f+=d;continue}var B={t:"s",v};r.raw||!v.trim().length||O=="s"||(v==="TRUE"?B={t:"b",v:!0}:v==="FALSE"?B={t:"b",v:!1}:isNaN(gt(v))?isNaN(Ca(v).getDate())||(B={t:"d",v:rr(v)},r.cellDates||(B={t:"n",v:_r(B.v)}),B.z=r.dateNF||Ae[14]):B={t:"n",v:gt(v)}),r.dense?(a[l]||(a[l]=[]),a[l][f]=B):a[be({r:l,c:f})]=B,f+=d}}}}return a["!ref"]=Pe(x),g.length&&(a["!merges"]=g),a}function S_(e,t,r,a){for(var n=e["!merges"]||[],i=[],s=t.s.c;s<=t.e.c;++s){for(var c=0,o=0,l=0;l<n.length;++l)if(!(n[l].s.r>r||n[l].s.c>s)&&!(n[l].e.r<r||n[l].e.c<s)){if(n[l].s.r<r||n[l].s.c<s){c=-1;break}c=n[l].e.r-n[l].s.r+1,o=n[l].e.c-n[l].s.c+1;break}if(!(c<0)){var f=be({r,c:s}),u=a.dense?(e[r]||[])[s]:e[f],d=u&&u.v!=null&&(u.h||vs(u.w||(Rt(u),u.w)||""))||"",x={};c>1&&(x.rowspan=c),o>1&&(x.colspan=o),a.editable?d='<span contenteditable="true">'+d+"</span>":u&&(x["data-t"]=u&&u.t||"z",u.v!=null&&(x["data-v"]=u.v),u.z!=null&&(x["data-z"]=u.z),u.l&&(u.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+u.l.Target+'">'+d+"</a>")),x.id=(a.id||"sjs")+"-"+f,i.push(de("td",d,x))}}var g="<tr>";return g+i.join("")+"</tr>"}var F_='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',A_="</body></html>";function b_(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return zt(lc(r[0],t),t);var a=Xs();return r.forEach(function(n,i){Ys(a,lc(n,t),"Sheet"+(i+1))}),a}function D_(e,t,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function ql(e,t){var r=t||{},a=r.header!=null?r.header:F_,n=r.footer!=null?r.footer:A_,i=[a],s=Yr(e["!ref"]);r.dense=Array.isArray(e),i.push(D_(e,s,r));for(var c=s.s.r;c<=s.e.r;++c)i.push(S_(e,s,c,r));return i.push("</table>"+n),i.join("")}function Jl(e,t,r){var a=r||{},n=0,i=0;if(a.origin!=null)if(typeof a.origin=="number")n=a.origin;else{var s=typeof a.origin=="string"?cr(a.origin):a.origin;n=s.r,i=s.c}var c=t.getElementsByTagName("tr"),o=Math.min(a.sheetRows||1e7,c.length),l={s:{r:0,c:0},e:{r:n,c:i}};if(e["!ref"]){var f=Yr(e["!ref"]);l.s.r=Math.min(l.s.r,f.s.r),l.s.c=Math.min(l.s.c,f.s.c),l.e.r=Math.max(l.e.r,f.e.r),l.e.c=Math.max(l.e.c,f.e.c),n==-1&&(l.e.r=n=f.e.r+1)}var u=[],d=0,x=e["!rows"]||(e["!rows"]=[]),g=0,p=0,m=0,_=0,k=0,v=0;for(e["!cols"]||(e["!cols"]=[]);g<c.length&&p<o;++g){var T=c[g];if(fc(T)){if(a.display)continue;x[p]={hidden:!0}}var b=T.children;for(m=_=0;m<b.length;++m){var E=b[m];if(!(a.display&&fc(E))){var y=E.hasAttribute("data-v")?E.getAttribute("data-v"):E.hasAttribute("v")?E.getAttribute("v"):yo(E.innerHTML),O=E.getAttribute("data-z")||E.getAttribute("z");for(d=0;d<u.length;++d){var B=u[d];B.s.c==_+i&&B.s.r<p+n&&p+n<=B.e.r&&(_=B.e.c+1-i,d=-1)}v=+E.getAttribute("colspan")||1,((k=+E.getAttribute("rowspan")||1)>1||v>1)&&u.push({s:{r:p+n,c:_+i},e:{r:p+n+(k||1)-1,c:_+i+(v||1)-1}});var j={t:"s",v:y},U=E.getAttribute("data-t")||E.getAttribute("t")||"";y!=null&&(y.length==0?j.t=U||"z":a.raw||y.trim().length==0||U=="s"||(y==="TRUE"?j={t:"b",v:!0}:y==="FALSE"?j={t:"b",v:!1}:isNaN(gt(y))?isNaN(Ca(y).getDate())||(j={t:"d",v:rr(y)},a.cellDates||(j={t:"n",v:_r(j.v)}),j.z=a.dateNF||Ae[14]):j={t:"n",v:gt(y)})),j.z===void 0&&O!=null&&(j.z=O);var L="",Y=E.getElementsByTagName("A");if(Y&&Y.length)for(var J=0;J<Y.length&&!(Y[J].hasAttribute("href")&&(L=Y[J].getAttribute("href"),L.charAt(0)!="#"));++J);L&&L.charAt(0)!="#"&&(j.l={Target:L}),a.dense?(e[p+n]||(e[p+n]=[]),e[p+n][_+i]=j):e[be({c:_+i,r:p+n})]=j,l.e.c<_+i&&(l.e.c=_+i),_+=v}}++p}return u.length&&(e["!merges"]=(e["!merges"]||[]).concat(u)),l.e.r=Math.max(l.e.r,p-1+n),e["!ref"]=Pe(l),p>=o&&(e["!fullref"]=Pe((l.e.r=c.length-g+p-1+n,l))),e}function Zl(e,t){var r=t||{},a=r.dense?[]:{};return Jl(a,e,t)}function C_(e,t){return zt(Zl(e,t),t)}function fc(e){var t="",r=N_(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function N_(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function I_(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ue(t.replace(/<[^>]*>/g,""));return[r]}var hc={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function ef(e,t){var r=t||{},a=ws(e),n=[],i,s,c={name:""},o="",l=0,f,u,d={},x=[],g=r.dense?[]:{},p,m,_={value:""},k="",v=0,T=[],b=-1,E=-1,y={s:{r:1e6,c:1e7},e:{r:0,c:0}},O=0,B={},j=[],U={},L=0,Y=0,J=[],Q=1,ce=1,ne=[],Se={Names:[]},V={},_e=["",""],ge=[],A={},M="",P=0,D=!1,W=!1,Z=0;for(cn.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=cn.exec(a);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"Â∑•‰ΩúË°®":p[1]==="/"?(y.e.c>=y.s.c&&y.e.r>=y.s.r?g["!ref"]=Pe(y):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=y.e.r&&(g["!fullref"]=g["!ref"],y.e.r=r.sheetRows-1,g["!ref"]=Pe(y)),j.length&&(g["!merges"]=j),J.length&&(g["!rows"]=J),f.name=f.ÂêçÁß∞||f.name,typeof JSON<"u"&&JSON.stringify(f),x.push(f.name),d[f.name]=g,W=!1):p[0].charAt(p[0].length-2)!=="/"&&(f=De(p[0],!1),b=E=-1,y.s.r=y.s.c=1e7,y.e.r=y.e.c=0,g=r.dense?[]:{},j=[],J=[],W=!0);break;case"table-row-group":p[1]==="/"?--O:++O;break;case"table-row":case"Ë°å":if(p[1]==="/"){b+=Q,Q=1;break}if(u=De(p[0],!1),u.Ë°åÂè∑?b=u.Ë°åÂè∑-1:b==-1&&(b=0),Q=+u["number-rows-repeated"]||1,Q<10)for(Z=0;Z<Q;++Z)O>0&&(J[b+Z]={level:O});E=-1;break;case"covered-table-cell":p[1]!=="/"&&++E,r.sheetStubs&&(r.dense?(g[b]||(g[b]=[]),g[b][E]={t:"z"}):g[be({r:b,c:E})]={t:"z"}),k="",T=[];break;case"table-cell":case"Êï∞ÊçÆ":if(p[0].charAt(p[0].length-2)==="/")++E,_=De(p[0],!1),ce=parseInt(_["number-columns-repeated"]||"1",10),m={t:"z",v:null},_.formula&&r.cellFormula!=!1&&(m.f=sc(Ue(_.formula))),(_.Êï∞ÊçÆÁ±ªÂûã||_["value-type"])=="string"&&(m.t="s",m.v=Ue(_["string-value"]||""),r.dense?(g[b]||(g[b]=[]),g[b][E]=m):g[be({r:b,c:E})]=m),E+=ce-1;else if(p[1]!=="/"){++E,k="",v=0,T=[],ce=1;var se=Q?b+Q-1:b;if(E>y.e.c&&(y.e.c=E),E<y.s.c&&(y.s.c=E),b<y.s.r&&(y.s.r=b),se>y.e.r&&(y.e.r=se),_=De(p[0],!1),ge=[],A={},m={t:_.Êï∞ÊçÆÁ±ªÂûã||_["value-type"],v:null},r.cellFormula)if(_.formula&&(_.formula=Ue(_.formula)),_["number-matrix-columns-spanned"]&&_["number-matrix-rows-spanned"]&&(L=parseInt(_["number-matrix-rows-spanned"],10)||0,Y=parseInt(_["number-matrix-columns-spanned"],10)||0,U={s:{r:b,c:E},e:{r:b+L-1,c:E+Y-1}},m.F=Pe(U),ne.push([U,m.F])),_.formula)m.f=sc(_.formula);else for(Z=0;Z<ne.length;++Z)b>=ne[Z][0].s.r&&b<=ne[Z][0].e.r&&E>=ne[Z][0].s.c&&E<=ne[Z][0].e.c&&(m.F=ne[Z][1]);switch((_["number-columns-spanned"]||_["number-rows-spanned"])&&(L=parseInt(_["number-rows-spanned"],10)||0,Y=parseInt(_["number-columns-spanned"],10)||0,U={s:{r:b,c:E},e:{r:b+L-1,c:E+Y-1}},j.push(U)),_["number-columns-repeated"]&&(ce=parseInt(_["number-columns-repeated"],10)),m.t){case"boolean":m.t="b",m.v=er(_["boolean-value"]);break;case"float":m.t="n",m.v=parseFloat(_.value);break;case"percentage":m.t="n",m.v=parseFloat(_.value);break;case"currency":m.t="n",m.v=parseFloat(_.value);break;case"date":m.t="d",m.v=rr(_["date-value"]),r.cellDates||(m.t="n",m.v=_r(m.v)),m.z="m/d/yy";break;case"time":m.t="n",m.v=id(_["time-value"])/86400,r.cellDates&&(m.t="d",m.v=ui(m.v)),m.z="HH:MM:SS";break;case"number":m.t="n",m.v=parseFloat(_.Êï∞ÊçÆÊï∞ÂÄº);break;default:if(m.t==="string"||m.t==="text"||!m.t)m.t="s",_["string-value"]!=null&&(k=Ue(_["string-value"]),T=[]);else throw new Error("Unsupported value type "+m.t)}}else{if(D=!1,m.t==="s"&&(m.v=k||"",T.length&&(m.R=T),D=v==0),V.Target&&(m.l=V),ge.length>0&&(m.c=ge,ge=[]),k&&r.cellText!==!1&&(m.w=k),D&&(m.t="z",delete m.v),(!D||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=b))for(var ae=0;ae<Q;++ae){if(ce=parseInt(_["number-columns-repeated"]||"1",10),r.dense)for(g[b+ae]||(g[b+ae]=[]),g[b+ae][E]=ae==0?m:tr(m);--ce>0;)g[b+ae][E+ce]=tr(m);else for(g[be({r:b+ae,c:E})]=m;--ce>0;)g[be({r:b+ae,c:E+ce})]=tr(m);y.e.c<=E&&(y.e.c=E)}ce=parseInt(_["number-columns-repeated"]||"1",10),E+=ce-1,ce=0,m={},k="",T=[]}V={};break;case"document":case"document-content":case"ÁîµÂ≠êË°®Ê†ºÊñáÊ°£":case"spreadsheet":case"‰∏ª‰Ωì":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((i=n.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&n.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((i=n.pop())[0]!==p[3])throw"Bad state: "+i;A.t=k,T.length&&(A.R=T),A.a=M,ge.push(A)}else p[0].charAt(p[0].length-2)!=="/"&&n.push([p[3],!1]);M="",P=0,k="",v=0,T=[];break;case"creator":p[1]==="/"?M=a.slice(P,p.index):P=p.index+p[0].length;break;case"meta":case"ÂÖÉÊï∞ÊçÆ":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((i=n.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&n.push([p[3],!1]);k="",v=0,T=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(B[c.name]=o,(i=n.pop())[0]!==p[3])throw"Bad state: "+i}else p[0].charAt(p[0].length-2)!=="/"&&(o="",c=De(p[0],!1),n.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":s=De(p[0],!1),o+=hc[p[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":s=De(p[0],!1),o+=hc[p[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":o+=a.slice(l,p.index);break}else l=p.index+p[0].length;break;case"named-range":s=De(p[0],!1),_e=Ni(s["cell-range-address"]);var ee={Name:s.name,Ref:_e[0]+"!"+_e[1]};W&&(ee.Sheet=x.length),Se.Names.push(ee);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"ÁîµÂ≠êË°®Ê†º":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"ÊñáÊú¨‰∏≤":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(p[1]==="/"&&(!_||!_["string-value"])){var Ee=I_(a.slice(v,p.index));k=(k.length>0?k+`
`:"")+Ee[0]}else De(p[0],!1),v=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{_e=Ni(De(p[0])["target-range-address"]),d[_e[0]]["!autofilter"]={ref:_e[1]}}catch{}break;case"date":break;case"object":break;case"title":case"Ê†áÈ¢ò":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(V=De(p[0],!1),!V.href)break;V.Target=Ue(V.href),delete V.href,V.Target.charAt(0)=="#"&&V.Target.indexOf(".")>-1?(_e=Ni(V.Target.slice(1)),V.Target="#"+_e[0]+"!"+_e[1]):V.Target.match(/^\.\.[\\\/]/)&&(V.Target=V.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"Ë°®:":case"Â≠ó:":break;default:if(r.WTF)throw new Error(p)}}var R={Sheets:d,SheetNames:x,Workbook:Se};return r.bookSheets&&delete R.Sheets,R}function uc(e,t){t=t||{},lt(e,"META-INF/manifest.xml")&&i1(mr(e,"META-INF/manifest.xml"),t);var r=et(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=ef(Qe(r),t);return lt(e,"meta.xml")&&(a.Props=$o(mr(e,"meta.xml"))),a}function dc(e,t){return ef(e,t)}var R_=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+sn({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return pr+t}}(),xc=function(){var e=function(i){return Ke(i).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(i,s,c){var o=[];o.push('      <table:table table:name="'+Ke(s.SheetNames[c])+`" table:style-name="ta1">
`);var l=0,f=0,u=Yr(i["!ref"]||"A1"),d=i["!merges"]||[],x=0,g=Array.isArray(i);if(i["!cols"])for(f=0;f<=u.e.c;++f)o.push("        <table:table-column"+(i["!cols"][f]?' table:style-name="co'+i["!cols"][f].ods+'"':"")+`></table:table-column>
`);var p="",m=i["!rows"]||[];for(l=0;l<u.s.r;++l)p=m[l]?' table:style-name="ro'+m[l].ods+'"':"",o.push("        <table:table-row"+p+`></table:table-row>
`);for(;l<=u.e.r;++l){for(p=m[l]?' table:style-name="ro'+m[l].ods+'"':"",o.push("        <table:table-row"+p+`>
`),f=0;f<u.s.c;++f)o.push(t);for(;f<=u.e.c;++f){var _=!1,k={},v="";for(x=0;x!=d.length;++x)if(!(d[x].s.c>f)&&!(d[x].s.r>l)&&!(d[x].e.c<f)&&!(d[x].e.r<l)){(d[x].s.c!=f||d[x].s.r!=l)&&(_=!0),k["table:number-columns-spanned"]=d[x].e.c-d[x].s.c+1,k["table:number-rows-spanned"]=d[x].e.r-d[x].s.r+1;break}if(_){o.push(r);continue}var T=be({r:l,c:f}),b=g?(i[l]||[])[f]:i[T];if(b&&b.f&&(k["table:formula"]=Ke(Zv(b.f)),b.F&&b.F.slice(0,T.length)==T)){var E=Yr(b.F);k["table:number-matrix-columns-spanned"]=E.e.c-E.s.c+1,k["table:number-matrix-rows-spanned"]=E.e.r-E.s.r+1}if(!b){o.push(t);continue}switch(b.t){case"b":v=b.v?"TRUE":"FALSE",k["office:value-type"]="boolean",k["office:boolean-value"]=b.v?"true":"false";break;case"n":v=b.w||String(b.v||0),k["office:value-type"]="float",k["office:value"]=b.v||0;break;case"s":case"str":v=b.v==null?"":b.v,k["office:value-type"]="string";break;case"d":v=b.w||rr(b.v).toISOString(),k["office:value-type"]="date",k["office:date-value"]=rr(b.v).toISOString(),k["table:style-name"]="ce1";break;default:o.push(t);continue}var y=e(v);if(b.l&&b.l.Target){var O=b.l.Target;O=O.charAt(0)=="#"?"#"+e2(O.slice(1)):O,O.charAt(0)!="#"&&!O.match(/^\w+:/)&&(O="../"+O),y=de("text:a",y,{"xlink:href":O.replace(/&/g,"&amp;")})}o.push("          "+de("table:table-cell",de("text:p",y,{}),k)+`
`)}o.push(`        </table:table-row>
`)}return o.push(`      </table:table>
`),o.join("")},n=function(i,s){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var c=0;s.SheetNames.map(function(l){return s.Sheets[l]}).forEach(function(l){if(l&&l["!cols"]){for(var f=0;f<l["!cols"].length;++f)if(l["!cols"][f]){var u=l["!cols"][f];if(u.width==null&&u.wpx==null&&u.wch==null)continue;Vt(u),u.ods=c;var d=l["!cols"][f].wpx+"px";i.push('  <style:style style:name="co'+c+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+d+`"/>
`),i.push(`  </style:style>
`),++c}}});var o=0;s.SheetNames.map(function(l){return s.Sheets[l]}).forEach(function(l){if(l&&l["!rows"]){for(var f=0;f<l["!rows"].length;++f)if(l["!rows"][f]){l["!rows"][f].ods=o;var u=l["!rows"][f].hpx+"px";i.push('  <style:style style:name="ro'+o+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+u+`"/>
`),i.push(`  </style:style>
`),++o}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(s,c){var o=[pr],l=sn({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=sn({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});c.bookType=="fods"?(o.push("<office:document"+l+f+`>
`),o.push(Ho().replace(/office:document-meta/g,"office:meta"))):o.push("<office:document-content"+l+`>
`),n(o,s),o.push(`  <office:body>
`),o.push(`    <office:spreadsheet>
`);for(var u=0;u!=s.SheetNames.length;++u)o.push(a(s.Sheets[s.SheetNames[u]],s,u));return o.push(`    </office:spreadsheet>
`),o.push(`  </office:body>
`),c.bookType=="fods"?o.push("</office:document>"):o.push("</office:document-content>"),o.join("")}}();function rf(e,t){if(t.bookType=="fods")return xc(e,t);var r=ps(),a="",n=[],i=[];return a="mimetype",Le(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",Le(r,a,xc(e,t)),n.push([a,"text/xml"]),i.push([a,"ContentFile"]),a="styles.xml",Le(r,a,R_(e,t)),n.push([a,"text/xml"]),i.push([a,"StylesFile"]),a="meta.xml",Le(r,a,pr+Ho()),n.push([a,"text/xml"]),i.push([a,"MetadataFile"]),a="manifest.rdf",Le(r,a,o1(i)),n.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",Le(r,a,s1(n)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function fa(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Zi(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Qe(Gt(e))}function B_(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Zr(kt(e))}function O_(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var a=0;a<t.length;++a)if(e[r+a]!=t[a])continue e;return!0}return!1}function $t(e){var t=e.reduce(function(n,i){return n+i.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(n){r.set(n,a),a+=n.length}),r}function pc(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function P_(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,a=e[t+14]&1,n=t+13;n>=t;--n)a=a*256+e[n];return(e[t+15]&128?-a:a)*Math.pow(10,r-6176)}function L_(e,t,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,n=r/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(a&127)<<1;for(var i=0;n>=1;++i,n/=256)e[t+i]=n&255;e[t+15]|=r>=0?0:128}function xn(e,t){var r=t?t[0]:0,a=e[r]&127;e:if(e[r++]>=128&&(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),a}function Xe(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function fr(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Ve(e){for(var t=[],r=[0];r[0]<e.length;){var a=r[0],n=xn(e,r),i=n&7;n=Math.floor(n/8);var s=0,c;if(n==0)break;switch(i){case 0:{for(var o=r[0];e[r[0]++]>=128;);c=e.slice(o,r[0])}break;case 5:s=4,c=e.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,c=e.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=xn(e,r),c=e.slice(r[0],r[0]+s),r[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(n," at offset ").concat(a))}var l={data:c,type:i};t[n]==null?t[n]=[l]:t[n].push(l)}return t}function br(e){var t=[];return e.forEach(function(r,a){r.forEach(function(n){n.data&&(t.push(Xe(a*8+n.type)),n.type==2&&t.push(Xe(n.data.length)),t.push(n.data))})}),$t(t)}function Vs(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function ct(e){for(var t,r=[],a=[0];a[0]<e.length;){var n=xn(e,a),i=Ve(e.slice(a[0],a[0]+n));a[0]+=n;var s={id:fr(i[1][0].data),messages:[]};i[2].forEach(function(c){var o=Ve(c.data),l=fr(o[3][0].data);s.messages.push({meta:o,data:e.slice(a[0],a[0]+l)}),a[0]+=l}),(t=i[3])!=null&&t[0]&&(s.merge=fr(i[3][0].data)>>>0>0),r.push(s)}return r}function _a(e){var t=[];return e.forEach(function(r){var a=[];a[1]=[{data:Xe(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:Xe(+!!r.merge),type:0}]);var n=[];r.messages.forEach(function(s){n.push(s.data),s.meta[3]=[{type:0,data:Xe(s.data.length)}],a[2].push({data:br(s.meta),type:2})});var i=br(a);t.push(Xe(i.length)),t.push(i),n.forEach(function(s){return t.push(s)})}),$t(t)}function M_(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=xn(t,r),n=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var s=t[r[0]++]>>2;if(s<60)++s;else{var c=s-59;s=t[r[0]],c>1&&(s|=t[r[0]+1]<<8),c>2&&(s|=t[r[0]+2]<<16),c>3&&(s|=t[r[0]+3]<<24),s>>>=0,s++,r[0]+=c}n.push(t.slice(r[0],r[0]+s)),r[0]+=s;continue}else{var o=0,l=0;if(i==1?(l=(t[r[0]]>>2&7)+4,o=(t[r[0]++]&224)<<3,o|=t[r[0]++]):(l=(t[r[0]++]>>2)+1,i==2?(o=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(o=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),n=[$t(n)],o==0)throw new Error("Invalid offset 0");if(o>n[0].length)throw new Error("Invalid offset beyond length");if(l>=o)for(n.push(n[0].slice(-o)),l-=o;l>=n[n.length-1].length;)n.push(n[n.length-1]),l-=n[n.length-1].length;n.push(n[0].slice(-o,-o+l))}}var f=$t(n);if(f.length!=a)throw new Error("Unexpected length: ".concat(f.length," != ").concat(a));return f}function ot(e){for(var t=[],r=0;r<e.length;){var a=e[r++],n=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(M_(a,e.slice(r,r+n))),r+=n}if(r!==e.length)throw new Error("data is not a valid framed stream!");return $t(t)}function ka(e){for(var t=[],r=0;r<e.length;){var a=Math.min(e.length-r,268435455),n=new Uint8Array(4);t.push(n);var i=Xe(a),s=i.length;t.push(i),a<=60?(s++,t.push(new Uint8Array([a-1<<2]))):a<=256?(s+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(s+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(s+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(s+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(r,r+a)),s+=a,n[0]=0,n[1]=s&255,n[2]=s>>8&255,n[3]=s>>16&255,r+=a}return $t(t)}function j_(e,t,r,a){var n=fa(e),i=n.getUint32(4,!0),s=(a>1?12:8)+pc(i&(a>1?3470:398))*4,c=-1,o=-1,l=NaN,f=new Date(2001,0,1);i&512&&(c=n.getUint32(s,!0),s+=4),s+=pc(i&(a>1?12288:4096))*4,i&16&&(o=n.getUint32(s,!0),s+=4),i&32&&(l=n.getFloat64(s,!0),s+=8),i&64&&(f.setTime(f.getTime()+n.getFloat64(s,!0)*1e3),s+=8);var u;switch(e[2]){case 0:break;case 2:u={t:"n",v:l};break;case 3:u={t:"s",v:t[o]};break;case 5:u={t:"d",v:f};break;case 6:u={t:"b",v:l>0};break;case 7:u={t:"n",v:l/86400};break;case 8:u={t:"e",v:0};break;case 9:if(c>-1)u={t:"s",v:r[c]};else if(o>-1)u={t:"s",v:t[o]};else if(!isNaN(l))u={t:"n",v:l};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return u}function U_(e,t,r){var a=fa(e),n=a.getUint32(8,!0),i=12,s=-1,c=-1,o=NaN,l=NaN,f=new Date(2001,0,1);n&1&&(o=P_(e,i),i+=16),n&2&&(l=a.getFloat64(i,!0),i+=8),n&4&&(f.setTime(f.getTime()+a.getFloat64(i,!0)*1e3),i+=8),n&8&&(c=a.getUint32(i,!0),i+=4),n&16&&(s=a.getUint32(i,!0),i+=4);var u;switch(e[1]){case 0:break;case 2:u={t:"n",v:o};break;case 3:u={t:"s",v:t[c]};break;case 5:u={t:"d",v:f};break;case 6:u={t:"b",v:l>0};break;case 7:u={t:"n",v:l/86400};break;case 8:u={t:"e",v:0};break;case 9:if(s>-1)u={t:"s",v:r[s]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)));break;case 10:u={t:"n",v:o};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)))}return u}function Ri(e,t){var r=new Uint8Array(32),a=fa(r),n=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,L_(r,n,e.v),i|=1,n+=16;break;case"b":r[1]=6,a.setFloat64(n,e.v?1:0,!0),i|=2,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,a.setUint32(n,t.indexOf(e.v),!0),i|=8,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,i,!0),r.slice(0,n)}function Bi(e,t){var r=new Uint8Array(32),a=fa(r),n=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,a.setFloat64(n,e.v,!0),i|=32,n+=8;break;case"b":r[2]=6,a.setFloat64(n,e.v?1:0,!0),i|=32,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,a.setUint32(n,t.indexOf(e.v),!0),i|=16,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,i,!0),r.slice(0,n)}function W_(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return j_(e,t,r,e[0]);case 5:return U_(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Br(e){var t=Ve(e);return xn(t[1][0].data)}function gc(e,t){var r=Ve(t.data),a=fr(r[1][0].data),n=r[3],i=[];return(n||[]).forEach(function(s){var c=Ve(s.data),o=fr(c[1][0].data)>>>0;switch(a){case 1:i[o]=Zi(c[3][0].data);break;case 8:{var l=e[Br(c[9][0].data)][0],f=Ve(l.data),u=e[Br(f[1][0].data)][0],d=fr(u.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var x=Ve(u.data);i[o]=x[3].map(function(g){return Zi(g.data)}).join("")}break}}),i}function V_(e,t){var r,a,n,i,s,c,o,l,f,u,d,x,g,p,m=Ve(e),_=fr(m[1][0].data)>>>0,k=fr(m[2][0].data)>>>0,v=((a=(r=m[8])==null?void 0:r[0])==null?void 0:a.data)&&fr(m[8][0].data)>0||!1,T,b;if((i=(n=m[7])==null?void 0:n[0])!=null&&i.data&&t!=0)T=(c=(s=m[7])==null?void 0:s[0])==null?void 0:c.data,b=(l=(o=m[6])==null?void 0:o[0])==null?void 0:l.data;else if((u=(f=m[4])==null?void 0:f[0])!=null&&u.data&&t!=1)T=(x=(d=m[4])==null?void 0:d[0])==null?void 0:x.data,b=(p=(g=m[3])==null?void 0:g[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var E=v?4:1,y=fa(T),O=[],B=0;B<T.length/2;++B){var j=y.getUint16(B*2,!0);j<65535&&O.push([B,j])}if(O.length!=k)throw"Expected ".concat(k," cells, found ").concat(O.length);var U=[];for(B=0;B<O.length-1;++B)U[O[B][0]]=b.subarray(O[B][1]*E,O[B+1][1]*E);return O.length>=1&&(U[O[O.length-1][0]]=b.subarray(O[O.length-1][1]*E)),{R:_,cells:U}}function H_(e,t){var r,a=Ve(t.data),n=(r=a==null?void 0:a[7])!=null&&r[0]?fr(a[7][0].data)>>>0>0?1:0:-1,i=Vs(a[5],function(s){return V_(s,n)});return{nrows:fr(a[4][0].data)>>>0,data:i.reduce(function(s,c){return s[c.R]||(s[c.R]=[]),c.cells.forEach(function(o,l){if(s[c.R][l])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(l));s[c.R][l]=o}),s},[])}}function $_(e,t,r){var a,n=Ve(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(fr(n[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(i.e.c=(fr(n[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));r["!ref"]=Pe(i);var s=Ve(n[4][0].data),c=gc(e,e[Br(s[4][0].data)][0]),o=(a=s[17])!=null&&a[0]?gc(e,e[Br(s[17][0].data)][0]):[],l=Ve(s[3][0].data),f=0;l[1].forEach(function(u){var d=Ve(u.data),x=e[Br(d[2][0].data)][0],g=fr(x.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var p=H_(e,x);p.data.forEach(function(m,_){m.forEach(function(k,v){var T=be({r:f+_,c:v}),b=W_(k,c,o);b&&(r[T]=b)})}),f+=p.nrows})}function G_(e,t){var r=Ve(t.data),a={"!ref":"A1"},n=e[Br(r[2][0].data)],i=fr(n[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return $_(e,n[0],a),a}function z_(e,t){var r,a=Ve(t.data),n={name:(r=a[1])!=null&&r[0]?Zi(a[1][0].data):"",sheets:[]},i=Vs(a[2],Br);return i.forEach(function(s){e[s].forEach(function(c){var o=fr(c.meta[1][0].data);o==6e3&&n.sheets.push(G_(e,c))})}),n}function X_(e,t){var r=Xs(),a=Ve(t.data),n=Vs(a[1],Br);if(n.forEach(function(i){e[i].forEach(function(s){var c=fr(s.meta[1][0].data);if(c==2){var o=z_(e,s);o.sheets.forEach(function(l,f){Ys(r,l,f==0?o.name:o.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Oi(e){var t,r,a,n,i={},s=[];if(e.FullPaths.forEach(function(o){if(o.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(o){if(o.name.match(/\.iwa$/)){var l;try{l=ot(o.content)}catch(u){return console.log("?? "+o.content.length+" "+(u.message||u))}var f;try{f=ct(l)}catch(u){return console.log("## "+(u.message||u))}f.forEach(function(u){i[u.id]=u.messages,s.push(u.id)})}}),!s.length)throw new Error("File has no messages");var c=((n=(a=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:n[0].data)&&fr(i[1][0].meta[1][0].data)==1&&i[1][0];if(c||s.forEach(function(o){i[o].forEach(function(l){var f=fr(l.meta[1][0].data)>>>0;if(f==1)if(!c)c=l;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return X_(i,c)}function Y_(e,t,r){var a,n,i,s;if(!((a=e[6])!=null&&a[0])||!((n=e[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var c=((s=(i=e[8])==null?void 0:i[0])==null?void 0:s.data)&&fr(e[8][0].data)>0||!1;if(c)throw"Math only works with normal offsets";for(var o=0,l=fa(e[7][0].data),f=0,u=[],d=fa(e[4][0].data),x=0,g=[],p=0;p<t.length;++p){if(t[p]==null){l.setUint16(p*2,65535,!0),d.setUint16(p*2,65535);continue}l.setUint16(p*2,f,!0),d.setUint16(p*2,x,!0);var m,_;switch(typeof t[p]){case"string":m=Ri({t:"s",v:t[p]},r),_=Bi({t:"s",v:t[p]},r);break;case"number":m=Ri({t:"n",v:t[p]},r),_=Bi({t:"n",v:t[p]},r);break;case"boolean":m=Ri({t:"b",v:t[p]},r),_=Bi({t:"b",v:t[p]},r);break;default:throw new Error("Unsupported value "+t[p])}u.push(m),f+=m.length,g.push(_),x+=_.length,++o}for(e[2][0].data=Xe(o);p<e[7][0].data.length/2;++p)l.setUint16(p*2,65535,!0),d.setUint16(p*2,65535,!0);return e[6][0].data=$t(u),e[3][0].data=$t(g),o}function K_(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=Yr(r["!ref"]);a.s.r=a.s.c=0;var n=!1;a.e.c>9&&(n=!0,a.e.c=9),a.e.r>49&&(n=!0,a.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(Pe(a)));var i=ni(r,{range:a,header:1}),s=["~Sh33tJ5~"];i.forEach(function(M){return M.forEach(function(P){typeof P=="string"&&s.push(P)})});var c={},o=[],l=Fe.read(t.numbers,{type:"base64"});l.FileIndex.map(function(M,P){return[M,l.FullPaths[P]]}).forEach(function(M){var P=M[0],D=M[1];if(P.type==2&&P.name.match(/\.iwa/)){var W=P.content,Z=ot(W),se=ct(Z);se.forEach(function(ae){o.push(ae.id),c[ae.id]={deps:[],location:D,type:fr(ae.messages[0].meta[1][0].data)}})}}),o.sort(function(M,P){return M-P});var f=o.filter(function(M){return M>1}).map(function(M){return[M,Xe(M)]});l.FileIndex.map(function(M,P){return[M,l.FullPaths[P]]}).forEach(function(M){var P=M[0];if(M[1],!!P.name.match(/\.iwa/)){var D=ct(ot(P.content));D.forEach(function(W){W.messages.forEach(function(Z){f.forEach(function(se){W.messages.some(function(ae){return fr(ae.meta[1][0].data)!=11006&&O_(ae.data,se[1])})&&c[se[0]].deps.push(W.id)})})})}});for(var u=Fe.find(l,c[1].location),d=ct(ot(u.content)),x,g=0;g<d.length;++g){var p=d[g];p.id==1&&(x=p)}var m=Br(Ve(x.messages[0].data)[1][0].data);for(u=Fe.find(l,c[m].location),d=ct(ot(u.content)),g=0;g<d.length;++g)p=d[g],p.id==m&&(x=p);for(m=Br(Ve(x.messages[0].data)[2][0].data),u=Fe.find(l,c[m].location),d=ct(ot(u.content)),g=0;g<d.length;++g)p=d[g],p.id==m&&(x=p);for(m=Br(Ve(x.messages[0].data)[2][0].data),u=Fe.find(l,c[m].location),d=ct(ot(u.content)),g=0;g<d.length;++g)p=d[g],p.id==m&&(x=p);var _=Ve(x.messages[0].data);{_[6][0].data=Xe(a.e.r+1),_[7][0].data=Xe(a.e.c+1);var k=Br(_[46][0].data),v=Fe.find(l,c[k].location),T=ct(ot(v.content));{for(var b=0;b<T.length&&T[b].id!=k;++b);if(T[b].id!=k)throw"Bad ColumnRowUIDMapArchive";var E=Ve(T[b].messages[0].data);E[1]=[],E[2]=[],E[3]=[];for(var y=0;y<=a.e.c;++y){var O=[];O[1]=O[2]=[{type:0,data:Xe(y+420690)}],E[1].push({type:2,data:br(O)}),E[2].push({type:0,data:Xe(y)}),E[3].push({type:0,data:Xe(y)})}E[4]=[],E[5]=[],E[6]=[];for(var B=0;B<=a.e.r;++B)O=[],O[1]=O[2]=[{type:0,data:Xe(B+726270)}],E[4].push({type:2,data:br(O)}),E[5].push({type:0,data:Xe(B)}),E[6].push({type:0,data:Xe(B)});T[b].messages[0].data=br(E)}v.content=ka(_a(T)),v.size=v.content.length,delete _[46];var j=Ve(_[4][0].data);{j[7][0].data=Xe(a.e.r+1);var U=Ve(j[1][0].data),L=Br(U[2][0].data);v=Fe.find(l,c[L].location),T=ct(ot(v.content));{if(T[0].id!=L)throw"Bad HeaderStorageBucket";var Y=Ve(T[0].messages[0].data);for(B=0;B<i.length;++B){var J=Ve(Y[2][0].data);J[1][0].data=Xe(B),J[4][0].data=Xe(i[B].length),Y[2][B]={type:Y[2][0].type,data:br(J)}}T[0].messages[0].data=br(Y)}v.content=ka(_a(T)),v.size=v.content.length;var Q=Br(j[2][0].data);v=Fe.find(l,c[Q].location),T=ct(ot(v.content));{if(T[0].id!=Q)throw"Bad HeaderStorageBucket";for(Y=Ve(T[0].messages[0].data),y=0;y<=a.e.c;++y)J=Ve(Y[2][0].data),J[1][0].data=Xe(y),J[4][0].data=Xe(a.e.r+1),Y[2][y]={type:Y[2][0].type,data:br(J)};T[0].messages[0].data=br(Y)}v.content=ka(_a(T)),v.size=v.content.length;var ce=Br(j[4][0].data);(function(){for(var M=Fe.find(l,c[ce].location),P=ct(ot(M.content)),D,W=0;W<P.length;++W){var Z=P[W];Z.id==ce&&(D=Z)}var se=Ve(D.messages[0].data);{se[3]=[];var ae=[];s.forEach(function(R,q){ae[1]=[{type:0,data:Xe(q)}],ae[2]=[{type:0,data:Xe(1)}],ae[3]=[{type:2,data:B_(R)}],se[3].push({type:2,data:br(ae)})})}D.messages[0].data=br(se);var ee=_a(P),Ee=ka(ee);M.content=Ee,M.size=M.content.length})();var ne=Ve(j[3][0].data);{var Se=ne[1][0];delete ne[2];var V=Ve(Se.data);{var _e=Br(V[2][0].data);(function(){for(var M=Fe.find(l,c[_e].location),P=ct(ot(M.content)),D,W=0;W<P.length;++W){var Z=P[W];Z.id==_e&&(D=Z)}var se=Ve(D.messages[0].data);{delete se[6],delete ne[7];var ae=new Uint8Array(se[5][0].data);se[5]=[];for(var ee=0,Ee=0;Ee<=a.e.r;++Ee){var R=Ve(ae);ee+=Y_(R,i[Ee],s),R[1][0].data=Xe(Ee),se[5].push({data:br(R),type:2})}se[1]=[{type:0,data:Xe(a.e.c+1)}],se[2]=[{type:0,data:Xe(a.e.r+1)}],se[3]=[{type:0,data:Xe(ee)}],se[4]=[{type:0,data:Xe(a.e.r+1)}]}D.messages[0].data=br(se);var q=_a(P),le=ka(q);M.content=le,M.size=M.content.length})()}Se.data=br(V)}j[3][0].data=br(ne)}_[4][0].data=br(j)}x.messages[0].data=br(_);var ge=_a(d),A=ka(ge);return u.content=A,u.size=u.content.length,l}function tf(e){return function(r){for(var a=0;a!=e.length;++a){var n=e[a];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function Hs(e){tf([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function $s(e){tf([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Q_(e){return je.WS.indexOf(e)>-1?"sheet":e==je.CS?"chart":e==je.DS?"dialog":e==je.MS?"macro":e&&e.length?e:"sheet"}function q_(e,t){if(!e)return 0;try{e=t.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,Q_(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function J_(e,t,r,a,n,i,s,c,o,l,f,u){try{i[a]=Qa(et(e,r,!0),t);var d=mr(e,t),x;switch(c){case"sheet":x=yy(d,t,n,o,i[a],l,f,u);break;case"chart":if(x=_y(d,t,n,o,i[a],l,f,u),!x||!x["!drawel"])break;var g=za(x["!drawel"].Target,t),p=on(g),m=cm(et(e,g,!0),Qa(et(e,p,!0),g)),_=za(m,g),k=on(_);x=Yw(et(e,_,!0),_,o,Qa(et(e,k,!0),_),l,x);break;case"macro":x=ky(d,t,n,o,i[a],l,f,u);break;case"dialog":x=Ty(d,t,n,o,i[a],l,f,u);break;default:throw new Error("Unrecognized sheet type "+c)}s[a]=x;var v=[];i&&i[a]&&hr(i[a]).forEach(function(T){var b="";if(i[a][T].Type==je.CMNT){b=za(i[a][T].Target,t);var E=Ay(mr(e,b,!0),b,o);if(!E||!E.length)return;rc(x,E,!1)}i[a][T].Type==je.TCMNT&&(b=za(i[a][T].Target,t),v=v.concat(lm(mr(e,b,!0),o)))}),v&&v.length&&rc(x,v,!0,o.people||[])}catch(T){if(o.WTF)throw T}}function it(e){return e.charAt(0)=="/"?e.slice(1):e}function Z_(e,t){if(Ra(),t=t||{},Hs(t),lt(e,"META-INF/manifest.xml")||lt(e,"objectdata.xml"))return uc(e,t);if(lt(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Oi<"u"){if(e.FileIndex)return Oi(e);var r=Fe.utils.cfb_new();return k0(e).forEach(function(J){Le(r,J,fd(e,J))}),Oi(r)}throw new Error("Unsupported NUMBERS file")}if(!lt(e,"[Content_Types].xml"))throw lt(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):lt(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=k0(e),n=a1(et(e,"[Content_Types].xml")),i=!1,s,c;if(n.workbooks.length===0&&(c="xl/workbook.xml",mr(e,c,!0)&&n.workbooks.push(c)),n.workbooks.length===0){if(c="xl/workbook.bin",!mr(e,c,!0))throw new Error("Could not find workbook");n.workbooks.push(c),i=!0}n.workbooks[0].slice(-3)=="bin"&&(i=!0);var o={},l={};if(!t.bookSheets&&!t.bookProps){if(qa=[],n.sst)try{qa=Fy(mr(e,it(n.sst)),n.sst,t)}catch(J){if(t.WTF)throw J}t.cellStyles&&n.themes.length&&(o=Sy(et(e,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],t)),n.style&&(l=Ey(mr(e,it(n.style)),n.style,o,t))}n.links.map(function(J){try{var Q=Qa(et(e,on(it(J))),J);return Dy(mr(e,it(J)),Q,J,t)}catch{}});var f=wy(mr(e,it(n.workbooks[0])),n.workbooks[0],t),u={},d="";n.coreprops.length&&(d=mr(e,it(n.coreprops[0]),!0),d&&(u=$o(d)),n.extprops.length!==0&&(d=mr(e,it(n.extprops[0]),!0),d&&f1(d,u,t)));var x={};(!t.bookSheets||t.bookProps)&&n.custprops.length!==0&&(d=et(e,it(n.custprops[0]),!0),d&&(x=u1(d,t)));var g={};if((t.bookSheets||t.bookProps)&&(f.Sheets?s=f.Sheets.map(function(Q){return Q.name}):u.Worksheets&&u.SheetNames.length>0&&(s=u.SheetNames),t.bookProps&&(g.Props=u,g.Custprops=x),t.bookSheets&&typeof s<"u"&&(g.SheetNames=s),t.bookSheets?g.SheetNames:t.bookProps))return g;s={};var p={};t.bookDeps&&n.calcchain&&(p=by(mr(e,it(n.calcchain)),n.calcchain));var m=0,_={},k,v;{var T=f.Sheets;u.Worksheets=T.length,u.SheetNames=[];for(var b=0;b!=T.length;++b)u.SheetNames[b]=T[b].name}var E=i?"bin":"xml",y=n.workbooks[0].lastIndexOf("/"),O=(n.workbooks[0].slice(0,y+1)+"_rels/"+n.workbooks[0].slice(y+1)+".rels").replace(/^\//,"");lt(e,O)||(O="xl/_rels/workbook."+E+".rels");var B=Qa(et(e,O,!0),O.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(t.xlmeta=Cy(mr(e,it(n.metadata[0])),n.metadata[0],t)),(n.people||[]).length>=1&&(t.people=hm(mr(e,it(n.people[0])),t)),B&&(B=q_(B,f.Sheets));var j=mr(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(m=0;m!=u.Worksheets;++m){var U="sheet";if(B&&B[m]?(k="xl/"+B[m][1].replace(/[\/]?xl\//,""),lt(e,k)||(k=B[m][1]),lt(e,k)||(k=O.replace(/_rels\/.*$/,"")+B[m][1]),U=B[m][2]):(k="xl/worksheets/sheet"+(m+1-j)+"."+E,k=k.replace(/sheet0\./,"sheet.")),v=k.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(m!=t.sheets)continue e;break;case"string":if(u.SheetNames[m].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var L=!1,Y=0;Y!=t.sheets.length;++Y)typeof t.sheets[Y]=="number"&&t.sheets[Y]==m&&(L=1),typeof t.sheets[Y]=="string"&&t.sheets[Y].toLowerCase()==u.SheetNames[m].toLowerCase()&&(L=1);if(!L)continue e}}J_(e,k,v,u.SheetNames[m],m,_,s,U,t,f,o,l)}return g={Directory:n,Workbook:f,Props:u,Custprops:x,Deps:p,Sheets:s,SheetNames:u.SheetNames,Strings:qa,Styles:l,Themes:o,SSF:tr(Ae)},t&&t.bookFiles&&(e.files?(g.keys=a,g.files=e.files):(g.keys=[],g.files={},e.FullPaths.forEach(function(J,Q){J=J.replace(/^Root Entry[\/]/,""),g.keys.push(J),g.files[J]=e.FileIndex[Q]}))),t&&t.bookVBA&&(n.vba.length>0?g.vbaraw=mr(e,it(n.vba[0]),!0):n.defaults&&n.defaults.bin===wm&&(g.vbaraw=mr(e,"xl/vbaProject.bin",!0))),g}function ek(e,t){var r=t||{},a="Workbook",n=Fe.find(e,a);try{if(a="/!DataSpaces/Version",n=Fe.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(Cp(n.content),a="/!DataSpaces/DataSpaceMap",n=Fe.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var i=Ip(n.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=Fe.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var s=Rp(n.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=Fe.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);Op(n.content)}catch{}if(a="/EncryptionInfo",n=Fe.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var c=Pp(n.content);if(a="/EncryptedPackage",n=Fe.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],n.content,r.password||"",r);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],n.content,r.password||"",r);throw new Error("File is password-protected")}function rk(e,t){return t.bookType=="ods"?rf(e,t):t.bookType=="numbers"?K_(e,t):t.bookType=="xlsb"?tk(e,t):ak(e,t)}function tk(e,t){Ea=1024,e&&!e.SSF&&(e.SSF=tr(Ae)),e&&e.SSF&&(Ra(),gn(e.SSF),t.revssf=hi(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ja?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",a=Dl.indexOf(t.bookType)>-1,n=Ds();$s(t=t||{});var i=ps(),s="",c=0;if(t.cellXfs=[],Xt(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",Le(i,s,Go(e.Props,t)),n.coreprops.push(s),Ye(t.rels,2,s,je.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var o=[],l=0;l<e.SheetNames.length;++l)(e.Workbook.Sheets[l]||{}).Hidden!=2&&o.push(e.SheetNames[l]);e.Props.SheetNames=o}for(e.Props.Worksheets=e.Props.SheetNames.length,Le(i,s,Yo(e.Props)),n.extprops.push(s),Ye(t.rels,3,s,je.EXT_PROPS),e.Custprops!==e.Props&&hr(e.Custprops||{}).length>0&&(s="docProps/custom.xml",Le(i,s,Ko(e.Custprops)),n.custprops.push(s),Ye(t.rels,4,s,je.CUST_PROPS)),c=1;c<=e.SheetNames.length;++c){var f={"!id":{}},u=e.Sheets[e.SheetNames[c-1]],d=(u||{})["!type"]||"sheet";switch(d){case"chart":default:s="xl/worksheets/sheet"+c+"."+r,Le(i,s,Iy(c-1,s,t,e,f)),n.sheets.push(s),Ye(t.wbrels,-1,"worksheets/sheet"+c+"."+r,je.WS[0])}if(u){var x=u["!comments"],g=!1,p="";x&&x.length>0&&(p="xl/comments"+c+"."+r,Le(i,p,Oy(x,p)),n.comments.push(p),Ye(f,-1,"../comments"+c+"."+r,je.CMNT),g=!0),u["!legacy"]&&g&&Le(i,"xl/drawings/vmlDrawing"+c+".vml",Al(c,u["!comments"])),delete u["!comments"],delete u["!legacy"]}f["!id"].rId1&&Le(i,on(s),Aa(f))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,Le(i,s,By(t.Strings,s,t)),n.strs.push(s),Ye(t.wbrels,-1,"sharedStrings."+r,je.SST)),s="xl/workbook."+r,Le(i,s,Ny(e,s)),n.workbooks.push(s),Ye(t.rels,1,s,je.WB),s="xl/theme/theme1.xml",Le(i,s,Os(e.Themes,t)),n.themes.push(s),Ye(t.wbrels,-1,"theme/theme1.xml",je.THEME),s="xl/styles."+r,Le(i,s,Ry(e,s,t)),n.styles.push(s),Ye(t.wbrels,-1,"styles."+r,je.STY),e.vbaraw&&a&&(s="xl/vbaProject.bin",Le(i,s,e.vbaraw),n.vba.push(s),Ye(t.wbrels,-1,"vbaProject.bin",je.VBA)),s="xl/metadata."+r,Le(i,s,Py(s)),n.metadata.push(s),Ye(t.wbrels,-1,"metadata."+r,je.XLMETA),Le(i,"[Content_Types].xml",Vo(n,t)),Le(i,"_rels/.rels",Aa(t.rels)),Le(i,"xl/_rels/workbook."+r+".rels",Aa(t.wbrels)),delete t.revssf,delete t.ssf,i}function ak(e,t){Ea=1024,e&&!e.SSF&&(e.SSF=tr(Ae)),e&&e.SSF&&(Ra(),gn(e.SSF),t.revssf=hi(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ja?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",a=Dl.indexOf(t.bookType)>-1,n=Ds();$s(t=t||{});var i=ps(),s="",c=0;if(t.cellXfs=[],Xt(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",Le(i,s,Go(e.Props,t)),n.coreprops.push(s),Ye(t.rels,2,s,je.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var o=[],l=0;l<e.SheetNames.length;++l)(e.Workbook.Sheets[l]||{}).Hidden!=2&&o.push(e.SheetNames[l]);e.Props.SheetNames=o}e.Props.Worksheets=e.Props.SheetNames.length,Le(i,s,Yo(e.Props)),n.extprops.push(s),Ye(t.rels,3,s,je.EXT_PROPS),e.Custprops!==e.Props&&hr(e.Custprops||{}).length>0&&(s="docProps/custom.xml",Le(i,s,Ko(e.Custprops)),n.custprops.push(s),Ye(t.rels,4,s,je.CUST_PROPS));var f=["SheetJ5"];for(t.tcid=0,c=1;c<=e.SheetNames.length;++c){var u={"!id":{}},d=e.Sheets[e.SheetNames[c-1]],x=(d||{})["!type"]||"sheet";switch(x){case"chart":default:s="xl/worksheets/sheet"+c+"."+r,Le(i,s,Ul(c-1,t,e,u)),n.sheets.push(s),Ye(t.wbrels,-1,"worksheets/sheet"+c+"."+r,je.WS[0])}if(d){var g=d["!comments"],p=!1,m="";if(g&&g.length>0){var _=!1;g.forEach(function(k){k[1].forEach(function(v){v.T==!0&&(_=!0)})}),_&&(m="xl/threadedComments/threadedComment"+c+"."+r,Le(i,m,fm(g,f,t)),n.threadedcomments.push(m),Ye(u,-1,"../threadedComments/threadedComment"+c+"."+r,je.TCMNT)),m="xl/comments"+c+"."+r,Le(i,m,bl(g)),n.comments.push(m),Ye(u,-1,"../comments"+c+"."+r,je.CMNT),p=!0}d["!legacy"]&&p&&Le(i,"xl/drawings/vmlDrawing"+c+".vml",Al(c,d["!comments"])),delete d["!comments"],delete d["!legacy"]}u["!id"].rId1&&Le(i,on(s),Aa(u))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,Le(i,s,pl(t.Strings,t)),n.strs.push(s),Ye(t.wbrels,-1,"sharedStrings."+r,je.SST)),s="xl/workbook."+r,Le(i,s,Gl(e)),n.workbooks.push(s),Ye(t.rels,1,s,je.WB),s="xl/theme/theme1.xml",Le(i,s,Os(e.Themes,t)),n.themes.push(s),Ye(t.wbrels,-1,"theme/theme1.xml",je.THEME),s="xl/styles."+r,Le(i,s,Tl(e,t)),n.styles.push(s),Ye(t.wbrels,-1,"styles."+r,je.STY),e.vbaraw&&a&&(s="xl/vbaProject.bin",Le(i,s,e.vbaraw),n.vba.push(s),Ye(t.wbrels,-1,"vbaProject.bin",je.VBA)),s="xl/metadata."+r,Le(i,s,Fl()),n.metadata.push(s),Ye(t.wbrels,-1,"metadata."+r,je.XLMETA),f.length>1&&(s="xl/persons/person.xml",Le(i,s,um(f)),n.people.push(s),Ye(t.wbrels,-1,"persons/person.xml",je.PEOPLE)),Le(i,"[Content_Types].xml",Vo(n,t)),Le(i,"_rels/.rels",Aa(t.rels)),Le(i,"xl/_rels/workbook."+r+".rels",Aa(t.wbrels)),delete t.revssf,delete t.ssf,i}function Gs(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=at(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function nk(e,t){return Fe.find(e,"EncryptedPackage")?ek(e,t):Kl(e,t)}function ik(e,t){var r,a=e,n=t||{};return n.type||(n.type=Me&&Buffer.isBuffer(e)?"buffer":"base64"),r=mo(a,n),Z_(r,n)}function af(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return qi(e.slice(r),t);default:break e}return Na.to_workbook(e,t)}function sk(e,t){var r="",a=Gs(e,t);switch(t.type){case"base64":r=at(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=sa(e);break;default:throw new Error("Unrecognized type "+t.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=Qe(r)),t.type="binary",af(r,t)}function ck(e,t){var r=e;return t.type=="base64"&&(r=at(r)),r=rn.utils.decode(1200,r.slice(2),"str"),t.type="binary",af(r,t)}function ok(e){return e.match(/[^\x00-\x7F]/)?kt(e):e}function Pi(e,t,r,a){return a?(r.type="string",Na.to_workbook(e,r)):Na.to_workbook(t,r)}function ha(e,t){fs();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return ha(new Uint8Array(e),(r=tr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=e,n=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Da={},r.dateNF&&(Da.dateNF=r.dateNF),r.type||(r.type=Me&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Me?"buffer":"binary",a=td(e),typeof Uint8Array<"u"&&!Me&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,a=ok(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),c=new Uint8Array(s);if(c.foo="bar",!c.foo)return r=tr(r),r.type="array",ha(hs(a),r)}switch((n=Gs(a,r))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return nk(Fe.read(a,r),r);break;case 9:if(n[1]<=8)return Kl(a,r);break;case 60:return qi(a,r);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return dp(a,r);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return dl.to_workbook(a,r);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?ik(a,r):Pi(e,a,r,i);case 239:return n[3]===60?qi(a,r):Pi(e,a,r,i);case 255:if(n[1]===254)return ck(a,r);if(n[1]===0&&n[2]===2&&n[3]===0)return ea.to_workbook(a,r);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return ea.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return Qi.to_workbook(a,r);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return yl.to_workbook(a,r);break;case 10:case 13:case 32:return sk(a,r);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return up.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?Qi.to_workbook(a,r):Pi(e,a,r,i)}function nf(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return mn(t.file,Fe.write(e,{type:Me?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Fe.write(e,t)}function lk(e,t){var r=tr(t||{}),a=rk(e,r);return fk(a,r)}function fk(e,t){var r={},a=Me?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+t.type)}var n=e.FullPaths?Fe.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof n=="string"){if(t.type=="binary"||t.type=="base64")return n;n=new Uint8Array(li(n))}return t.password&&typeof encrypt_agile<"u"?nf(encrypt_agile(n,t.password),t):t.type==="file"?mn(t.file,n):t.type=="string"?Qe(n):n}function hk(e,t){var r=t||{},a=o_(e,r);return nf(a,r)}function _t(e,t,r){r||(r="");var a=r+e;switch(t.type){case"base64":return tn(kt(a));case"binary":return kt(a);case"string":return e;case"file":return mn(t.file,a,"utf8");case"buffer":return Me?Bt(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):_t(a,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function uk(e,t){switch(t.type){case"base64":return tn(e);case"binary":return e;case"string":return e;case"file":return mn(t.file,e,"binary");case"buffer":return Me?Bt(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Mn(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return t.type=="base64"?tn(r):t.type=="string"?Qe(r):r;case"file":return mn(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function sf(e,t){fs(),ny(e);var r=tr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=sf(e,r);return r.type="array",li(a)}var n=0;if(r.sheet&&(typeof r.sheet=="number"?n=r.sheet:n=e.SheetNames.indexOf(r.sheet),!e.SheetNames[n]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return _t(r_(e,r),r);case"slk":case"sylk":return _t(ul.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"htm":case"html":return _t(ql(e.Sheets[e.SheetNames[n]],r),r);case"txt":return uk(cf(e.Sheets[e.SheetNames[n]],r),r);case"csv":return _t(zs(e.Sheets[e.SheetNames[n]],r),r,"\uFEFF");case"dif":return _t(dl.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"dbf":return Mn(Qi.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"prn":return _t(Na.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"rtf":return _t(yl.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"eth":return _t(xl.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"fods":return _t(rf(e,r),r);case"wk1":return Mn(ea.sheet_to_wk1(e.Sheets[e.SheetNames[n]],r),r);case"wk3":return Mn(ea.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Mn(Ql(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),hk(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return lk(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function dk(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function ua(e,t,r){var a={};return a.type="file",a.file=t,dk(a),sf(e,a)}function xk(e,t,r,a,n,i,s,c){var o=xr(r),l=c.defval,f=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),u=!0,d=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!s||e[r])for(var x=t.s.c;x<=t.e.c;++x){var g=s?e[r][x]:e[a[x]+o];if(g===void 0||g.t===void 0){if(l===void 0)continue;i[x]!=null&&(d[i[x]]=l);continue}var p=g.v;switch(g.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(i[x]!=null){if(p==null)if(g.t=="e"&&p===null)d[i[x]]=null;else if(l!==void 0)d[i[x]]=l;else if(f&&p===null)d[i[x]]=null;else continue;else d[i[x]]=f&&(g.t!=="n"||g.t==="n"&&c.rawNumbers!==!1)?p:Rt(g,p,c);p!=null&&(u=!1)}}return{row:d,isempty:u}}function ni(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},a=0,n=1,i=[],s=0,c="",o={s:{r:0,c:0},e:{r:0,c:0}},l=t||{},f=l.range!=null?l.range:e["!ref"];switch(l.header===1?a=1:l.header==="A"?a=2:Array.isArray(l.header)?a=3:l.header==null&&(a=0),typeof f){case"string":o=We(f);break;case"number":o=We(e["!ref"]),o.s.r=f;break;default:o=f}a>0&&(n=0);var u=xr(o.s.r),d=[],x=[],g=0,p=0,m=Array.isArray(e),_=o.s.r,k=0,v={};m&&!e[_]&&(e[_]=[]);var T=l.skipHidden&&e["!cols"]||[],b=l.skipHidden&&e["!rows"]||[];for(k=o.s.c;k<=o.e.c;++k)if(!(T[k]||{}).hidden)switch(d[k]=sr(k),r=m?e[_][k]:e[d[k]+u],a){case 1:i[k]=k-o.s.c;break;case 2:i[k]=d[k];break;case 3:i[k]=l.header[k-o.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),c=s=Rt(r,null,l),p=v[s]||0,!p)v[s]=1;else{do c=s+"_"+p++;while(v[c]);v[s]=p,v[c]=1}i[k]=c}for(_=o.s.r+n;_<=o.e.r;++_)if(!(b[_]||{}).hidden){var E=xk(e,o,_,d,a,i,m,l);(E.isempty===!1||(a===1?l.blankrows!==!1:l.blankrows))&&(x[g++]=E.row)}return x.length=g,x}var mc=/"/g;function pk(e,t,r,a,n,i,s,c){for(var o=!0,l=[],f="",u=xr(r),d=t.s.c;d<=t.e.c;++d)if(a[d]){var x=c.dense?(e[r]||[])[d]:e[a[d]+u];if(x==null)f="";else if(x.v!=null){o=!1,f=""+(c.rawNumbers&&x.t=="n"?x.v:Rt(x,null,c));for(var g=0,p=0;g!==f.length;++g)if((p=f.charCodeAt(g))===n||p===i||p===34||c.forceQuotes){f='"'+f.replace(mc,'""')+'"';break}f=="ID"&&(f='"ID"')}else x.f!=null&&!x.F?(o=!1,f="="+x.f,f.indexOf(",")>=0&&(f='"'+f.replace(mc,'""')+'"')):f="";l.push(f)}return c.blankrows===!1&&o?null:l.join(s)}function zs(e,t){var r=[],a=t??{};if(e==null||e["!ref"]==null)return"";var n=We(e["!ref"]),i=a.FS!==void 0?a.FS:",",s=i.charCodeAt(0),c=a.RS!==void 0?a.RS:`
`,o=c.charCodeAt(0),l=new RegExp((i=="|"?"\\|":i)+"+$"),f="",u=[];a.dense=Array.isArray(e);for(var d=a.skipHidden&&e["!cols"]||[],x=a.skipHidden&&e["!rows"]||[],g=n.s.c;g<=n.e.c;++g)(d[g]||{}).hidden||(u[g]=sr(g));for(var p=0,m=n.s.r;m<=n.e.r;++m)(x[m]||{}).hidden||(f=pk(e,n,m,u,s,o,i,a),f!=null&&(a.strip&&(f=f.replace(l,"")),(f||a.blankrows!==!1)&&r.push((p++?c:"")+f)));return delete a.dense,r.join("")}function cf(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=zs(e,t);return r}function gk(e){var t="",r,a="";if(e==null||e["!ref"]==null)return[];var n=We(e["!ref"]),i="",s=[],c,o=[],l=Array.isArray(e);for(c=n.s.c;c<=n.e.c;++c)s[c]=sr(c);for(var f=n.s.r;f<=n.e.r;++f)for(i=xr(f),c=n.s.c;c<=n.e.c;++c)if(t=s[c]+i,r=l?(e[f]||[])[c]:e[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}o[o.length]=t+"="+a}return o}function of(e,t,r){var a=r||{},n=+!a.skipHeader,i=e||{},s=0,c=0;if(i&&a.origin!=null)if(typeof a.origin=="number")s=a.origin;else{var o=typeof a.origin=="string"?cr(a.origin):a.origin;s=o.r,c=o.c}var l,f={s:{c:0,r:0},e:{c,r:s+t.length-1+n}};if(i["!ref"]){var u=We(i["!ref"]);f.e.c=Math.max(f.e.c,u.e.c),f.e.r=Math.max(f.e.r,u.e.r),s==-1&&(s=u.e.r+1,f.e.r=s+t.length-1+n)}else s==-1&&(s=0,f.e.r=t.length-1+n);var d=a.header||[],x=0;t.forEach(function(p,m){hr(p).forEach(function(_){(x=d.indexOf(_))==-1&&(d[x=d.length]=_);var k=p[_],v="z",T="",b=be({c:c+x,r:s+m+n});l=pn(i,b),k&&typeof k=="object"&&!(k instanceof Date)?i[b]=k:(typeof k=="number"?v="n":typeof k=="boolean"?v="b":typeof k=="string"?v="s":k instanceof Date?(v="d",a.cellDates||(v="n",k=_r(k)),T=a.dateNF||Ae[14]):k===null&&a.nullError&&(v="e",k=0),l?(l.t=v,l.v=k,delete l.w,delete l.R,T&&(l.z=T)):i[b]=l={t:v,v:k},T&&(l.z=T))})}),f.e.c=Math.max(f.e.c,c+d.length-1);var g=xr(s);if(n)for(x=0;x<d.length;++x)i[sr(x+c)+g]={t:"s",v:d[x]};return i["!ref"]=Pe(f),i}function mk(e,t){return of(null,e,t)}function pn(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var a=cr(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?pn(e,be(t)):pn(e,be({r:t,c:r||0}))}function vk(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Xs(){return{SheetNames:[],Sheets:{}}}function Ys(e,t,r,a){var n=1;if(!r)for(;n<=65535&&e.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);n=i&&+i[2]||0;var s=i&&i[1]||r;for(++n;n<=65535&&e.SheetNames.indexOf(r=s+n)!=-1;++n);}if($l(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function wk(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=vk(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r}function yk(e,t){return e.z=t,e}function lf(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function _k(e,t,r){return lf(e,"#"+t,r)}function kk(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function Tk(e,t,r,a){for(var n=typeof t!="string"?t:We(t),i=typeof t=="string"?t:Pe(t),s=n.s.r;s<=n.e.r;++s)for(var c=n.s.c;c<=n.e.c;++c){var o=pn(e,s,c);o.t="n",o.F=i,delete o.v,s==n.s.r&&c==n.s.c&&(o.f=r,a&&(o.D=!0))}return e}var $e={encode_col:sr,encode_row:xr,encode_cell:be,encode_range:Pe,decode_col:Ts,decode_row:ks,split_cell:Bd,decode_cell:cr,decode_range:Yr,format_cell:Rt,sheet_add_aoa:Oo,sheet_add_json:of,sheet_add_dom:Jl,aoa_to_sheet:Ba,json_to_sheet:mk,table_to_sheet:Zl,table_to_book:C_,sheet_to_csv:zs,sheet_to_txt:cf,sheet_to_json:ni,sheet_to_html:ql,sheet_to_formulae:gk,sheet_to_row_object_array:ni,sheet_get_cell:pn,book_new:Xs,book_append_sheet:Ys,book_set_sheet_visibility:wk,cell_set_number_format:yk,cell_set_hyperlink:lf,cell_set_internal_link:_k,cell_add_comment:kk,sheet_set_array_formula:Tk,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Ek={MANIKGARH:"MANIGARH"},vc={ORIENT:"dynamic",ULTRATECH:"dynamic",MANIGARH:{DispatchDate:5,Qty:3,ChallanNo:8,VehicleNo:6,PartyName:1,Destination:2,Advance:10,Diesel:9},ACC:{DispatchDate:0,Qty:5,ChallanNo:2,VehicleNo:3,PartyName:4,Destination:6,Advance:7,Diesel:8},"ACC MARATHA":{DispatchDate:0,Qty:5,ChallanNo:2,VehicleNo:3,PartyName:4,Destination:6,Advance:7,Diesel:8},AMBUJA:{DispatchDate:0,Qty:5,ChallanNo:2,VehicleNo:3,PartyName:4,Destination:6,Advance:7,Diesel:8},DALMIA:{DispatchDate:0,Qty:5,ChallanNo:2,VehicleNo:3,PartyName:4,Destination:6,Advance:7,Diesel:8},"MP BIRLA":{DispatchDate:0,Qty:5,ChallanNo:2,VehicleNo:3,PartyName:4,Destination:6,Advance:7,Diesel:8},JSW:{VehicleNo:0,Qty:1,PartyName:3,Destination:4,ChallanNo:6,DispatchDate:7,Diesel:8,Advance:9}},Sk=e=>{if(!e)return null;if(typeof e=="number"){const t=fo.parse_date_code(e);return t?new Date(t.y,t.m-1,t.d):null}if(typeof e=="string"){const t=e.trim().replace(/\./g,"-").replace(/\//g,"-").split("-");if(t.length===3){let[r,a,n]=t.map(Number);n<100&&(n+=2e3);let i,s;return r>12?(i=r,s=a):a>12?(i=a,s=r):(i=r,s=a),new Date(n,s-1,i)}}return null},Fk=(e="")=>e.toString().replace(/\s+/g,"").toUpperCase(),wc=(e="")=>{const t=Fk(e).match(/(\d{4})$/);return t?t[1]:null},Ak=e=>String(e||"").trim().toUpperCase(),bk=()=>{const[e,t]=ie.useState(""),[r,a]=ie.useState(null),[n,i]=ie.useState(""),[s,c]=ie.useState([]),[o,l]=ie.useState(!1);ie.useEffect(()=>{(async()=>{const p=(await or(qe(Ie,"VehicleMaster"))).docs.map(m=>({id:m.id,VehicleNo:m.data().VehicleNo,last4:wc(m.data().VehicleNo)}));c(p)})()},[]);const f=async(x,g)=>{const p=rt(qe(Ie,"TblDispatch"),Sr("ChallanNo","==",x),Sr("FactoryName","==",g));return!(await or(p)).empty},u=async x=>{if(x.preventDefault(),l(!0),i(""),!r||!e){i("‚ùå File and Factory required"),l(!1);return}let g=e.toUpperCase().trim();g=Ek[g]||g;try{const p=await r.arrayBuffer(),m=ha(p),_=m.Sheets[m.SheetNames[0]],k=$e.sheet_to_json(_,{header:1});let v=[],T=null;if(vc[g]==="dynamic"){const y=k[1];T={},y.forEach((O,B)=>{O&&(T[String(O).trim().toUpperCase()]=B)}),v=k.slice(2)}else T=vc[g],v=k;const b=new Set;let E=0;for(const y of v){if(!y||y.every(ce=>!ce))continue;const O=Number(y[T.Qty]||0);if(O<=0)continue;const B=y[T.DispatchDate],j=Sk(B);if(!j)continue;const U=wc(y[T.VehicleNo]);if(!U)continue;const L=s.find(ce=>ce.last4===U);if(!L)continue;const Y=Ak(y[T.ChallanNo]);if(!Y||b.has(Y)||await f(Y,g))continue;b.add(Y);let J="";g==="ORIENT"?J=y[T["SHIP TO PARTY NAME"]]||"":g==="ULTRATECH"?J=y[T["SOLD-TO-PARTY NAME"]]||"":J=y[T.PartyName]||"";const Q={DispatchDate:j,ChallanNo:Y,VehicleNo:L.VehicleNo,VehicleId:L.id,PartyName:String(J).trim(),Destination:y[T.Destination],DispatchQuantity:O,Advance:Number(y[T.Advance]||0),Diesel:Number(y[T.Diesel]||0),FactoryName:g,CreatedOn:new Date};await ta(qe(Ie,"TblDispatch"),Q),E++}i(`‚úÖ ${E} rows uploaded successfully`)}catch(p){console.error(p),i("‚ùå Upload failed")}finally{l(!1)}},d=x=>x.includes("‚úÖ")?"success":x.includes("‚ùå")?"error":"";return h.jsxs("div",{className:"upload-container",children:[h.jsx("div",{className:"upload-header",children:h.jsx("h3",{children:"Upload Dispatch Data"})}),n&&h.jsx("div",{className:`message ${d(n)}`,children:n}),h.jsxs("form",{className:"upload-form",onSubmit:u,children:[h.jsxs("div",{className:"form-group",children:[h.jsx("label",{className:"form-label",children:"Factory Name"}),h.jsxs("select",{className:"form-select",value:e,onChange:x=>t(x.target.value),required:!0,disabled:o,children:[h.jsx("option",{value:"",children:"-- Select Factory --"}),h.jsx("option",{children:"ACC MARATHA"}),h.jsx("option",{children:"AMBUJA"}),h.jsx("option",{children:"DALMIA"}),h.jsx("option",{children:"MP BIRLA"}),h.jsx("option",{children:"ORIENT"}),h.jsx("option",{children:"MANIKGARH"}),h.jsx("option",{children:"ULTRATECH"}),h.jsx("option",{children:"JSW"})]})]}),h.jsxs("div",{className:"form-group",children:[h.jsx("label",{className:"form-label",children:"Excel File"}),h.jsx("div",{className:"form-file",children:h.jsxs("label",{className:"file-label",children:[h.jsx("span",{children:r?"Change File":"Choose Excel file"}),h.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:x=>a(x.target.files[0]),required:!0,disabled:o}),h.jsx("div",{className:"file-name",children:r?r.name:"No file chosen"})]})})]}),h.jsx("button",{type:"submit",className:"upload-button",disabled:o,children:o?h.jsxs(h.Fragment,{children:[h.jsx("span",{className:"loading-spinner"}),"Uploading..."]}):"Upload Data"})]}),h.jsxs("div",{className:"instructions",children:[h.jsx("h4",{children:"Instructions:"}),h.jsxs("ul",{children:[h.jsx("li",{children:"Select the factory name from the dropdown"}),h.jsx("li",{children:"Choose an Excel file (.xlsx or .xls format)"}),h.jsx("li",{children:"System will automatically map columns based on factory format"}),h.jsx("li",{children:"Duplicate challan numbers will be skipped"}),h.jsx("li",{children:"Only vehicles registered in the system will be processed"})]})]})]})},Dk=async e=>(await or(qe(Ie,e))).docs.map(r=>({id:r.id,...r.data()})),yc=async(e,t)=>({id:(await ta(qe(Ie,e),t)).id,...t}),Ck=async(e,t,r)=>{const a=yr(Ie,e,t);await Et(a,r)},Nk=async(e,t)=>{const r=yr(Ie,e,t);await It(r)},Ik=()=>{const[e,t]=ie.useState([]),[r,a]=ie.useState(""),[n,i]=ie.useState(""),[s,c]=ie.useState(null),[o,l]=ie.useState({code:"",name:""}),[f,u]=ie.useState(""),d=async()=>{try{const T=await Dk("destinations");t(T||[])}catch(T){console.error("Error loading destinations:",T)}};ie.useEffect(()=>{d()},[]);const x=async()=>{if(!r||!n)return alert("Code and Name required");if(e.some(b=>b.code.toUpperCase()===r.toUpperCase()))return alert("Destination code already exists");try{const b=await yc("destinations",{code:r.toUpperCase(),name:n});t(E=>[...E,{id:b.id,code:r.toUpperCase(),name:n}]),a(""),i("")}catch(b){console.error("Add failed:",b)}},g=T=>{c(T.id),l({code:T.code,name:T.name})},p=async T=>{if(!o.code||!o.name)return alert("Code and Name required");if(e.some(E=>E.code.toUpperCase()===o.code.toUpperCase()&&E.id!==T))return alert("Destination code already exists");try{await Ck("destinations",T,{code:o.code.toUpperCase(),name:o.name}),t(E=>E.map(y=>y.id===T?{...y,code:o.code.toUpperCase(),name:o.name}:y)),c(null)}catch(E){console.error("Edit failed:",E)}},m=()=>c(null),_=async T=>{try{await Nk("destinations",T),t(b=>b.filter(E=>E.id!==T))}catch(b){console.error("Delete failed:",b)}},k=async T=>{const b=T.target.files[0];if(!b)return;const E=new FileReader;E.onload=async y=>{var Q,ce;const O=new Uint8Array(y.target.result),B=ha(O,{type:"array"}),j=B.Sheets[B.SheetNames[0]],U=$e.sheet_to_json(j);if(!U.length)return alert("Excel file is empty");let L=0,Y=0;const J=[];for(const ne of U){const Se=(Q=ne.Code)==null?void 0:Q.toString().toUpperCase(),V=(ce=ne.Name)==null?void 0:ce.toString();if(!Se||!V){Y++;continue}if(e.some(ge=>ge.code.toUpperCase()===Se)){Y++;continue}try{const ge=await yc("destinations",{code:Se,name:V});J.push({id:ge.id,code:Se,name:V}),L++}catch(ge){console.error("Excel add failed:",ge),Y++}}alert(`Upload completed ‚úÖ Added: ${L}, Skipped: ${Y}`),t(ne=>[...ne,...J]),T.target.value=""},E.readAsArrayBuffer(b)},v=e.filter(T=>T.code.toLowerCase().includes(f.toLowerCase())||T.name.toLowerCase().includes(f.toLowerCase()));return h.jsxs("div",{children:[h.jsx("h2",{children:"Destination Master"}),h.jsx("input",{placeholder:"Search by Code or Name",value:f,onChange:T=>u(T.target.value),style:{marginBottom:10}}),h.jsxs("div",{style:{marginBottom:10},children:[h.jsx("input",{placeholder:"Code (e.g. HYD)",value:r,onChange:T=>a(T.target.value.toUpperCase())}),h.jsx("input",{placeholder:"Destination Name",value:n,onChange:T=>i(T.target.value)}),h.jsx("button",{onClick:x,children:"Add Destination"})]}),h.jsx("hr",{}),h.jsx("h4",{children:"Upload Destination (Excel)"}),h.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:k}),h.jsxs("p",{children:[h.jsx("b",{children:"Excel Format:"})," Code | Name"]}),h.jsx("hr",{}),h.jsxs("table",{border:"1",cellPadding:"6",children:[h.jsx("thead",{children:h.jsxs("tr",{children:[h.jsx("th",{children:"Code"}),h.jsx("th",{children:"Name"}),h.jsx("th",{children:"Action"})]})}),h.jsx("tbody",{children:v.length>0?v.map(T=>h.jsxs("tr",{children:[h.jsx("td",{children:s===T.id?h.jsx("input",{value:o.code,onChange:b=>l({...o,code:b.target.value.toUpperCase()})}):T.code}),h.jsx("td",{children:s===T.id?h.jsx("input",{value:o.name,onChange:b=>l({...o,name:b.target.value})}):T.name}),h.jsx("td",{children:s===T.id?h.jsxs(h.Fragment,{children:[h.jsx("button",{onClick:()=>p(T.id),children:"Save"})," ",h.jsx("button",{onClick:m,children:"Cancel"})]}):h.jsxs(h.Fragment,{children:[h.jsx("button",{onClick:()=>g(T),children:"Edit"})," ",h.jsx("button",{onClick:()=>_(T.id),children:"Delete"})]})})]},T.id)):h.jsx("tr",{children:h.jsx("td",{colSpan:"3",children:"No destinations found"})})})]})]})},Rk={10:"JSW",6:"Manigar",7:"Ultratech"},Ua=["ChallanNo","Destination","VehicleNo","DispatchDate","DispatchQuantity","PartyName","Advance","Diesel","FactoryName"],Li=e=>{if(!e)return null;const t=new Date(e);return t.setHours(0,0,0,0),t},Mi=e=>{if(!e)return"";const t=new Date(e),r=String(t.getDate()).padStart(2,"0"),a=String(t.getMonth()+1).padStart(2,"0"),n=t.getFullYear().toString().slice(-2);return`${r}-${a}-${n}`},_c=e=>{if(!e)return"";const t=new Date(e),r=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return`${r}-${a}-${n}`},Bk=()=>{const[e,t]=ie.useState([]),[r,a]=ie.useState(""),[n,i]=ie.useState([]),[s,c]=ie.useState(1),[o,l]=ie.useState(""),[f,u]=ie.useState(""),[d,x]=ie.useState(""),[g,p]=ie.useState(!1),[m,_]=ie.useState({searchTerm:"",filterFactory:"",fromDate:"",toDate:""}),[k,v]=ie.useState(null),[T,b]=ie.useState(""),E=10;ie.useEffect(()=>{const D=async()=>{if(vt.currentUser){const Z=await vt.currentUser.getIdTokenResult();p(!!Z.claims.admin)}},W=async()=>{const se=(await or(qe(Ie,"TblDispatch"))).docs.map(ae=>{const ee={id:ae.id,...ae.data()};if(ee.DisVid=String(ee.DisVid||""),ee.DispatchDate){const Ee=ee.DispatchDate.seconds?new Date(ee.DispatchDate.seconds*1e3):new Date(ee.DispatchDate);ee.DispatchDate=new Date(Ee.getFullYear(),Ee.getMonth(),Ee.getDate())}return ee.FactoryName=ee.FactoryName||Rk[ee.DisVid]||"",ee});t(se)};D(),W()},[]);const y=()=>{_({searchTerm:r,filterFactory:o,fromDate:f,toDate:d}),c(1)},O=()=>{a(""),l(""),u(""),x(""),_({searchTerm:"",filterFactory:"",fromDate:"",toDate:""}),c(1)},B=D=>{v(D.id),b(D.ChallanNo||"")},j=async D=>{await Et(yr(Ie,"TblDispatch",D),{ChallanNo:T}),t(W=>W.map(Z=>Z.id===D?{...Z,ChallanNo:T}:Z)),v(null),b("")},U=()=>{v(null),b("")},L=async D=>{g&&window.confirm("Delete this record?")&&(await It(yr(Ie,"TblDispatch",D)),t(W=>W.filter(Z=>Z.id!==D)),i(W=>W.filter(Z=>Z!==D)))},Y=async()=>{if(!(!g||!n.length)&&window.confirm(`Delete ${n.length} records?`)){for(let D of n)await It(yr(Ie,"TblDispatch",D));t(D=>D.filter(W=>!n.includes(W.id))),i([])}},J=D=>{i(W=>W.includes(D)?W.filter(Z=>Z!==D):[...W,D])},Q=e.filter(D=>{const{searchTerm:W,filterFactory:Z,fromDate:se,toDate:ae}=m;if(!W&&!Z&&!se&&!ae)return!0;const ee=W.toLowerCase().trim().split(/\s+/).filter(Boolean),Ee=ee.length===0?!0:ee.every(H=>Object.values(D).some(we=>we?we instanceof Date?Mi(we).toLowerCase().includes(H):we.toString().toLowerCase().includes(H):!1)),R=Z?D.DisVid===Z:!0,q=Li(D.DispatchDate),le=se?Li(new Date(se)):null,ve=ae?Li(new Date(ae)):null;let Te=!0,fe=!0;if(le&&q&&(Te=q.getTime()>=le.getTime()),ve&&q){const H=new Date(ve);H.setDate(H.getDate()+1),fe=q.getTime()<H.getTime()}return Ee&&R&&Te&&fe}),ce=e.length,ne=Q.length,Se=Math.ceil(ne/E),V=(s-1)*E,_e=Math.min(V+E,ne),ge=Q.slice(V,V+E),A=ge.length>0&&ge.every(D=>n.includes(D.id)),M=()=>{i(A?D=>D.filter(W=>!ge.some(Z=>Z.id===W)):D=>[...new Set([...D,...ge.map(W=>W.id)])])},P=()=>{if(!Q.length)return;const D=Q.map(se=>{const ae={};return Ua.forEach(ee=>{ae[ee]=se[ee]instanceof Date?Mi(se[ee]):se[ee]}),ae}),W=$e.json_to_sheet(D),Z=$e.book_new();$e.book_append_sheet(Z,W,"Dispatch"),ua(Z,"Dispatch_Data.xlsx")};return h.jsxs("div",{style:{padding:20},children:[h.jsx("h2",{children:"Dispatch Data"}),h.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center",marginBottom:15},children:[h.jsx("input",{placeholder:"Search...",value:r,onChange:D=>a(D.target.value),style:{padding:8,border:"1px solid #ccc",borderRadius:4}}),h.jsxs("select",{value:o,onChange:D=>l(D.target.value),style:{padding:8,border:"1px solid #ccc",borderRadius:4},children:[h.jsx("option",{value:"",children:"All Factories"}),h.jsx("option",{value:"10",children:"JSW"}),h.jsx("option",{value:"6",children:"Manigar"}),h.jsx("option",{value:"7",children:"Ultratech"})]}),h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:5},children:[h.jsx("label",{children:"From:"}),h.jsx("input",{type:"date",value:_c(f),onChange:D=>{const W=D.target.value;if(W){const[Z,se,ae]=W.split("-"),ee=new Date(Z,se-1,ae);u(ee)}else u("")},style:{padding:8,border:"1px solid #ccc",borderRadius:4}})]}),h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:5},children:[h.jsx("label",{children:"To:"}),h.jsx("input",{type:"date",value:_c(d),onChange:D=>{const W=D.target.value;if(W){const[Z,se,ae]=W.split("-"),ee=new Date(Z,se-1,ae);x(ee)}else x("")},style:{padding:8,border:"1px solid #ccc",borderRadius:4}})]}),h.jsx("button",{onClick:y,style:{padding:"8px 16px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:4,cursor:"pointer"},children:"Apply Filters"}),h.jsx("button",{onClick:O,style:{padding:"8px 16px",backgroundColor:"#6c757d",color:"white",border:"none",borderRadius:4,cursor:"pointer"},children:"Clear Filters"}),h.jsx("button",{onClick:P,style:{padding:"8px 16px",backgroundColor:"#28a745",color:"white",border:"none",borderRadius:4,cursor:"pointer"},children:"Export Excel"})]}),g&&n.length>0&&h.jsxs("button",{onClick:Y,style:{marginTop:10,padding:"8px 16px",backgroundColor:"#dc3545",color:"white",border:"none",borderRadius:4,cursor:"pointer"},children:["Delete Selected (",n.length,")"]}),h.jsx("div",{style:{overflowX:"auto",marginTop:20},children:h.jsxs("table",{border:"1",width:"100%",style:{borderCollapse:"collapse"},children:[h.jsx("thead",{children:h.jsxs("tr",{style:{backgroundColor:"#f2f2f2"},children:[g&&h.jsx("th",{style:{padding:10},children:h.jsx("input",{type:"checkbox",checked:A,onChange:M})}),Ua.map(D=>h.jsx("th",{style:{padding:10,textAlign:"left"},children:D},D)),g&&h.jsx("th",{style:{padding:10},children:"Action"})]})}),h.jsx("tbody",{children:ge.length>0?ge.map(D=>h.jsxs("tr",{style:{borderBottom:"1px solid #ddd"},children:[g&&h.jsx("td",{style:{padding:10,textAlign:"center"},children:h.jsx("input",{type:"checkbox",checked:n.includes(D.id),onChange:()=>J(D.id)})}),Ua.map(W=>h.jsx("td",{style:{padding:10},children:W==="ChallanNo"&&k===D.id?h.jsx("input",{value:T,onChange:Z=>b(Z.target.value),style:{padding:4,width:"100%"}}):W==="DispatchDate"?Mi(D[W]):D[W]},W)),g&&h.jsx("td",{style:{padding:10},children:k===D.id?h.jsxs(h.Fragment,{children:[h.jsx("button",{onClick:()=>j(D.id),style:{marginRight:5,padding:"5px 10px",backgroundColor:"#28a745",color:"white",border:"none",borderRadius:3,cursor:"pointer"},children:"Save"}),h.jsx("button",{onClick:U,style:{padding:"5px 10px",backgroundColor:"#6c757d",color:"white",border:"none",borderRadius:3,cursor:"pointer"},children:"Cancel"})]}):h.jsxs(h.Fragment,{children:[h.jsx("button",{onClick:()=>B(D),style:{marginRight:5,padding:"5px 10px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:3,cursor:"pointer"},children:"Edit"}),h.jsx("button",{onClick:()=>L(D.id),style:{padding:"5px 10px",backgroundColor:"#dc3545",color:"white",border:"none",borderRadius:3,cursor:"pointer"},children:"Delete"})]})})]},D.id)):h.jsx("tr",{children:h.jsx("td",{colSpan:g?Ua.length+2:Ua.length,style:{padding:20,textAlign:"center"},children:"No records found"})})})]})}),h.jsxs("div",{style:{marginTop:20,fontWeight:"bold",color:"#333"},children:["Showing ",ne===0?0:V+1,"‚Äì",_e," of"," ",ne," filtered records (Total in DB: ",ce,")"]}),Se>1&&h.jsxs("div",{style:{marginTop:20,display:"flex",alignItems:"center",gap:5},children:[h.jsx("button",{disabled:s===1,onClick:()=>c(D=>D-1),style:{padding:"8px 12px",backgroundColor:s===1?"#e9ecef":"#007bff",color:s===1?"#6c757d":"white",border:"none",borderRadius:4,cursor:s===1?"not-allowed":"pointer"},children:"Prev"}),[...Array(Se)].map((D,W)=>h.jsx("button",{onClick:()=>c(W+1),style:{padding:"8px 12px",backgroundColor:s===W+1?"#0056b3":"#007bff",color:"white",border:"none",borderRadius:4,cursor:"pointer",fontWeight:s===W+1?"bold":"normal"},children:W+1},W)),h.jsx("button",{disabled:s===Se,onClick:()=>c(D=>D+1),style:{padding:"8px 12px",backgroundColor:s===Se?"#e9ecef":"#007bff",color:s===Se?"#6c757d":"white",border:"none",borderRadius:4,cursor:s===Se?"not-allowed":"pointer"},children:"Next"})]})]})},Ok=()=>{const[e,t]=ie.useState(""),[r,a]=ie.useState(""),[n,i]=ie.useState([]),[s,c]=ie.useState(null),[o,l]=ie.useState(!1),[f,u]=ie.useState(""),[d,x]=ie.useState(""),[g,p]=ie.useState(1),m=10,_=qe(Ie,"VehicleMaster"),k=async()=>{const ce=(await or(_)).docs.map(ne=>({id:ne.id,...ne.data()}));i(ce)};ie.useEffect(()=>{k()},[]);const v=async()=>{if(!e||!r){alert("Vehicle No and Owner Name required");return}const Q=e.trim().replace(/\s+/g," ").toUpperCase(),ce=rt(_,Sr("VehicleNo","==",Q));if(!(await or(ce)).empty){alert("Vehicle already exists");return}await ta(_,{VehicleNo:Q,OwnerName:r.trim(),CreatedAt:new Date}),t(""),a(""),u("‚úÖ Vehicle added successfully"),k()},T=Q=>{c(Q.target.files[0]),u("")},b=Q=>Q.toString().trim().toLowerCase().replace(/\s+/g,""),E=async()=>{if(!s){alert("Please select an Excel file first");return}l(!0),u("");const Q=new FileReader;Q.onload=async ce=>{try{const ne=new Uint8Array(ce.target.result),Se=ha(ne,{type:"array"}),V=Se.Sheets[Se.SheetNames[0]],_e=$e.sheet_to_json(V,{defval:""});let ge=0,A=0;for(let M of _e){const P=Object.keys(M).reduce((Ee,R)=>(Ee[b(R)]=M[R],Ee),{}),D=P.truckno,W=P.name;if(!D||!W)continue;const Z=D.toString().trim().replace(/\s+/g," ").toUpperCase(),se=W.toString().trim(),ae=rt(_,Sr("VehicleNo","==",Z));(await or(ae)).empty?(await ta(_,{VehicleNo:Z,OwnerName:se,CreatedAt:new Date}),ge++):A++}u(`‚úÖ Excel upload completed. Added ${ge} vehicles, Skipped ${A} duplicates.`),k()}catch(ne){console.error("Excel upload error:",ne),alert("Excel upload failed. Check console.")}finally{c(null),l(!1)}},Q.readAsArrayBuffer(s)},y=()=>{if(!n.length)return;const Q=n.map(Se=>({"Vehicle No":Se.VehicleNo,"Owner Name":Se.OwnerName})),ce=$e.json_to_sheet(Q),ne=$e.book_new();$e.book_append_sheet(ne,ce,"VehicleMaster"),ua(ne,"VehicleMaster.xlsx")},O=n.filter(Q=>Q.VehicleNo.toLowerCase().includes(d.toLowerCase())||Q.OwnerName.toLowerCase().includes(d.toLowerCase())),B=n.length,j=O.length,U=Math.ceil(j/m),L=(g-1)*m,Y=Math.min(L+m,j),J=O.slice(L,Y);return h.jsxs("div",{style:{padding:20},children:[h.jsx("h2",{children:"üöõ Vehicle Master"}),h.jsxs("div",{style:{marginBottom:25},children:[h.jsx("h4",{children:"Add Vehicle"}),h.jsx("input",{placeholder:"Vehicle Number",value:e,onChange:Q=>t(Q.target.value)}),h.jsx("input",{placeholder:"Owner Name",value:r,onChange:Q=>a(Q.target.value),style:{marginLeft:10}}),h.jsx("button",{onClick:v,style:{marginLeft:10},children:"Add"})]}),h.jsxs("div",{style:{marginBottom:25},children:[h.jsx("h4",{children:"Upload Excel"}),h.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:T}),s&&h.jsxs("p",{children:["üìé Selected: ",h.jsx("b",{children:s.name})]}),h.jsx("button",{onClick:E,disabled:o,style:{marginTop:10},children:o?"Uploading...":"Upload Excel"})]}),h.jsx("div",{style:{marginBottom:25},children:h.jsx("button",{onClick:y,children:"üì§ Export to Excel"})}),f&&h.jsx("p",{style:{color:"green",fontWeight:"bold"},children:f}),h.jsx("div",{style:{marginBottom:10},children:h.jsx("input",{placeholder:"Search Vehicle No or Owner",value:d,onChange:Q=>{x(Q.target.value),p(1)},style:{width:300}})}),h.jsxs("div",{style:{marginBottom:10,fontWeight:"bold"},children:["Showing ",j===0?0:L+1,"-",Y," of ",j," filtered records (Total in DB: ",B,")"]}),h.jsxs("table",{border:"1",width:"100%",children:[h.jsx("thead",{children:h.jsxs("tr",{children:[h.jsx("th",{children:"Vehicle No"}),h.jsx("th",{children:"Owner Name"})]})}),h.jsxs("tbody",{children:[J.map(Q=>h.jsxs("tr",{children:[h.jsx("td",{children:Q.VehicleNo}),h.jsx("td",{children:Q.OwnerName})]},Q.id)),J.length===0&&h.jsx("tr",{children:h.jsx("td",{colSpan:2,style:{textAlign:"center"},children:"No records found"})})]})]}),U>1&&h.jsxs("div",{style:{marginTop:10},children:[h.jsx("button",{disabled:g===1,onClick:()=>p(Q=>Q-1),children:"Prev"}),[...Array(U)].map((Q,ce)=>h.jsx("button",{onClick:()=>p(ce+1),style:{margin:"0 3px",fontWeight:g===ce+1?"bold":"normal"},children:ce+1},ce)),h.jsx("button",{disabled:g===U,onClick:()=>p(Q=>Q+1),children:"Next"})]})]})},Pk=["MANIGARH","ULTRATECH","JSW"],ji=e=>{if(e==null||e==="")return 0;typeof e=="string"&&(e=e.replace(/,/g,""));const t=parseFloat(e);return isNaN(t)?0:t},Lk=e=>{if(!e)return null;if(e instanceof Date)return e;if(typeof e=="number")return new Date(Math.round((e-25569)*86400*1e3));const t=String(e).trim(),r=t.match(/^(\d{1,2})[-\/](\d{1,2})[-\/](\d{2,4})$/);if(r){const n=parseInt(r[1],10),i=parseInt(r[2],10)-1;let s=parseInt(r[3],10);s<100&&(s=s>=0&&s<=50?s+2e3:s+1900);const c=new Date(s,i,n);if(!isNaN(c.getTime())&&c.getDate()===n&&c.getMonth()===i)return c}const a=new Date(t);return isNaN(a.getTime())?(console.warn(`Could not parse date: ${e}`),null):a},Mk=({isAdmin:e})=>{const[t,r]=ie.useState(null),[a,n]=ie.useState(""),[i,s]=ie.useState(!1),[c,o]=ie.useState([]);if(!e)return h.jsx("h3",{style:{color:"red"},children:"Access Denied"});const l=(d,x="info")=>{const g=new Date().toLocaleTimeString();o(p=>[...p,{timestamp:g,message:d,type:x}].slice(-20))},f=async()=>{if(!t||!a){alert("Select Factory and Excel file");return}s(!0),o([]),l(`Starting upload for ${a} factory...`,"info");const d=new FileReader;d.onload=async x=>{try{const g=ha(x.target.result,{type:"binary"}),p=g.Sheets[g.SheetNames[0]],m=$e.sheet_to_json(p,{header:1});let _=0,k=0,v=0;l(`Found ${m.length-1} rows in Excel file`,"info");for(let b=1;b<m.length;b++){const E=m[b];if(!E||E.every(M=>M===null||M===""))continue;const y=String(E[0]||"").trim(),O=ji(E[4]),B=ji(E[6]),j=ji(E[7]),U=String(E[8]||"").trim(),L=Lk(E[9]),Y=String(E[10]||"").trim(),J=String(E[11]||"").trim();if(l(`Processing row ${b}: Bill ${U}, Date: ${L?L.toLocaleDateString():"Invalid"}`),!y){l(`Row ${b} skipped: Missing Challan No`,"warning"),k++;continue}if(!U){l(`Row ${b} skipped: Missing Bill Number`,"warning"),k++;continue}if(O===0){l(`Row ${b} skipped: Quantity is 0`,"warning"),k++;continue}if(B===0){l(`Row ${b} skipped: Unit Price is 0`,"warning"),k++;continue}if(!L){l(`Row ${b} skipped: Invalid Bill Date (${E[9]})`,"warning"),k++;continue}const Q=rt(qe(Ie,"TblDispatch"),Sr("ChallanNo","==",y),Sr("FactoryName","==",a)),ce=await or(Q);if(ce.empty){l(`Row ${b} skipped: Dispatch not found for Challan ${y}`,"warning"),k++;continue}const ne=ce.docs[0],Se=ne.data();if(Se.BillID){l(`Row ${b} skipped: Challan ${y} already linked to Bill ${Se.BillNum||Se.BillID}`,"warning"),k++;continue}let V=null,_e=!1;const ge=rt(qe(Ie,"BillTable"),Sr("BillNum","==",U),Sr("FactoryName","==",a)),A=await or(ge);A.empty?(V=(await ta(qe(Ie,"BillTable"),{BillNum:U,BillDate:L,BillType:Y,FactoryName:a,CreatedOn:qt()})).id,l(`Row ${b}: Created new Bill ${U}`,"success")):(V=A.docs[0].id,_e=!0,l(`Row ${b}: Bill ${U} already exists, using existing bill`,"info"));try{await Et(yr(Ie,"TblDispatch",ne.id),{DispatchQuantity:O,UnitPrice:B,FinalPrice:j,DeliveryNum:J,BillID:V,BillNum:U,UpdatedAt:qt()}),_++,l(`Row ${b}: Updated Dispatch ${y} with Bill ${U}`,"success")}catch(M){v++,l(`Row ${b}: Failed to update Dispatch ${y}: ${M.message}`,"error")}}s(!1);const T=`Upload completed:
Success: ${_}
Skipped: ${k}
Failed: ${v}`;l(T,"info"),alert(T)}catch(g){s(!1),l(`Upload failed: ${g.message}`,"error"),alert(`Upload failed: ${g.message}`)}},d.onerror=()=>{s(!1),l("Error reading file","error"),alert("Error reading file")},d.readAsBinaryString(t)},u=()=>{const d=[["ChallanNo","col2","col3","col4","Quantity","col6","UnitPrice","FinalPrice","BillNum","BillDate","BillType","DeliveryNum"],["CH-001","","","",100,"",50,4800,"BILL-001","09-01-26","Regular","DEL-001"],["CH-002","","","",200,"",75,14700,"BILL-002","10-01-26","Regular","DEL-002"],["CH-003","","","",150,"",60,8820,"BILL-003","11-01-26","Regular","DEL-003"]],x=$e.aoa_to_sheet(d),g=$e.book_new();$e.book_append_sheet(g,x,"Template"),ua(g,`Bill_Upload_Template_${a||"Generic"}.xlsx`),l("Template downloaded","info")};return h.jsxs("div",{style:{maxWidth:800,margin:"30px auto",padding:"0 20px"},children:[h.jsx("h3",{children:"Upload Bill"}),h.jsxs("div",{style:{backgroundColor:"#f8f9fa",padding:"15px",borderRadius:"5px",marginBottom:"20px",border:"1px solid #dee2e6"},children:[h.jsx("h4",{children:"Instructions:"}),h.jsxs("ul",{style:{margin:"10px 0",paddingLeft:"20px"},children:[h.jsx("li",{children:"Excel file must have columns in this order: ChallanNo, col2, col3, col4, Quantity, col6, UnitPrice, FinalPrice, BillNum, BillDate, BillType, DeliveryNum"}),h.jsxs("li",{children:["BillDate must be in ",h.jsx("strong",{children:"dd-mm-yy"})," or ",h.jsx("strong",{children:"dd-mm-yyyy"})," format (e.g., 09-01-26 or 09-01-2026 for 9th January 2026)"]}),h.jsx("li",{children:'Columns marked "col" can be left empty or contain any data'}),h.jsx("li",{children:"Download template for reference"})]})]}),h.jsxs("div",{style:{marginBottom:"15px"},children:[h.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"Select Factory:"}),h.jsxs("select",{value:a,onChange:d=>n(d.target.value),style:{width:"100%",padding:"10px",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"16px"},children:[h.jsx("option",{value:"",children:"-- Select Factory --"}),Pk.map(d=>h.jsx("option",{value:d,children:d},d))]})]}),h.jsxs("div",{style:{marginBottom:"15px"},children:[h.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"Select Excel File:"}),h.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:d=>{r(d.target.files[0]),d.target.files[0]&&l(`Selected file: ${d.target.files[0].name}`,"info")},style:{width:"100%",padding:"10px",borderRadius:"4px",border:"1px solid #ced4da"}})]}),h.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"20px"},children:[h.jsx("button",{onClick:f,disabled:i||!t||!a,style:{padding:"10px 20px",backgroundColor:i||!t||!a?"#cccccc":"#28a745",color:"white",border:"none",borderRadius:"4px",cursor:i||!t||!a?"not-allowed":"pointer",fontSize:"16px",flex:1},children:i?"Uploading...":"Upload Bill"}),h.jsx("button",{onClick:u,style:{padding:"10px 20px",backgroundColor:"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"16px",flex:1},children:"Download Template"})]}),c.length>0&&h.jsxs("div",{style:{marginTop:"30px",border:"1px solid #dee2e6",borderRadius:"5px",overflow:"hidden"},children:[h.jsx("div",{style:{backgroundColor:"#343a40",color:"white",padding:"10px 15px",fontWeight:"bold"},children:"Upload Log"}),h.jsx("div",{style:{maxHeight:"300px",overflowY:"auto",backgroundColor:"#f8f9fa"},children:c.map((d,x)=>h.jsxs("div",{style:{padding:"8px 15px",borderBottom:"1px solid #dee2e6",fontFamily:"monospace",fontSize:"12px",color:d.type==="error"?"#dc3545":d.type==="warning"?"#ffc107":d.type==="success"?"#28a745":"#6c757d"},children:[h.jsxs("span",{style:{color:"#6c757d",marginRight:"10px"},children:["[",d.timestamp,"]"]}),d.message]},x))})]})]})},kc=e=>{if(!e)return null;if(e.seconds)return new Date(e.seconds*1e3);const t=new Date(e);return isNaN(t.getTime())?null:t},ur=e=>{if(e==null||e==="")return 0;typeof e=="string"&&(e=e.replace(/,/g,""));const t=parseFloat(e);return isNaN(t)?0:t},Tc=e=>{if(!e)return"";try{if(isNaN(e.getTime()))return"";const t=String(e.getDate()).padStart(2,"0"),r=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],a=e.getMonth(),n=r[a],i=e.getFullYear();return`${t}-${n}-${i}`}catch(t){return console.error("Error formatting date:",e,t),""}},Ec=e=>{if(!e)return"";try{if(isNaN(e.getTime()))return"";const t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${t}-${r}-${a}`}catch(t){return console.error("Error formatting date for sort:",e,t),""}},jk=e=>{if(!e||e.length===0)return"";const t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],r=new Set;return e.forEach(n=>{if(n.DispatchDate){const i=n.DispatchDate.split("-");if(i.length===3){const s=i[1];t.includes(s)&&r.add(s)}}}),Array.from(r).sort((n,i)=>t.indexOf(n)-t.indexOf(i)).join(", ")},Uk=()=>{var Te,fe;const[e,t]=ie.useState([]),[r,a]=ie.useState({}),[n,i]=ie.useState(null),[s,c]=ie.useState(!1),[o,l]=ie.useState(!1),[f,u]=ie.useState([]),[d,x]=ie.useState(!1),[g,p]=ie.useState(!1),[m,_]=ie.useState(!1),[k,v]=ie.useState(1),[T,b]=ie.useState(20),[E,y]=ie.useState(""),[O,B]=ie.useState(""),[j,U]=ie.useState(""),[L,Y]=ie.useState(""),[J,Q]=ie.useState({fromDate:"",toDate:"",searchBill:"",factoryFilter:""}),ce=async()=>{c(!0);try{let H=[bc("BillDate","asc")];if(J.fromDate){const Re=new Date(J.fromDate);Re.setHours(0,0,0,0),H.push(Sr("BillDate",">=",Hn.fromDate(Re)))}if(J.toDate){const Re=new Date(J.toDate);Re.setHours(23,59,59,999),H.push(Sr("BillDate","<=",Hn.fromDate(Re)))}const we=rt(qe(Ie,"BillTable"),...H),Ne=await or(we),He=await or(qe(Ie,"TblDispatch")),Wr={};Ne.docs.forEach(Re=>Wr[Re.id]=Re.data());const Ge={},ze={};He.docs.forEach(Re=>{const xe=Re.data();if(!xe.BillID||!Wr[xe.BillID])return;const Oe=Wr[xe.BillID],Je=kc(Oe.BillDate),Ce=Tc(Je),Ze=Ec(Je);ze[xe.BillID]||(ze[xe.BillID]=[]);const Tr=kc(xe.DispatchDate),ar=Tc(Tr),At=Ec(Tr);ze[xe.BillID].push({id:Re.id,ChallanNo:xe.ChallanNo||"",DispatchDate:ar,DispatchDateSortKey:At,Quantity:ur(xe.DispatchQuantity),UnitPrice:ur(xe.UnitPrice),FinalPrice:ur(xe.FinalPrice),VehicleNo:xe.VehicleNo||"",LRNo:xe.LRNo||"",DeliveryNum:xe.DeliveryNum||""}),Ge[xe.BillID]||(Ge[xe.BillID]={BillID:xe.BillID,"Dispatch Month":"","Factory Name":Oe.FactoryName||"","Bill Num":Oe.BillNum||"","LR Quantity":0,"Bill Quantity":0,"Taxable Amount":0,"Final Price":0,FINAL_RAW:0,"Actual Amount":0,TDS:0,GST:0,"Bill Date":Ce,"Bill Type":Oe.BillType||"",BillDateObj:Je,BillDateSortKey:Ze,HAS_ZERO_FINAL:!1}),Ge[xe.BillID]["LR Quantity"]+=1,Ge[xe.BillID]["Bill Quantity"]+=ur(xe.DispatchQuantity);const Sn=ur(xe.DispatchQuantity)*ur(xe.UnitPrice),Fn=ur(xe.FinalPrice);Ge[xe.BillID]["Taxable Amount"]+=Sn,Ge[xe.BillID].FINAL_RAW+=Fn,Fn===0&&(Ge[xe.BillID].HAS_ZERO_FINAL=!0)}),Object.keys(Ge).forEach(Re=>{ze[Re]&&(Ge[Re]["Dispatch Month"]=jk(ze[Re]))});const kr=Object.values(Ge).map(Re=>{const xe=Re["Taxable Amount"],Oe=Re.FINAL_RAW,Je=!Re.HAS_ZERO_FINAL&&Oe>0&&Oe<xe,Ce=Je?Oe:xe,Ze=Ce*.00984,Tr=Ce*.18,ar=Ce+Tr;return{...Re,"LR Quantity":Re["LR Quantity"],"Bill Quantity":Re["Bill Quantity"].toFixed(2),"Taxable Amount":xe.toFixed(2),"Final Price":Je?Oe.toFixed(2):"0.00","Actual Amount":ar.toFixed(2),TDS:Ze.toFixed(2),GST:Tr.toFixed(2)}});kr.sort((Re,xe)=>Re.BillDateObj&&xe.BillDateObj?xe.BillDateObj-Re.BillDateObj:0),t(kr),a(ze),u([]),x(!1),v(1)}catch(H){console.error("Error loading data:",H)}finally{c(!1)}};ie.useEffect(()=>{ce()},[J]);const ne=()=>{Q({fromDate:O,toDate:j,searchBill:E,factoryFilter:L})},Se=()=>{y(""),Y(""),B(""),U(""),Q({fromDate:"",toDate:"",searchBill:"",factoryFilter:""})},V=ie.useMemo(()=>[...new Set(e.map(H=>H["Factory Name"]).filter(Boolean))],[e]),_e=ie.useMemo(()=>{let H=[...e];if(J.searchBill.trim()){const we=J.searchBill.toLowerCase().split(/\s+/);H=H.filter(Ne=>we.every(He=>(Ne["Factory Name"]||"").toLowerCase().includes(He)||(Ne["Bill Num"]||"").toLowerCase().includes(He)||(Ne["Bill Date"]||"").toLowerCase().includes(He)||(Ne["Dispatch Month"]||"").toLowerCase().includes(He)))}if(J.factoryFilter&&(H=H.filter(we=>(we["Factory Name"]||"").toLowerCase()===J.factoryFilter.toLowerCase())),J.fromDate){const we=new Date(J.fromDate);we.setHours(0,0,0,0),H=H.filter(Ne=>Ne.BillDateObj?Ne.BillDateObj>=we:!1)}if(J.toDate){const we=new Date(J.toDate);we.setHours(23,59,59,999),H=H.filter(Ne=>Ne.BillDateObj?Ne.BillDateObj<=we:!1)}return H},[e,J]),ge=_e.length,A=Math.ceil(ge/T);ie.useEffect(()=>{k>A&&A>0&&v(A)},[k,A]);const M=k*T,P=M-T,D=_e.slice(P,M),W=n?_e.filter(H=>H.BillID===n):D,Z=H=>{H>=1&&H<=A&&(v(H),window.scrollTo({top:0,behavior:"smooth"}))},se=H=>{const we=parseInt(H.target.value);b(we),v(1)},ae=H=>r[H]?[...r[H]].sort((we,Ne)=>new Date(we.DispatchDateSortKey)-new Date(Ne.DispatchDateSortKey)):[],ee=()=>{if(d)u([]);else{const H=W.map(we=>we.BillID);u(H)}x(!d)},Ee=H=>{f.includes(H)?u(f.filter(we=>we!==H)):u([...f,H])},R=()=>{_(!0);try{const H=_e.map(xe=>({"Dispatch Month":xe["Dispatch Month"]||"","Factory Name":xe["Factory Name"]||"","Bill Num":xe["Bill Num"]||"","LR Quantity":ur(xe["LR Quantity"]),"Bill Quantity":ur(xe["Bill Quantity"]),"Taxable Amount":ur(xe["Taxable Amount"]),"Final Price":ur(xe["Final Price"]),"Actual Amount":ur(xe["Actual Amount"]),TDS:ur(xe.TDS),GST:ur(xe.GST),"Bill Date":xe["Bill Date"]||"","Bill Type":xe["Bill Type"]||""}));if(H.length===0){alert("No data to export!"),_(!1);return}const we=$e.json_to_sheet(H),Ne=[{wch:15},{wch:20},{wch:20},{wch:12},{wch:15},{wch:15},{wch:15},{wch:15},{wch:12},{wch:12},{wch:12},{wch:20}];we["!cols"]=Ne;const He=$e.decode_range(we["!ref"]);for(let xe=He.s.c;xe<=He.e.c;++xe){const Oe=$e.encode_col(xe)+"1";we[Oe]&&(we[Oe].s={font:{bold:!0},fill:{fgColor:{rgb:"E0E0E0"}}})}const Wr=["LR Quantity","Bill Quantity","Taxable Amount","Final Price","Actual Amount","TDS","GST"],Ge={};Object.keys(H[0]).forEach((xe,Oe)=>{Ge[xe]=Oe});for(let xe=He.s.r+1;xe<=He.e.r;++xe)Wr.forEach(Oe=>{const Je=Ge[Oe];if(Je!==void 0){const Ce=$e.encode_col(Je)+(xe+1);we[Ce]&&(we[Ce].z="#,##0.00")}});const ze=$e.book_new();$e.book_append_sheet(ze,we,"Bills Report");const Re=`Bills_Report_${new Date().toISOString().split("T")[0]}.xlsx`;ua(ze,Re),alert(`Exported ${H.length} bills to ${Re}`)}catch(H){console.error("Error exporting to Excel:",H),alert("Error exporting to Excel: "+H.message)}finally{_(!1)}},q=()=>{if(f.length===0){alert("Please select bills to export");return}_(!0);try{const Ne=_e.filter(xe=>f.includes(xe.BillID)).map(xe=>({"Dispatch Month":xe["Dispatch Month"]||"","Factory Name":xe["Factory Name"]||"","Bill Num":xe["Bill Num"]||"","LR Quantity":ur(xe["LR Quantity"]),"Bill Quantity":ur(xe["Bill Quantity"]),"Taxable Amount":ur(xe["Taxable Amount"]),"Final Price":ur(xe["Final Price"]),"Actual Amount":ur(xe["Actual Amount"]),TDS:ur(xe.TDS),GST:ur(xe.GST),"Bill Date":xe["Bill Date"]||"","Bill Type":xe["Bill Type"]||""})),He=$e.json_to_sheet(Ne),Wr=[{wch:15},{wch:20},{wch:20},{wch:12},{wch:15},{wch:15},{wch:15},{wch:15},{wch:12},{wch:12},{wch:12},{wch:20}];He["!cols"]=Wr;const Ge=$e.decode_range(He["!ref"]);for(let xe=Ge.s.c;xe<=Ge.e.c;++xe){const Oe=$e.encode_col(xe)+"1";He[Oe]&&(He[Oe].s={font:{bold:!0},fill:{fgColor:{rgb:"E0E0E0"}}})}const ze=$e.book_new();$e.book_append_sheet(ze,He,"Selected Bills");const kr=new Date().toISOString().split("T")[0],Re=`Selected_Bills_${f.length}_${kr}.xlsx`;ua(ze,Re),alert(`Exported ${f.length} selected bills to ${Re}`)}catch(H){console.error("Error exporting selected bills:",H),alert("Error exporting selected bills: "+H.message)}finally{_(!1)}},le=async()=>{if(f.length===0){alert("Please select bills to delete");return}p(!0)},ve=async()=>{l(!0);try{for(const H of f){const we=rt(qe(Ie,"TblDispatch"),Sr("BillID","==",H)),Ne=await or(we);for(const He of Ne.docs)await Et(yr(Ie,"TblDispatch",He.id),{BillID:"",BillNum:"",UpdatedAt:qt()});await It(yr(Ie,"BillTable",H))}await ce(),alert(`Successfully deleted ${f.length} bill(s)`)}catch(H){console.error("Error deleting bills:",H),alert(`Error deleting bills: ${H.message}`)}finally{l(!1),p(!1)}};return h.jsxs("div",{style:{padding:20},children:[h.jsx("h2",{children:"Bill Report"}),h.jsxs("div",{style:{marginBottom:15,padding:15,backgroundColor:"#f5f5f5",borderRadius:5,display:"flex",flexWrap:"wrap",gap:10,alignItems:"center"},children:[h.jsx("div",{children:h.jsx("input",{type:"text",placeholder:"Search factory, bill no, date, month",value:E,onChange:H=>y(H.target.value),style:{width:250,padding:8}})}),h.jsx("div",{children:h.jsxs("select",{value:L,onChange:H=>Y(H.target.value),style:{padding:8,width:200},children:[h.jsx("option",{value:"",children:"Select Factory"}),V.map(H=>h.jsx("option",{value:H,children:H},H))]})}),h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:5},children:[h.jsx("label",{children:"From:"}),h.jsx("input",{type:"date",value:O,onChange:H=>B(H.target.value),style:{padding:8}})]}),h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:5},children:[h.jsx("label",{children:"To:"}),h.jsx("input",{type:"date",value:j,onChange:H=>U(H.target.value),style:{padding:8}})]}),h.jsxs("div",{style:{display:"flex",gap:10},children:[h.jsx("button",{onClick:ne,disabled:s,style:{padding:"8px 16px",backgroundColor:"#4CAF50",color:"white",border:"none",borderRadius:4,cursor:s?"not-allowed":"pointer",opacity:s?.7:1},children:s?"Loading...":"Apply Filters"}),h.jsx("button",{onClick:Se,disabled:s,style:{padding:"8px 16px",backgroundColor:"#f44336",color:"white",border:"none",borderRadius:4,cursor:s?"not-allowed":"pointer",opacity:s?.7:1},children:"Clear Filters"})]}),h.jsxs("div",{style:{display:"flex",gap:10,marginLeft:"auto"},children:[h.jsx("button",{onClick:R,disabled:m||_e.length===0,style:{padding:"8px 16px",backgroundColor:"#2196F3",color:"white",border:"none",borderRadius:4,cursor:m||_e.length===0?"not-allowed":"pointer",opacity:m||_e.length===0?.7:1,display:"flex",alignItems:"center",gap:5},title:"Export all filtered bills to Excel",children:m?"Exporting...":"Export All to Excel"}),f.length>0&&h.jsx("button",{onClick:q,disabled:m,style:{padding:"8px 16px",backgroundColor:"#FF9800",color:"white",border:"none",borderRadius:4,cursor:m?"not-allowed":"pointer",opacity:m?.7:1,display:"flex",alignItems:"center",gap:5},title:`Export ${f.length} selected bills to Excel`,children:m?"Exporting...":`Export Selected (${f.length})`})]}),(J.fromDate||J.toDate||J.searchBill||J.factoryFilter)&&h.jsxs("div",{style:{fontSize:12,color:"#666",display:"flex",gap:10,width:"100%",marginTop:10},children:[J.fromDate||J.toDate?h.jsxs("span",{children:["Date: ",J.fromDate||"Any"," to ",J.toDate||"Any"]}):null,J.searchBill&&h.jsxs("span",{children:['Search: "',J.searchBill,'"']}),J.factoryFilter&&h.jsxs("span",{children:["Factory: ",J.factoryFilter]})]})]}),h.jsxs("div",{style:{marginBottom:15,padding:10,backgroundColor:"#f8f9fa",borderRadius:5,display:"flex",justifyContent:"space-between",alignItems:"center",border:"1px solid #dee2e6"},children:[h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[h.jsx("span",{style:{fontWeight:"bold"},children:"Records per page:"}),h.jsxs("select",{value:T,onChange:se,style:{padding:"5px 10px",borderRadius:4,border:"1px solid #ccc"},disabled:s,children:[h.jsx("option",{value:"10",children:"10"}),h.jsx("option",{value:"20",children:"20"}),h.jsx("option",{value:"50",children:"50"}),h.jsx("option",{value:"100",children:"100"}),h.jsx("option",{value:"200",children:"200"})]}),h.jsxs("span",{style:{marginLeft:20,color:"#666"},children:["Showing ",P+1," to ",Math.min(M,ge)," of ",ge," records"]})]}),h.jsxs("div",{style:{fontWeight:"bold",color:"#495057"},children:["Total Bills: ",ge]})]}),h.jsxs("div",{style:{marginBottom:15,padding:10,backgroundColor:f.length>0?"#fff3cd":"#e9ecef",borderRadius:5,border:f.length>0?"1px solid #ffc107":"1px solid #dee2e6",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[h.jsxs("div",{children:[h.jsxs("span",{style:{marginRight:10},children:[h.jsx("input",{type:"checkbox",checked:d&&W.length>0,onChange:ee,disabled:W.length===0||s,style:{marginRight:5}}),"Select All (",f.length," selected)"]}),h.jsxs("span",{style:{color:"#666",fontSize:"14px",marginLeft:"20px"},children:["Page Bills: ",W.length]})]}),h.jsx("div",{style:{display:"flex",gap:10},children:f.length>0&&h.jsxs(h.Fragment,{children:[h.jsx("button",{onClick:q,disabled:m,style:{padding:"8px 16px",backgroundColor:"#FF9800",color:"white",border:"none",borderRadius:4,cursor:m?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:5},children:m?"Exporting...":`Export ${f.length} Selected`}),h.jsx("button",{onClick:le,disabled:o,style:{padding:"8px 16px",backgroundColor:"#dc3545",color:"white",border:"none",borderRadius:4,cursor:o?"not-allowed":"pointer",fontWeight:"bold"},children:o?"Deleting...":`Delete Selected (${f.length})`})]})})]}),s&&h.jsx("div",{style:{textAlign:"center",padding:20},children:"Loading data..."}),m&&h.jsx("div",{style:{textAlign:"center",padding:10,color:"#2196F3"},children:"Exporting to Excel..."}),h.jsx("div",{style:{overflowX:"auto"},children:h.jsxs("table",{border:"1",width:"100%",style:{borderCollapse:"collapse"},children:[h.jsx("thead",{children:h.jsxs("tr",{style:{backgroundColor:"#f2f2f2"},children:[h.jsx("th",{style:{padding:10,textAlign:"center",width:"40px"},children:h.jsx("input",{type:"checkbox",checked:d&&W.length>0,onChange:ee,disabled:W.length===0||s})}),h.jsx("th",{style:{padding:10},children:"Dispatch Month"}),h.jsx("th",{style:{padding:10},children:"Factory Name"}),h.jsx("th",{style:{padding:10},children:"Bill Num"}),h.jsx("th",{style:{padding:10},children:"LR Quantity"}),h.jsx("th",{style:{padding:10},children:"Bill Quantity"}),h.jsx("th",{style:{padding:10},children:"Taxable Amount"}),h.jsx("th",{style:{padding:10},children:"Final Price"}),h.jsx("th",{style:{padding:10},children:"Actual Amount"}),h.jsx("th",{style:{padding:10},children:"TDS"}),h.jsx("th",{style:{padding:10},children:"GST"}),h.jsx("th",{style:{padding:10},children:"Bill Date"}),h.jsx("th",{style:{padding:10},children:"Bill Type"}),h.jsx("th",{style:{padding:10},children:"Action"})]})}),h.jsx("tbody",{children:!s&&W.length>0?W.map((H,we)=>h.jsxs("tr",{style:{textAlign:"center",backgroundColor:f.includes(H.BillID)?"#f8d7da":"inherit"},children:[h.jsx("td",{style:{padding:8,textAlign:"center"},children:h.jsx("input",{type:"checkbox",checked:f.includes(H.BillID),onChange:()=>Ee(H.BillID),disabled:s})}),h.jsx("td",{style:{padding:8,fontWeight:H["Dispatch Month"]?"normal":"lighter"},children:H["Dispatch Month"]||"N/A"}),h.jsx("td",{style:{padding:8},children:H["Factory Name"]}),h.jsx("td",{style:{padding:8},children:H["Bill Num"]}),h.jsx("td",{style:{padding:8},children:H["LR Quantity"]}),h.jsx("td",{style:{padding:8},children:H["Bill Quantity"]}),h.jsx("td",{style:{padding:8},children:H["Taxable Amount"]}),h.jsx("td",{style:{padding:8},children:H["Final Price"]}),h.jsx("td",{style:{padding:8},children:H["Actual Amount"]}),h.jsx("td",{style:{padding:8},children:H.TDS}),h.jsx("td",{style:{padding:8},children:H.GST}),h.jsx("td",{style:{padding:8},children:H["Bill Date"]}),h.jsx("td",{style:{padding:8},children:H["Bill Type"]}),h.jsx("td",{style:{padding:8},children:h.jsx("button",{onClick:()=>i(n===H.BillID?null:H.BillID),style:{padding:"5px 10px",backgroundColor:n===H.BillID?"#6c757d":"#007bff",color:"white",border:"none",borderRadius:4,cursor:"pointer",marginRight:"5px"},children:n===H.BillID?"Hide":"View"})})]},we)):!s&&h.jsx("tr",{children:h.jsx("td",{colSpan:"15",style:{textAlign:"center",padding:20},children:"No bills found. Try adjusting your filters."})})})]})}),!s&&ge>0&&h.jsxs("div",{style:{marginTop:20,padding:15,backgroundColor:"#f8f9fa",borderRadius:5,display:"flex",justifyContent:"space-between",alignItems:"center",border:"1px solid #dee2e6"},children:[h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:5},children:[h.jsxs("span",{style:{fontWeight:"bold",marginRight:10},children:["Page ",k," of ",A]}),h.jsx("button",{onClick:()=>Z(1),disabled:k===1,style:{padding:"8px 12px",backgroundColor:k===1?"#e9ecef":"#007bff",color:k===1?"#6c757d":"white",border:"none",borderRadius:4,cursor:k===1?"not-allowed":"pointer",fontWeight:"bold"},title:"First Page",children:"¬´¬´"}),h.jsx("button",{onClick:()=>Z(k-1),disabled:k===1,style:{padding:"8px 12px",backgroundColor:k===1?"#e9ecef":"#007bff",color:k===1?"#6c757d":"white",border:"none",borderRadius:4,cursor:k===1?"not-allowed":"pointer"},title:"Previous Page",children:"¬´"}),h.jsxs("div",{style:{display:"flex",gap:5},children:[k>3&&h.jsxs(h.Fragment,{children:[h.jsx("button",{onClick:()=>Z(1),style:{padding:"8px 12px",backgroundColor:"#6c757d",color:"white",border:"none",borderRadius:4,cursor:"pointer"},children:"1"}),k>4&&h.jsx("span",{style:{padding:"8px 0"},children:"..."})]}),Array.from({length:Math.min(5,A)},(H,we)=>{let Ne;return A<=5||k<=3?Ne=we+1:k>=A-2?Ne=A-4+we:Ne=k-2+we,Ne<1||Ne>A?null:h.jsx("button",{onClick:()=>Z(Ne),style:{padding:"8px 12px",backgroundColor:k===Ne?"#495057":"#6c757d",color:"white",border:"none",borderRadius:4,cursor:"pointer",fontWeight:k===Ne?"bold":"normal"},children:Ne},Ne)}),k<A-2&&h.jsxs(h.Fragment,{children:[k<A-3&&h.jsx("span",{style:{padding:"8px 0"},children:"..."}),h.jsx("button",{onClick:()=>Z(A),style:{padding:"8px 12px",backgroundColor:"#6c757d",color:"white",border:"none",borderRadius:4,cursor:"pointer"},children:A})]})]}),h.jsx("button",{onClick:()=>Z(k+1),disabled:k===A,style:{padding:"8px 12px",backgroundColor:k===A?"#e9ecef":"#007bff",color:k===A?"#6c757d":"white",border:"none",borderRadius:4,cursor:k===A?"not-allowed":"pointer"},title:"Next Page",children:"¬ª"}),h.jsx("button",{onClick:()=>Z(A),disabled:k===A,style:{padding:"8px 12px",backgroundColor:k===A?"#e9ecef":"#007bff",color:k===A?"#6c757d":"white",border:"none",borderRadius:4,cursor:k===A?"not-allowed":"pointer",fontWeight:"bold"},title:"Last Page",children:"¬ª¬ª"})]}),h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[h.jsx("span",{children:"Go to page:"}),h.jsx("input",{type:"number",min:"1",max:A,value:k,onChange:H=>{const we=parseInt(H.target.value);we>=1&&we<=A&&Z(we)},onBlur:H=>{const we=parseInt(H.target.value);(!we||we<1||we>A)&&(H.target.value=k)},style:{width:"60px",padding:"5px",textAlign:"center",border:"1px solid #ccc",borderRadius:4}}),h.jsxs("span",{children:["of ",A]})]})]}),n&&r[n]&&h.jsxs(h.Fragment,{children:[h.jsxs("h3",{style:{marginTop:30,marginBottom:15},children:["Dispatch Details for Bill: ",n,((Te=e.find(H=>H.BillID===n))==null?void 0:Te["Dispatch Month"])&&h.jsxs("span",{style:{marginLeft:20,fontSize:"16px",color:"#666"},children:["Dispatch Month(s): ",(fe=e.find(H=>H.BillID===n))==null?void 0:fe["Dispatch Month"]]})]}),h.jsx("div",{style:{overflowX:"auto"},children:h.jsxs("table",{border:"1",width:"100%",style:{borderCollapse:"collapse"},children:[h.jsx("thead",{children:h.jsxs("tr",{style:{backgroundColor:"#f2f2f2"},children:[h.jsx("th",{style:{padding:10},children:"Challan No"}),h.jsx("th",{style:{padding:10},children:"Dispatch Date"}),h.jsx("th",{style:{padding:10},children:"Vehicle No"}),h.jsx("th",{style:{padding:10},children:"Quantity"}),h.jsx("th",{style:{padding:10},children:"Unit Price"}),h.jsx("th",{style:{padding:10},children:"Final Price"}),h.jsx("th",{style:{padding:10},children:"LR No"}),h.jsx("th",{style:{padding:10},children:"Delivery No"})]})}),h.jsx("tbody",{children:ae(n).map((H,we)=>h.jsxs("tr",{style:{textAlign:"center"},children:[h.jsx("td",{style:{padding:8},children:H.ChallanNo}),h.jsx("td",{style:{padding:8},children:H.DispatchDate}),h.jsx("td",{style:{padding:8},children:H.VehicleNo}),h.jsx("td",{style:{padding:8},children:H.Quantity.toFixed(2)}),h.jsx("td",{style:{padding:8},children:H.UnitPrice.toFixed(2)}),h.jsx("td",{style:{padding:8},children:H.FinalPrice.toFixed(2)}),h.jsx("td",{style:{padding:8},children:H.LRNo}),h.jsx("td",{style:{padding:8},children:H.DeliveryNum})]},we))})]})})]}),g&&h.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3},children:h.jsxs("div",{style:{backgroundColor:"white",padding:"30px",borderRadius:"8px",maxWidth:"500px",width:"90%",boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:[h.jsx("h3",{style:{marginTop:0,color:"#dc3545"},children:"Confirm Delete"}),h.jsxs("p",{children:["Are you sure you want to delete ",h.jsx("strong",{children:f.length})," selected bill(s)?"]}),h.jsxs("p",{style:{color:"#666",fontSize:"14px",marginTop:"10px"},children:[h.jsx("strong",{children:"Note:"})," This will remove the bill from BillTable but keep the dispatch records (only removing their BillID link)."]}),h.jsxs("div",{style:{marginTop:"25px",display:"flex",justifyContent:"flex-end",gap:"10px"},children:[h.jsx("button",{onClick:()=>p(!1),disabled:o,style:{padding:"8px 16px",backgroundColor:"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Cancel"}),h.jsx("button",{onClick:ve,disabled:o,style:{padding:"8px 16px",backgroundColor:"#dc3545",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:o?"Deleting...":"Delete"})]})]})})]})},Wk=()=>{const[e,t]=ie.useState(""),[r,a]=ie.useState(""),[n,i]=ie.useState(""),s=async()=>{if(!vt.currentUser){alert("Please login first");return}if(!window.confirm("This will delete dispatch uploaded data. Continue?"))return;i("Deleting...");let c=qe(Ie,"TblDispatch");e&&(c=rt(c,Sr("DispatchDate",">=",new Date(e)))),r&&(c=rt(c,Sr("DispatchDate","<=",new Date(r))));const o=await or(c);if(o.empty){i("No dispatch records found");return}for(const l of o.docs)await It(yr(Ie,"TblDispatch",l.id));i(`${o.size} dispatch records deleted`)};return h.jsxs("div",{style:{padding:30},children:[h.jsx("h2",{children:"Delete Dispatch Uploaded Data"}),h.jsxs("div",{style:{marginBottom:10},children:[h.jsx("label",{children:"From Date: "}),h.jsx("input",{type:"date",value:e,onChange:c=>t(c.target.value)})]}),h.jsxs("div",{style:{marginBottom:10},children:[h.jsx("label",{children:"To Date: "}),h.jsx("input",{type:"date",value:r,onChange:c=>a(c.target.value)})]}),h.jsx("button",{onClick:s,style:{background:"red",color:"white",padding:"8px 15px"},children:"Delete Dispatch Data"}),n&&h.jsx("p",{style:{marginTop:15},children:n})]})},Vk=async()=>{if(console.log("Delete Duplicate Challan button clicked"),!window.confirm("Delete duplicate challans?"))return;const e=await or(qe(Ie,"TblDispatch"));console.log("Total records in DB:",e.size);const t=new Set,r=[];if(e.docs.forEach(a=>{const n=(a.data().ChallanNo||"").trim();n&&(t.has(n)?r.push(a.id):t.add(n))}),console.log("Duplicate challans found:",r.length),r.length===0){alert("No duplicate challan numbers found.");return}for(const a of r)await It(yr(Ie,"TblDispatch",a));alert(`Deleted ${r.length} duplicate challans.`)},Hk=()=>h.jsxs("div",{style:{padding:"20px"},children:[h.jsx("h2",{children:"Delete Duplicate Challans"}),h.jsx("button",{onClick:()=>Vk(),style:{padding:"10px 20px",backgroundColor:"#dc3545",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Delete Duplicate Challans"})]}),jn={10:"JSW",6:"Manigar",7:"Ultratech"},Wa=["ChallanNo","Destination","VehicleNo","DispatchDate","DispatchQuantity","PartyName","FactoryName","BillNum"],Ui=e=>{if(!e)return null;const t=new Date(e);return t.setHours(0,0,0,0),t},Va=e=>{if(!e)return"";const t=new Date(e),r=String(t.getDate()).padStart(2,"0"),a=String(t.getMonth()+1).padStart(2,"0"),n=t.getFullYear().toString().slice(-2);return`${r}-${a}-${n}`},Sc=e=>{if(!e)return"";const t=new Date(e),r=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return`${r}-${a}-${n}`},$k=()=>{const[e,t]=ie.useState([]),[r,a]=ie.useState(""),[n,i]=ie.useState([]),[s,c]=ie.useState(1),[o,l]=ie.useState(""),[f,u]=ie.useState(""),[d,x]=ie.useState(""),[g,p]=ie.useState(!1),[m,_]=ie.useState(""),[k,v]=ie.useState({searchTerm:"",filterFactory:"",fromDate:"",toDate:"",filterBillNum:""}),[T,b]=ie.useState(null),[E,y]=ie.useState(""),[O,B]=ie.useState(""),j=10;ie.useEffect(()=>{const q=async()=>{if(vt.currentUser){const ve=await vt.currentUser.getIdTokenResult();p(!!ve.claims.admin)}},le=async()=>{const Te=(await or(qe(Ie,"TblDispatch"))).docs.map(fe=>{const H={id:fe.id,...fe.data()};if(H.DisVid=String(H.DisVid||""),H.DispatchDate){const we=H.DispatchDate.seconds?new Date(H.DispatchDate.seconds*1e3):new Date(H.DispatchDate);H.DispatchDate=new Date(we.getFullYear(),we.getMonth(),we.getDate())}return H.FactoryName=H.FactoryName||jn[H.DisVid]||"",H.BillNum=String(H.BillNum||""),H});t(Te)};q(),le()},[]);const U=()=>{const q=new Set;return e.forEach(le=>{le.DisVid&&jn[le.DisVid]?q.add(jn[le.DisVid]):le.FactoryName&&q.add(le.FactoryName)}),Array.from(q).sort()},L=()=>{const q=new Set;return e.forEach(le=>{le.BillNum&&le.BillNum.trim()!==""&&q.add(le.BillNum)}),Array.from(q).sort()},Y=()=>{v({searchTerm:r,filterFactory:o,fromDate:f,toDate:d,filterBillNum:m}),c(1)},J=()=>{a(""),l(""),u(""),x(""),_(""),v({searchTerm:"",filterFactory:"",fromDate:"",toDate:"",filterBillNum:""}),c(1)},Q=q=>{b(q.id),y(q.ChallanNo||""),B(q.BillNum||"")},ce=async q=>{const le={ChallanNo:E};g&&O!==void 0&&(le.BillNum=O),await Et(yr(Ie,"TblDispatch",q),le),t(ve=>ve.map(Te=>Te.id===q?{...Te,ChallanNo:E,BillNum:g?O:Te.BillNum}:Te)),b(null),y(""),B("")},ne=()=>{b(null),y(""),B("")},Se=async q=>{g&&window.confirm("Delete this record?")&&(await It(yr(Ie,"TblDispatch",q)),t(le=>le.filter(ve=>ve.id!==q)),i(le=>le.filter(ve=>ve!==q)))},V=async()=>{if(!(!g||!n.length)&&window.confirm(`Delete ${n.length} records?`)){for(let q of n)await It(yr(Ie,"TblDispatch",q));t(q=>q.filter(le=>!n.includes(le.id))),i([])}},_e=q=>{i(le=>le.includes(q)?le.filter(ve=>ve!==q):[...le,q])},ge=e.filter(q=>{const le=String(r??""),{filterFactory:ve,fromDate:Te,toDate:fe,filterBillNum:H}=k;if(!r&&!ve&&!Te&&!fe&&!H)return!0;const we=le.toLowerCase().trim().split(/\s+/).filter(Boolean),Ne=we.length===0?!0:we.every(Oe=>Object.values(q).some(Je=>Je?Je instanceof Date?Va(Je).toLowerCase().includes(Oe):Je.toString().toLowerCase().includes(Oe):!1)),He=ve?q.FactoryName===ve||jn[q.DisVid]===ve:!0,Wr=H?q.BillNum&&q.BillNum.toLowerCase().includes(H.toLowerCase()):!0,Ge=Ui(q.DispatchDate),ze=Te?Ui(new Date(Te)):null,kr=fe?Ui(new Date(fe)):null;let Re=!0,xe=!0;if(ze&&Ge&&(Re=Ge.getTime()>=ze.getTime()),kr&&Ge){const Oe=new Date(kr);Oe.setDate(Oe.getDate()+1),xe=Ge.getTime()<Oe.getTime()}return Ne&&He&&Re&&xe&&Wr}),A=e.length,M=ge.length,P=Math.ceil(M/j),D=(s-1)*j,W=Math.min(D+j,M),Z=ge.slice(D,D+j),se=Z.length>0&&Z.every(q=>n.includes(q.id)),ae=()=>{i(se?q=>q.filter(le=>!Z.some(ve=>ve.id===le)):q=>[...new Set([...q,...Z.map(le=>le.id)])])},ee=()=>{if(!ge.length)return;const q=ge.map(Te=>{const fe={};return Wa.forEach(H=>{fe[H]=Te[H]instanceof Date?Va(Te[H]):Te[H]}),fe}),le=$e.json_to_sheet(q),ve=$e.book_new();$e.book_append_sheet(ve,le,"Billed Challan"),ua(ve,"Billed_Challan_Data.xlsx")},Ee=U(),R=L();return h.jsxs("div",{style:{padding:20},children:[h.jsx("h2",{children:"Billed Challan Data"}),h.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center",marginBottom:15,padding:15,backgroundColor:"#f5f5f5",borderRadius:5},children:[h.jsx("input",{placeholder:"Search all fields...",value:r,onChange:q=>a(q.target.value),style:{padding:8,border:"1px solid #ccc",borderRadius:4,width:200}}),Ee.length>0&&h.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[h.jsx("label",{style:{fontSize:12,color:"#666"},children:"Factory Name"}),h.jsxs("select",{value:o,onChange:q=>l(q.target.value),style:{padding:8,border:"1px solid #ccc",borderRadius:4,minWidth:150},children:[h.jsx("option",{value:"",children:"All Factories"}),Ee.map(q=>h.jsx("option",{value:q,children:q},q))]})]}),h.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[h.jsx("label",{style:{fontSize:12,color:"#666"},children:"Bill Number"}),h.jsxs("div",{style:{display:"flex",gap:5},children:[h.jsx("input",{type:"text",placeholder:"Filter by Bill No",value:m,onChange:q=>_(q.target.value),style:{padding:8,border:"1px solid #ccc",borderRadius:4,width:150}}),R.length>0&&h.jsxs("select",{value:m,onChange:q=>_(q.target.value),style:{padding:8,border:"1px solid #ccc",borderRadius:4,minWidth:120},children:[h.jsx("option",{value:"",children:"All Bill Nos"}),R.map(q=>h.jsx("option",{value:q,children:q},q))]})]})]}),h.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[h.jsx("label",{style:{fontSize:12,color:"#666"},children:"From Date"}),h.jsx("input",{type:"date",value:Sc(f),onChange:q=>{const le=q.target.value;if(le){const[ve,Te,fe]=le.split("-"),H=new Date(ve,Te-1,fe);u(H)}else u("")},style:{padding:8,border:"1px solid #ccc",borderRadius:4}})]}),h.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[h.jsx("label",{style:{fontSize:12,color:"#666"},children:"To Date"}),h.jsx("input",{type:"date",value:Sc(d),onChange:q=>{const le=q.target.value;if(le){const[ve,Te,fe]=le.split("-"),H=new Date(ve,Te-1,fe);x(H)}else x("")},style:{padding:8,border:"1px solid #ccc",borderRadius:4}})]}),h.jsxs("div",{style:{display:"flex",gap:10,marginLeft:"auto",alignItems:"flex-end"},children:[h.jsx("button",{onClick:Y,style:{padding:"8px 16px",backgroundColor:"#4CAF50",color:"white",border:"none",borderRadius:4,cursor:"pointer",height:36},children:"Apply Filters"}),h.jsx("button",{onClick:J,style:{padding:"8px 16px",backgroundColor:"#f44336",color:"white",border:"none",borderRadius:4,cursor:"pointer",height:36},children:"Clear Filters"}),h.jsx("button",{onClick:ee,disabled:M===0,style:{padding:"8px 16px",backgroundColor:M===0?"#ccc":"#2196F3",color:"white",border:"none",borderRadius:4,cursor:M===0?"not-allowed":"pointer",height:36},title:M===0?"No data to export":"Export to Excel",children:"Export Excel"})]})]}),(k.filterFactory||k.fromDate||k.toDate||k.filterBillNum)&&h.jsxs("div",{style:{marginBottom:15,padding:10,backgroundColor:"#e8f5e8",borderRadius:5,fontSize:14,color:"#2e7d32"},children:[h.jsx("strong",{children:"Active Filters:"}),k.filterFactory&&h.jsxs("span",{style:{marginLeft:10},children:["Factory: ",k.filterFactory]}),k.filterBillNum&&h.jsxs("span",{style:{marginLeft:10},children:["Bill No: ",k.filterBillNum]}),(k.fromDate||k.toDate)&&h.jsxs("span",{style:{marginLeft:10},children:["Date: ",k.fromDate?Va(k.fromDate):"Any","to ",k.toDate?Va(k.toDate):"Any"]})]}),h.jsxs("div",{style:{marginBottom:15,padding:10,backgroundColor:"#e3f2fd",borderRadius:5,fontSize:14,color:"#1565c0"},children:[h.jsx("strong",{children:"Statistics:"}),h.jsxs("span",{style:{marginLeft:10},children:["Total Records: ",A," |"]}),h.jsxs("span",{style:{marginLeft:10},children:["Billed Records: ",e.filter(q=>q.BillNum&&q.BillNum.trim()!=="").length," |"]}),h.jsxs("span",{style:{marginLeft:10},children:["Unbilled Records: ",e.filter(q=>!q.BillNum||q.BillNum.trim()==="").length]})]}),g&&n.length>0&&h.jsxs("div",{style:{marginBottom:15,padding:10,backgroundColor:"#fff3cd",borderRadius:5,border:"1px solid #ffc107",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[h.jsxs("span",{children:[h.jsx("strong",{children:n.length})," record(s) selected"]}),h.jsx("button",{onClick:V,style:{padding:"8px 16px",backgroundColor:"#dc3545",color:"white",border:"none",borderRadius:4,cursor:"pointer",fontWeight:"bold"},children:"Delete Selected"})]}),h.jsxs("div",{style:{marginBottom:10,padding:8,backgroundColor:"#f8f9fa",borderRadius:5,border:"1px solid #dee2e6",fontSize:14,color:"#495057"},children:["Showing ",M===0?0:D+1,"‚Äì",W," of"," ",h.jsx("strong",{children:M})," filtered records (Total in DB: ",A,")"]}),h.jsx("div",{style:{overflowX:"auto"},children:h.jsxs("table",{border:"1",width:"100%",style:{borderCollapse:"collapse"},children:[h.jsx("thead",{children:h.jsxs("tr",{style:{backgroundColor:"#f2f2f2"},children:[g&&h.jsx("th",{style:{padding:10,width:"50px"},children:h.jsx("input",{type:"checkbox",checked:se,onChange:ae})}),Wa.map(q=>h.jsx("th",{style:{padding:10,textAlign:"left"},children:q},q)),g&&h.jsx("th",{style:{padding:10},children:"Action"})]})}),h.jsx("tbody",{children:Z.length>0?Z.map(q=>h.jsxs("tr",{style:{borderBottom:"1px solid #ddd",backgroundColor:q.BillNum&&q.BillNum.trim()!==""?"#f0fff0":"inherit"},children:[g&&h.jsx("td",{style:{padding:10,textAlign:"center"},children:h.jsx("input",{type:"checkbox",checked:n.includes(q.id),onChange:()=>_e(q.id)})}),Wa.map(le=>h.jsx("td",{style:{padding:10},children:le==="ChallanNo"&&T===q.id?h.jsx("input",{value:E,onChange:ve=>y(ve.target.value),style:{padding:4,width:"100%"},autoFocus:!0}):le==="BillNum"&&T===q.id&&g?h.jsx("input",{value:O,onChange:ve=>B(ve.target.value),style:{padding:4,width:"100%"},placeholder:"Enter Bill Number"}):le==="DispatchDate"?Va(q[le]):le==="BillNum"?h.jsx("span",{style:{fontWeight:q[le]?"bold":"normal",color:q[le]?"#28a745":"#dc3545",backgroundColor:q[le]?"#f0fff0":"#fff5f5",padding:"2px 8px",borderRadius:"4px",display:"inline-block"},children:q[le]||"Unbilled"}):le==="DispatchQuantity"?h.jsx("span",{style:{fontWeight:"bold"},children:q[le]?parseFloat(q[le]).toFixed(2):"0.00"}):q[le]||"‚Äî"},le)),g&&h.jsx("td",{style:{padding:10,whiteSpace:"nowrap"},children:T===q.id?h.jsxs(h.Fragment,{children:[h.jsx("button",{onClick:()=>ce(q.id),style:{marginRight:5,padding:"5px 10px",backgroundColor:"#28a745",color:"white",border:"none",borderRadius:3,cursor:"pointer"},children:"Save"}),h.jsx("button",{onClick:ne,style:{padding:"5px 10px",backgroundColor:"#6c757d",color:"white",border:"none",borderRadius:3,cursor:"pointer"},children:"Cancel"})]}):h.jsxs(h.Fragment,{children:[h.jsx("button",{onClick:()=>Q(q),style:{marginRight:5,padding:"5px 10px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:3,cursor:"pointer"},children:"Edit"}),h.jsx("button",{onClick:()=>Se(q.id),style:{padding:"5px 10px",backgroundColor:"#dc3545",color:"white",border:"none",borderRadius:3,cursor:"pointer"},children:"Delete"})]})})]},q.id)):h.jsx("tr",{children:h.jsx("td",{colSpan:g?Wa.length+2:Wa.length,style:{padding:40,textAlign:"center",color:"#666"},children:"No records found. Try adjusting your filters."})})})]})}),P>1&&h.jsxs("div",{style:{marginTop:20,display:"flex",alignItems:"center",justifyContent:"space-between",padding:15,backgroundColor:"#f8f9fa",borderRadius:5,border:"1px solid #dee2e6"},children:[h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:5},children:[h.jsx("button",{disabled:s===1,onClick:()=>c(q=>q-1),style:{padding:"8px 12px",backgroundColor:s===1?"#e9ecef":"#007bff",color:s===1?"#6c757d":"white",border:"none",borderRadius:4,cursor:s===1?"not-allowed":"pointer"},children:"Prev"}),[...Array(Math.min(5,P))].map((q,le)=>{let ve;return P<=5||s<=3?ve=le+1:s>=P-2?ve=P-4+le:ve=s-2+le,ve<1||ve>P?null:h.jsx("button",{onClick:()=>c(ve),style:{padding:"8px 12px",backgroundColor:s===ve?"#0056b3":"#007bff",color:"white",border:"none",borderRadius:4,cursor:"pointer",fontWeight:s===ve?"bold":"normal"},children:ve},ve)}),P>5&&s<P-2&&h.jsxs(h.Fragment,{children:[h.jsx("span",{style:{padding:"0 5px"},children:"..."}),h.jsx("button",{onClick:()=>c(P),style:{padding:"8px 12px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:4,cursor:"pointer"},children:P})]}),h.jsx("button",{disabled:s===P,onClick:()=>c(q=>q+1),style:{padding:"8px 12px",backgroundColor:s===P?"#e9ecef":"#007bff",color:s===P?"#6c757d":"white",border:"none",borderRadius:4,cursor:s===P?"not-allowed":"pointer"},children:"Next"})]}),h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[h.jsxs("span",{style:{fontSize:14,color:"#495057"},children:["Page ",s," of ",P]}),h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:5},children:[h.jsx("span",{children:"Go to:"}),h.jsx("input",{type:"number",min:"1",max:P,value:s,onChange:q=>{const le=parseInt(q.target.value);le>=1&&le<=P&&c(le)},onBlur:q=>{const le=parseInt(q.target.value);(!le||le<1||le>P)&&(q.target.value=s)},style:{width:"50px",padding:"5px",textAlign:"center",border:"1px solid #ccc",borderRadius:4}})]})]})]})]})},Gk=()=>{const[e,t]=ie.useState([]),[r,a]=ie.useState([]),[n,i]=ie.useState(!0),[s,c]=ie.useState(new Date().getFullYear()),[o,l]=ie.useState(""),[f,u]=ie.useState([]),d=["January","February","March","April","May","June","July","August","September","October","November","December"];ie.useEffect(()=>{(async()=>{try{i(!0);const k=await or(qe(Ie,"TblDispatch")),v=new Set,T=new Map,b=k.docs.map(y=>{var Y;const O=y.data();let B=null;(Y=O.DispatchDate)!=null&&Y.seconds?B=new Date(O.DispatchDate.seconds*1e3):O.DispatchDate&&(B=new Date(O.DispatchDate));const j=parseFloat(O.DispatchQuantity)||0,U=parseFloat(O.UnitPrice)||parseFloat(O.Rate)||0;let L="Unknown";return O.FactoryName?L=O.FactoryName:O.Factory?L=O.Factory:O.DisVid==="10"?L="JSW":O.DisVid==="6"?L="Manigar":O.DisVid==="7"?L="Ultratech":O.DisVid&&(L=`Factory ${O.DisVid}`),L!=="Unknown"&&v.add(L),O.DisVid&&!T.has(O.DisVid)&&T.set(O.DisVid,L),{id:y.id,...O,DispatchDate:B,DispatchQuantity:j,UnitPrice:U,FactoryName:L,FactoryId:O.DisVid}}),E=Array.from(v).sort();u(E),console.log("Available factories:",E),console.log("Factory mapping:",Array.from(T.entries())),x(b,s)}catch(k){console.error("Error fetching data:",k)}finally{i(!1)}})()},[s]),ie.useEffect(()=>{if(o.trim()==="")a(e);else{const _=o.toLowerCase().trim(),k=e.filter(v=>{const T=v.Factory&&v.Factory.toLowerCase().includes(_),b=v.MonthName&&v.MonthName.toLowerCase().includes(_);return T||b});a(k)}},[o,e]);const x=(_,k)=>{const v={};_.forEach(b=>{if(!b.DispatchDate||b.DispatchDate.getFullYear()!==k)return;const y=b.DispatchDate.getMonth(),O=d[y],B=b.FactoryName,j=`${B}-${O}`;v[j]||(v[j]={Factory:B,MonthName:O,totalQty:0,BillQty:0,Balance:0,monthIndex:y,year:k}),v[j].totalQty+=b.DispatchQuantity,(b.UnitPrice>0||b.BillStatus===!0||b.IsBilled===!0||b.Billed===!0)&&(v[j].BillQty+=b.DispatchQuantity)});const T=Object.values(v).map(b=>(b.Balance=b.totalQty-b.BillQty,b));T.sort((b,E)=>b.Factory<E.Factory?-1:b.Factory>E.Factory?1:b.monthIndex-E.monthIndex),t(T),a(T)},g=()=>{const _=new Date().getFullYear(),k=[];for(let v=_-5;v<=_;v++)k.push(v);return k},p=()=>r.reduce((_,k)=>(_.totalQty+=k.totalQty,_.BillQty+=k.BillQty,_.Balance+=k.Balance,_),{totalQty:0,BillQty:0,Balance:0});if(n)return h.jsx("div",{style:{padding:20,textAlign:"center"},children:h.jsx("h3",{children:"Loading monthly quantity report..."})});const m=p();return h.jsxs("div",{style:{padding:20},children:[h.jsx("h1",{style:{textAlign:"center",marginBottom:30},children:"Quantity By Month"}),h.jsxs("div",{style:{backgroundColor:"#f8f9fa",padding:"10px",borderRadius:"5px",marginBottom:"20px",fontSize:"14px"},children:[h.jsxs("p",{children:[h.jsx("strong",{children:"Available Factories:"})," ",f.join(", ")]}),h.jsxs("p",{children:[h.jsx("strong",{children:"Total Records:"})," ",e.length]})]}),h.jsxs("div",{style:{display:"flex",gap:20,alignItems:"center",marginBottom:20,flexWrap:"wrap"},children:[h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[h.jsx("label",{style:{fontWeight:"bold",fontSize:"16px"},children:"Select Year:"}),h.jsx("select",{value:s,onChange:_=>c(parseInt(_.target.value)),style:{padding:"8px 12px",border:"1px solid #ccc",borderRadius:4,fontSize:"16px",minWidth:"120px"},children:g().map(_=>h.jsx("option",{value:_,children:_},_))})]}),h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[h.jsx("label",{style:{fontWeight:"bold",fontSize:"16px"},children:"Search Factory:"}),h.jsx("input",{type:"text",placeholder:"Type factory name (e.g., JSW, Ultratech)...",value:o,onChange:_=>l(_.target.value),style:{padding:"8px 12px",border:"1px solid #ccc",borderRadius:4,fontSize:"16px",minWidth:"300px"}})]}),h.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[h.jsx("label",{style:{fontWeight:"bold",fontSize:"16px"},children:"Quick Filter:"}),h.jsxs("select",{value:o,onChange:_=>l(_.target.value),style:{padding:"8px 12px",border:"1px solid #ccc",borderRadius:4,fontSize:"16px",minWidth:"150px"},children:[h.jsx("option",{value:"",children:"All Factories"}),f.map(_=>h.jsx("option",{value:_,children:_},_))]})]})]}),r.length===0?h.jsxs("div",{style:{padding:40,textAlign:"center",backgroundColor:"#f8f9fa",borderRadius:8,border:"1px dashed #ccc"},children:[h.jsxs("h3",{children:["No data found ",o?`for "${o}"`:`for ${s}`]}),h.jsx("p",{children:"Try a different search term or year."}),h.jsx("p",{style:{marginTop:10},children:h.jsx("button",{onClick:()=>l(""),style:{padding:"8px 16px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Clear Search"})})]}):h.jsxs(h.Fragment,{children:[h.jsxs("div",{style:{marginBottom:15,padding:"10px",backgroundColor:"#e7f3ff",borderRadius:"5px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[h.jsxs("span",{children:["Showing ",h.jsx("strong",{children:r.length})," record(s)",o&&` for "${o}"`]}),o&&h.jsx("button",{onClick:()=>l(""),style:{padding:"5px 10px",backgroundColor:"#6c757d",color:"white",border:"none",borderRadius:"3px",cursor:"pointer",fontSize:"14px"},children:"Clear Filter"})]}),h.jsx("div",{style:{overflowX:"auto"},children:h.jsxs("table",{className:"table",style:{width:"100%",borderCollapse:"collapse"},children:[h.jsx("thead",{children:h.jsxs("tr",{style:{backgroundColor:"#f2f2f2"},children:[h.jsx("th",{style:{padding:"12px",border:"1px solid #ddd",textAlign:"left"},children:"Factory"}),h.jsx("th",{style:{padding:"12px",border:"1px solid #ddd",textAlign:"left"},children:"Month"}),h.jsx("th",{style:{padding:"12px",border:"1px solid #ddd",textAlign:"left"},children:"Total Quantity"}),h.jsx("th",{style:{padding:"12px",border:"1px solid #ddd",textAlign:"left"},children:"Bill Quantity"}),h.jsx("th",{style:{padding:"12px",border:"1px solid #ddd",textAlign:"left"},children:"Balance"})]})}),h.jsxs("tbody",{children:[r.map((_,k)=>h.jsxs("tr",{style:{borderBottom:"1px solid #ddd",backgroundColor:k%2===0?"#ffffff":"#f9f9f9"},children:[h.jsx("td",{style:{padding:"12px",border:"1px solid #ddd",fontWeight:"bold"},children:_.Factory}),h.jsx("td",{style:{padding:"12px",border:"1px solid #ddd"},children:_.MonthName}),h.jsx("td",{style:{padding:"12px",border:"1px solid #ddd",textAlign:"right"},children:Math.round(_.totalQty*100)/100}),h.jsx("td",{style:{padding:"12px",border:"1px solid #ddd",textAlign:"right"},children:Math.round(_.BillQty*100)/100}),h.jsx("td",{style:{padding:"12px",border:"1px solid #ddd",textAlign:"right",fontWeight:"bold",color:_.Balance>=0?"#28a745":"#dc3545"},children:Math.round(_.Balance*100)/100})]},`${_.Factory}-${_.MonthName}-${k}`)),r.length>0&&h.jsxs("tr",{style:{backgroundColor:"#e9ecef",fontWeight:"bold"},children:[h.jsx("td",{style:{padding:"12px",border:"1px solid #ddd"},colSpan:"2",children:"TOTAL"}),h.jsx("td",{style:{padding:"12px",border:"1px solid #ddd",textAlign:"right"},children:Math.round(m.totalQty*100)/100}),h.jsx("td",{style:{padding:"12px",border:"1px solid #ddd",textAlign:"right"},children:Math.round(m.BillQty*100)/100}),h.jsx("td",{style:{padding:"12px",border:"1px solid #ddd",textAlign:"right",color:m.Balance>=0?"#28a745":"#dc3545"},children:Math.round(m.Balance*100)/100})]})]})]})}),h.jsxs("div",{style:{marginTop:30,display:"flex",gap:20,flexWrap:"wrap",justifyContent:"center"},children:[h.jsxs("div",{style:{backgroundColor:"#007bff",color:"white",padding:"20px",borderRadius:"8px",minWidth:"200px",textAlign:"center",flex:1},children:[h.jsx("h4",{children:"Total Dispatch"}),h.jsx("h3",{children:Math.round(m.totalQty*100)/100})]}),h.jsxs("div",{style:{backgroundColor:"#28a745",color:"white",padding:"20px",borderRadius:"8px",minWidth:"200px",textAlign:"center",flex:1},children:[h.jsx("h4",{children:"Total Billed"}),h.jsx("h3",{children:Math.round(m.BillQty*100)/100})]}),h.jsxs("div",{style:{backgroundColor:m.Balance>=0?"#17a2b8":"#dc3545",color:"white",padding:"20px",borderRadius:"8px",minWidth:"200px",textAlign:"center",flex:1},children:[h.jsx("h4",{children:"Total Balance"}),h.jsx("h3",{children:Math.round(m.Balance*100)/100})]})]})]})]})},zk=()=>{const[e,t]=ie.useState([]),[r,a]=ie.useState([]),[n,i]=ie.useState(!0),[s,c]=ie.useState(""),[o,l]=ie.useState(""),[f,u]=ie.useState([]),[d,x]=ie.useState(null),[g,p]=ie.useState([]),m=()=>{console.log("=== DEBUG INFO ==="),console.log("Loading:",n),console.log("Error:",d),console.log("All factories:",f),console.log("Raw data count:",g.length),console.log("Raw data sample:",g.slice(0,3)),console.log("Daily data count:",e.length),console.log("Daily data sample:",e.slice(0,3)),console.log("Filtered data count:",r.length),console.log("Selected date:",s),console.log("Selected factory:",o),console.log("===================")},_=E=>{if(!E)return null;try{if(E.seconds)return new Date(E.seconds*1e3);if(E instanceof Date)return E;if(typeof E=="string"){const y=E.split("T")[0];return new Date(y)}return null}catch(y){return console.error("Error parsing date:",E,y),null}};ie.useEffect(()=>{(async()=>{try{i(!0),x(null),console.log("Starting data fetch...");const y=await or(qe(Ie,"TblDispatch"));if(console.log("Firebase query result:",{size:y.size,empty:y.empty}),y.empty){console.log("No documents found in TblDispatch collection"),x("No dispatch records found in the database.");return}const O=new Set,B=[];y.docs.forEach((U,L)=>{const Y=U.data();B.push(Y),console.log(`Document ${L}:`,{id:U.id,data:Y,hasDispatchDate:!!Y.DispatchDate,hasFactoryName:!!Y.FactoryName,hasDisVid:!!Y.DisVid});let J="Unknown";Y.FactoryName?J=Y.FactoryName:Y.Factory?J=Y.Factory:Y.DisVid==="10"?J="JSW":Y.DisVid==="6"?J="Manigar":Y.DisVid==="7"?J="Ultratech":Y.DisVid&&(J=`Factory ${Y.DisVid}`),J!=="Unknown"&&O.add(J)}),p(B);const j=Array.from(O).sort();console.log("Unique factories found:",j),u(j),k(y.docs)}catch(y){console.error("Error fetching data:",y),x(`Failed to fetch data: ${y.message}`)}finally{i(!1),m()}})()},[]);const k=E=>{const y={};E.forEach(B=>{const j=B.data(),U=_(j.DispatchDate);if(!U||isNaN(U.getTime())){console.log("Skipping document with invalid date:",B.id,j);return}let L="Unknown";j.FactoryName?L=j.FactoryName:j.Factory?L=j.Factory:j.DisVid==="10"?L="JSW":j.DisVid==="6"?L="Manigar":j.DisVid==="7"?L="Ultratech":j.DisVid&&(L=`Factory ${j.DisVid}`);const Y=parseFloat(j.DispatchQuantity)||0,Q=(parseFloat(j.UnitPrice)||parseFloat(j.Rate)||0)>0||j.BillStatus===!0||j.IsBilled===!0||j.Billed===!0,ce=`${L}_${U.toISOString().split("T")[0]}`;y[ce]||(y[ce]={Factory:L,Date:U,FormattedDate:`${String(U.getDate()).padStart(2,"0")}/${String(U.getMonth()+1).padStart(2,"0")}/${U.getFullYear()}`,totalQty:0,BillQty:0,Balance:0}),y[ce].totalQty+=Y,Q&&(y[ce].BillQty+=Y)});const O=Object.values(y).map(B=>(B.Balance=B.totalQty-B.BillQty,B));O.sort((B,j)=>B.Factory===j.Factory?j.Date-B.Date:B.Factory.localeCompare(j.Factory)),console.log("Processed display data:",O),t(O),a(O)};ie.useEffect(()=>{if(e.length===0)return;let E=[...e];if(s.trim())try{const y=s.split("/");if(y.length===3){const O=parseInt(y[0],10),B=parseInt(y[1],10)-1,j=parseInt(y[2],10),U=new Date(j,B,O);isNaN(U.getTime())||(E=E.filter(L=>{const Y=L.Date;return Y.getDate()===U.getDate()&&Y.getMonth()===U.getMonth()&&Y.getFullYear()===U.getFullYear()}))}}catch(y){console.error("Error filtering by date:",y)}o&&(E=E.filter(y=>y.Factory===o)),a(E)},[s,o,e]);const v=()=>r.reduce((E,y)=>(E.totalQty+=y.totalQty,E.BillQty+=y.BillQty,E.Balance+=y.Balance,E),{totalQty:0,BillQty:0,Balance:0}),T=()=>{c(""),l("")};if(ie.useEffect(()=>{n||m()},[n,e,r]),n)return h.jsxs("div",{style:{padding:40,textAlign:"center",minHeight:"300px",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[h.jsx("h3",{style:{marginBottom:20},children:"Loading daily quantity report..."}),h.jsx("div",{style:{width:"50px",height:"50px",border:"5px solid #f3f3f3",borderTop:"5px solid #3498db",borderRadius:"50%",animation:"spin 1s linear infinite"}}),h.jsx("style",{children:`
          @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
          }
        `})]});if(d)return h.jsxs("div",{style:{padding:40,textAlign:"center",backgroundColor:"#ffe6e6",borderRadius:"8px",margin:"20px"},children:[h.jsx("h3",{style:{color:"#c00",marginBottom:15},children:"Error Loading Data"}),h.jsx("p",{style:{marginBottom:20},children:d}),h.jsx("button",{onClick:()=>window.location.reload(),style:{padding:"10px 20px",backgroundColor:"#3498db",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Retry"})]});const b=v();return h.jsxs("div",{style:{padding:20,maxWidth:1200,margin:"0 auto"},children:[h.jsx("h1",{style:{textAlign:"center",marginBottom:30,color:"#333"},children:"Daily Quantity Report"}),h.jsx("div",{style:{backgroundColor:"#f0f8ff",padding:15,marginBottom:20,borderRadius:8,border:"1px dashed #3498db",fontSize:"14px"},children:h.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[h.jsxs("div",{children:[h.jsx("strong",{children:"Data Status:"}),h.jsxs("span",{style:{color:e.length>0?"#27ae60":"#e74c3c",marginLeft:10},children:[e.length," records loaded"]}),h.jsxs("span",{style:{marginLeft:20},children:[h.jsx("strong",{children:"Factories:"})," ",f.length," found"]})]}),h.jsx("button",{onClick:m,style:{padding:"5px 10px",backgroundColor:"#3498db",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:"Show Console Logs"})]})}),h.jsxs("div",{style:{backgroundColor:"#f8f9fa",padding:"20px",borderRadius:"8px",marginBottom:"30px"},children:[h.jsxs("div",{style:{display:"flex",gap:20,marginBottom:20,flexWrap:"wrap"},children:[h.jsxs("div",{style:{flex:1,minWidth:"200px"},children:[h.jsx("label",{style:{display:"block",marginBottom:8,fontWeight:"bold"},children:"Select Factory:"}),h.jsxs("select",{value:o,onChange:E=>l(E.target.value),style:{width:"100%",padding:"10px",border:"1px solid #ddd",borderRadius:"6px"},children:[h.jsx("option",{value:"",children:"All Factories"}),f.map((E,y)=>h.jsx("option",{value:E,children:E},y))]})]}),h.jsxs("div",{style:{flex:1,minWidth:"200px"},children:[h.jsx("label",{style:{display:"block",marginBottom:8,fontWeight:"bold"},children:"Enter Date (DD/MM/YYYY):"}),h.jsx("input",{type:"text",value:s,onChange:E=>c(E.target.value),placeholder:"DD/MM/YYYY",style:{width:"100%",padding:"10px",border:"1px solid #ddd",borderRadius:"6px"}})]})]}),h.jsxs("div",{style:{display:"flex",gap:15,justifyContent:"center"},children:[h.jsx("button",{onClick:()=>{const E=new Date,y=`${String(E.getDate()).padStart(2,"0")}/${String(E.getMonth()+1).padStart(2,"0")}/${E.getFullYear()}`;c(y)},style:{padding:"10px 20px",backgroundColor:"#28a745",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:"Today's Date"}),h.jsx("button",{onClick:T,style:{padding:"10px 20px",backgroundColor:"#6c757d",color:"white",border:"none",borderRadius:"6px",cursor:"pointer"},children:"Clear Filters"})]})]}),r.length===0?h.jsxs("div",{style:{padding:"60px 40px",textAlign:"center",backgroundColor:"#f8f9fa",borderRadius:"8px"},children:[h.jsx("h3",{style:{color:"#666",marginBottom:"15px"},children:e.length===0?"No data available":"No matching records found"}),h.jsx("p",{style:{color:"#777",marginBottom:"20px"},children:e.length===0?"There are no dispatch records in the database.":"Try different filters or clear all filters to see all data."}),g.length>0&&e.length===0&&h.jsxs("div",{style:{marginTop:20,padding:15,backgroundColor:"#fff3cd",borderRadius:4,textAlign:"left"},children:[h.jsxs("p",{children:[h.jsx("strong",{children:"Debug Info:"})," Found ",g.length," raw records but couldn't process them."]}),h.jsx("p",{children:"This usually means dates are not in the expected format."}),h.jsx("button",{onClick:()=>console.log("Raw data:",g),style:{marginTop:10,padding:"8px 15px",backgroundColor:"#f39c12",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"View Raw Data in Console"})]})]}):h.jsxs(h.Fragment,{children:[h.jsx("div",{style:{overflowX:"auto",marginBottom:30},children:h.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[h.jsx("thead",{children:h.jsxs("tr",{style:{backgroundColor:"#2c3e50",color:"white"},children:[h.jsx("th",{style:{padding:"12px",border:"1px solid #34495e",textAlign:"left"},children:"Factory"}),h.jsx("th",{style:{padding:"12px",border:"1px solid #34495e",textAlign:"left"},children:"Date"}),h.jsx("th",{style:{padding:"12px",border:"1px solid #34495e",textAlign:"right"},children:"Total Quantity"}),h.jsx("th",{style:{padding:"12px",border:"1px solid #34495e",textAlign:"right"},children:"Bill Quantity"}),h.jsx("th",{style:{padding:"12px",border:"1px solid #34495e",textAlign:"right"},children:"Balance"})]})}),h.jsx("tbody",{children:r.map((E,y)=>h.jsxs("tr",{style:{borderBottom:"1px solid #eee"},children:[h.jsx("td",{style:{padding:"12px",border:"1px solid #eee"},children:E.Factory}),h.jsx("td",{style:{padding:"12px",border:"1px solid #eee"},children:E.FormattedDate}),h.jsx("td",{style:{padding:"12px",border:"1px solid #eee",textAlign:"right"},children:Math.round(E.totalQty*100)/100}),h.jsx("td",{style:{padding:"12px",border:"1px solid #eee",textAlign:"right"},children:Math.round(E.BillQty*100)/100}),h.jsx("td",{style:{padding:"12px",border:"1px solid #eee",textAlign:"right"},children:Math.round(E.Balance*100)/100})]},y))})]})}),h.jsxs("div",{style:{padding:20,backgroundColor:"#f8f9fa",borderRadius:8,marginTop:20},children:[h.jsx("h3",{style:{marginBottom:15},children:"Summary"}),h.jsxs("div",{style:{display:"flex",gap:20},children:[h.jsxs("div",{children:[h.jsx("strong",{children:"Total Dispatch:"})," ",Math.round(b.totalQty*100)/100]}),h.jsxs("div",{children:[h.jsx("strong",{children:"Total Billed:"})," ",Math.round(b.BillQty*100)/100]}),h.jsxs("div",{children:[h.jsx("strong",{children:"Balance:"})," ",Math.round(b.Balance*100)/100]})]})]})]})]})},Xk=["MANIGARH","ULTRATECH","JSW"],Ha=e=>{if(e==null||e==="")return 0;typeof e=="string"&&(e=e.replace(/,/g,"").replace(/^[-‚Äì]/g,"").trim());const t=parseFloat(e);return isNaN(t)?0:t},Yk=e=>{if(!e)return null;if(e instanceof Date)return e;if(typeof e=="number")return new Date(Math.round((e-25569)*86400*1e3));const t=String(e).trim(),r=t.match(/^(\d{1,2})[-\/](\d{1,2})[-\/](\d{2,4})$/);if(r){const n=parseInt(r[1],10),i=parseInt(r[2],10)-1;let s=parseInt(r[3],10);s<100&&(s=s>=0&&s<=50?s+2e3:s+1900);const c=new Date(s,i,n);if(!isNaN(c.getTime())&&c.getDate()===n&&c.getMonth()===i)return c}const a=new Date(t);return isNaN(a.getTime())?(console.warn(`Could not parse date: ${e}`),null):a},Kk=({isAdmin:e})=>{const[t,r]=ie.useState(null),[a,n]=ie.useState(""),[i,s]=ie.useState(!1),[c,o]=ie.useState([]),[l,f]=ie.useState([]),[u,d]=ie.useState(new Set);if(ie.useEffect(()=>{a&&g()},[a]),!e)return h.jsx("h3",{style:{color:"red"},children:"Access Denied"});const x=(T,b="info")=>{const E=new Date().toLocaleTimeString();o(y=>[...y,{timestamp:E,message:T,type:b}].slice(-20))},g=async()=>{try{const T=rt(qe(Ie,"BillTable"),Sr("FactoryName","==",a),Sr("PaymentReceived",">",0)),b=await or(T),E=[];b.forEach(y=>{var B;const O=y.data();E.push({id:y.id,...O,BillDate:(B=O.BillDate)!=null&&B.toDate?O.BillDate.toDate():O.BillDate})}),f(E),x(`Loaded ${E.length} payments for ${a}`,"info")}catch(T){x(`Error loading payments: ${T.message}`,"error")}},p=async()=>{if(!t||!a){alert("Select Factory and Excel file");return}s(!0),o([]),x(`Starting payment upload for ${a}...`,"info");const T=new FileReader;T.onload=async b=>{try{const E=ha(b.target.result,{type:"binary"}),y=E.Sheets[E.SheetNames[0]],O=$e.sheet_to_json(y,{header:1});let B=0,j=0,U=0;const L=new Map;x(`Found ${O.length-1} rows in Excel file`,"info");for(let J=1;J<O.length;J++){const Q=O[J];if(!Q||Q.every(Ee=>Ee===null||Ee===""))continue;const ce=String(Q[0]||"").trim(),ne=String(Q[1]||"").trim(),Se=Yk(Q[2]),V=Ha(Q[3]),_e=Ha(Q[4]),ge=Ha(Q[5]),A=Ha(Q[6]),P=String(Q[7]||"").trim().replace(/[-‚Äì]/g,"").trim(),D=Ha(P);if(x(`Processing row ${J}: Bill ${ce}, Payment ${ne}`,"info"),!ce){x(`Row ${J} skipped: Missing Bill Number`,"warning"),j++;continue}if(!ne){x(`Row ${J} skipped: Missing Payment Number`,"warning"),j++;continue}if(A===0){x(`Row ${J} skipped: Payment Received is 0`,"warning"),j++;continue}if(!Se){x(`Row ${J} skipped: Invalid Payment Date (${Q[2]})`,"warning"),j++;continue}const W=rt(qe(Ie,"BillTable"),Sr("BillNum","==",ce),Sr("FactoryName","==",a)),Z=await or(W);if(Z.empty){x(`Row ${J} skipped: Bill ${ce} not found in ${a}`,"warning"),j++;continue}const ae=Z.docs[0].id;let ee=null;if(L.has(ne))ee=L.get(ne).id;else{const Ee=rt(qe(Ie,"PaymentTable"),Sr("DocNumber","==",ne)),R=await or(Ee);if(!R.empty)ee=R.docs[0].id,L.set(ne,{id:ee,exists:!0}),x(`Row ${J}: Using existing payment ${ne}`,"info");else try{ee=(await ta(qe(Ie,"PaymentTable"),{DocNumber:ne,PayRecDate:Se,Shortage:D,FactoryName:a,CreatedOn:qt()})).id,L.set(ne,{id:ee,exists:!1}),x(`Row ${J}: Created new payment ${ne}`,"success")}catch(q){x(`Row ${J}: Failed to create payment ${ne}: ${q.message}`,"error"),U++;continue}}try{await Et(yr(Ie,"BillTable",ae),{PaymentReceived:A,ActualAmount:V,Tds:_e,Gst:ge,PId:ee,PaymentNumber:ne,UpdatedAt:qt()}),B++,x(`Row ${J}: Updated Bill ${ce} with payment ${ne} (${A})`,"success")}catch(Ee){U++,x(`Row ${J}: Failed to update Bill ${ce}: ${Ee.message}`,"error")}}s(!1),await g();const Y=`Upload completed:
Success: ${B}
Skipped: ${j}
Failed: ${U}`;x(Y,"info"),alert(Y)}catch(E){s(!1),x(`Upload failed: ${E.message}`,"error"),alert(`Upload failed: ${E.message}`)}},T.onerror=()=>{s(!1),x("Error reading file","error"),alert("Error reading file")},T.readAsBinaryString(t)},m=()=>{const T=[["BillNumber","PaymentNumber","PaymentDate","ActualAmount","TDS","GST","PaymentReceived","Shortage"],["BILL-001","PAY-001","15-01-2026",5e4,2500,9e3,48e3,"500"],["BILL-002","PAY-002","16-01-2026",75e3,3750,13500,72e3,"250"],["BILL-003","PAY-003","17-01-2026",6e4,3e3,10800,57600,"-300"]],b=$e.aoa_to_sheet(T),E=$e.book_new();$e.book_append_sheet(E,b,"PaymentTemplate"),ua(E,`Payment_Upload_Template_${a||"Generic"}.xlsx`),x("Payment template downloaded","info")},_=async()=>{if(u.size===0){alert("No payments selected for deletion");return}if(confirm(`Are you sure you want to delete ${u.size} payment(s)?`))try{s(!0),x(`Starting deletion of ${u.size} payments...`,"info");let T=0,b=0;for(const y of u)try{await Et(yr(Ie,"BillTable",y),{PaymentReceived:0,ActualAmount:0,Tds:0,Gst:0,PId:null,PaymentNumber:null,UpdatedAt:qt()}),T++,x(`Reset payment for bill ID: ${y}`,"success")}catch(O){b++,x(`Failed to reset bill ${y}: ${O.message}`,"error")}d(new Set),await g(),s(!1);const E=`Deletion completed:
Reset: ${T}
Errors: ${b}`;x(E,"info"),alert(E)}catch(T){s(!1),x(`Deletion failed: ${T.message}`,"error"),alert(`Deletion failed: ${T.message}`)}},k=T=>{T.target.checked?d(new Set(l.map(b=>b.id))):d(new Set)},v=T=>{const b=new Set(u);b.has(T)?b.delete(T):b.add(T),d(b)};return h.jsxs("div",{style:{maxWidth:1200,margin:"30px auto",padding:"0 20px"},children:[h.jsx("h1",{style:{textAlign:"center",marginBottom:"30px"},children:"Payments"}),h.jsxs("div",{style:{marginBottom:"25px",width:"200px"},children:[h.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"Select Factory:"}),h.jsxs("select",{value:a,onChange:T=>{n(T.target.value),d(new Set)},style:{width:"100%",padding:"10px",borderRadius:"4px",border:"1px solid #ced4da",fontSize:"16px"},children:[h.jsx("option",{value:"",children:"-- Select Factory --"}),Xk.map(T=>h.jsx("option",{value:T,children:T},T))]})]}),h.jsxs("div",{style:{backgroundColor:"#f8f9fa",padding:"20px",borderRadius:"5px",marginBottom:"30px",border:"1px solid #dee2e6"},children:[h.jsx("h4",{children:"Upload Payment Excel File:"}),h.jsx("p",{style:{margin:"10px 0",color:"#6c757d"},children:"Excel must have columns: BillNumber, PaymentNumber, PaymentDate, ActualAmount, TDS, GST, PaymentReceived, Shortage"}),h.jsxs("div",{style:{marginBottom:"15px"},children:[h.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"Select Excel File:"}),h.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:T=>{r(T.target.files[0]),T.target.files[0]&&x(`Selected file: ${T.target.files[0].name}`,"info")},style:{width:"100%",padding:"10px",borderRadius:"4px",border:"1px solid #ced4da"}})]}),h.jsxs("div",{style:{display:"flex",gap:"10px"},children:[h.jsx("button",{onClick:p,disabled:i||!t||!a,style:{padding:"10px 20px",backgroundColor:i||!t||!a?"#cccccc":"#28a745",color:"white",border:"none",borderRadius:"4px",cursor:i||!t||!a?"not-allowed":"pointer",fontSize:"16px",flex:1},children:i?"Uploading...":"Upload Payments"}),h.jsx("button",{onClick:m,style:{padding:"10px 20px",backgroundColor:"#6c757d",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"16px",flex:1},children:"Download Template"})]})]}),c.length>0&&h.jsxs("div",{style:{marginBottom:"30px",border:"1px solid #dee2e6",borderRadius:"5px",overflow:"hidden"},children:[h.jsx("div",{style:{backgroundColor:"#343a40",color:"white",padding:"10px 15px",fontWeight:"bold"},children:"Upload Log"}),h.jsx("div",{style:{maxHeight:"200px",overflowY:"auto",backgroundColor:"#f8f9fa"},children:c.map((T,b)=>h.jsxs("div",{style:{padding:"8px 15px",borderBottom:"1px solid #dee2e6",fontFamily:"monospace",fontSize:"12px",color:T.type==="error"?"#dc3545":T.type==="warning"?"#ffc107":T.type==="success"?"#28a745":"#6c757d"},children:[h.jsxs("span",{style:{color:"#6c757d",marginRight:"10px"},children:["[",T.timestamp,"]"]}),T.message]},b))})]}),a&&h.jsxs("div",{children:[h.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"15px"},children:[h.jsxs("h4",{children:["Payment Records for ",a]}),u.size>0&&h.jsx("button",{onClick:_,disabled:i,style:{padding:"8px 16px",backgroundColor:"#dc3545",color:"white",border:"none",borderRadius:"4px",cursor:i?"not-allowed":"pointer",fontSize:"14px"},children:i?"Processing...":`Delete Selected (${u.size})`})]}),h.jsx("div",{style:{overflowX:"auto"},children:h.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",border:"1px solid #dee2e6"},children:[h.jsx("thead",{children:h.jsxs("tr",{style:{backgroundColor:"#343a40",color:"white"},children:[h.jsxs("th",{style:{padding:"12px",textAlign:"left",border:"1px solid #dee2e6"},children:[h.jsx("input",{type:"checkbox",id:"selectAll",checked:l.length>0&&u.size===l.length,onChange:k,disabled:l.length===0})," Select All"]}),h.jsx("th",{style:{padding:"12px",textAlign:"left",border:"1px solid #dee2e6"},children:"Factory"}),h.jsx("th",{style:{padding:"12px",textAlign:"left",border:"1px solid #dee2e6"},children:"Bill Number"}),h.jsx("th",{style:{padding:"12px",textAlign:"left",border:"1px solid #dee2e6"},children:"Bill Date"}),h.jsx("th",{style:{padding:"12px",textAlign:"left",border:"1px solid #dee2e6"},children:"Receive Amount"}),h.jsx("th",{style:{padding:"12px",textAlign:"left",border:"1px solid #dee2e6"},children:"Payment Number"})]})}),h.jsxs("tbody",{children:[l.map(T=>h.jsxs("tr",{style:{borderBottom:"1px solid #dee2e6"},children:[h.jsx("td",{style:{padding:"12px",border:"1px solid #dee2e6"},children:h.jsx("input",{type:"checkbox",checked:u.has(T.id),onChange:()=>v(T.id)})}),h.jsx("td",{style:{padding:"12px",border:"1px solid #dee2e6"},children:T.FactoryName}),h.jsx("td",{style:{padding:"12px",border:"1px solid #dee2e6"},children:T.BillNum}),h.jsx("td",{style:{padding:"12px",border:"1px solid #dee2e6"},children:T.BillDate?T.BillDate.toLocaleDateString():"N/A"}),h.jsx("td",{style:{padding:"12px",border:"1px solid #dee2e6"},children:T.PaymentReceived?T.PaymentReceived.toFixed(2):"0.00"}),h.jsx("td",{style:{padding:"12px",border:"1px solid #dee2e6"},children:T.PaymentNumber||"N/A"})]},T.id)),l.length===0&&h.jsx("tr",{children:h.jsxs("td",{colSpan:"6",style:{padding:"20px",textAlign:"center",color:"#6c757d"},children:["No payment records found for ",a]})})]})]})})]})]})},Qk=()=>{const[e,t]=ie.useState(null),[r,a]=ie.useState(!0),[n,i]=ie.useState(!1);return ie.useEffect(()=>{const s=Wf(vt,async c=>{if(t(c),c){const o=await yu(c);i(o)}else i(!1);a(!1)});return()=>s()},[]),r?h.jsx("div",{style:{textAlign:"center",marginTop:"50px"},children:h.jsx("p",{children:"Loading..."})}):h.jsx(Hf,{children:h.jsxs($f,{children:[h.jsx(Ir,{path:"/login",element:e?h.jsx(wi,{to:"/"}):h.jsx(_u,{})}),h.jsxs(Ir,{path:"/",element:e?h.jsx(ku,{user:e,isAdmin:n}):h.jsx(wi,{to:"/login"}),children:[h.jsx(Ir,{path:"upload-dispatch",element:h.jsx(bk,{isAdmin:n})}),h.jsx(Ir,{path:"bill-upload",element:h.jsx(Mk,{isAdmin:n})}),h.jsx(Ir,{path:"destination-master",element:h.jsx(Ik,{isAdmin:n})}),h.jsx(Ir,{path:"factories",element:h.jsx(Tu,{isAdmin:n})}),h.jsx(Ir,{path:"show-dispatch",element:h.jsx(Bk,{isAdmin:n})}),h.jsx(Ir,{path:"vehicle-master",element:h.jsx(Ok,{})}),h.jsx(Ir,{path:"show-bill",element:h.jsx(Uk,{})}),h.jsx(Ir,{path:"show-billed-challan",element:h.jsx($k,{})}),h.jsx(Ir,{path:"monthly-qty-report",element:h.jsx(Gk,{})}),h.jsx(Ir,{path:"daily-qty-report",element:h.jsx(zk,{})}),h.jsx(Ir,{path:"delete-dispatch",element:h.jsx(Wk,{})}),h.jsx(Ir,{path:"delete-duplicate-challan",element:h.jsx(Hk,{})}),h.jsx(Ir,{path:"payment-upload",element:h.jsx(Kk,{isAdmin:n})})]}),h.jsx(Ir,{path:"*",element:h.jsx(wi,{to:e?"/":"/login"})})]})})};Wi.createRoot(document.getElementById("root")).render(h.jsx(Sf.StrictMode,{children:h.jsx(Qk,{})}));
